# AICU QUIZ 앱 전면 리팩토링 기획서 v2.0

## 1. 프로젝트 개요

### 1.1 목적
- 현재 땜빵식으로 구현된 코드를 통합된 아키텍처로 전면 리팩토링
- 단일 마스터 DB vs 분할 DB 사용 방식 결정
- 확장 가능하고 유지보수 용이한 구조 구축

### 1.2 대상 파일
- **현재**: `index3.6-4.html` (2,664줄, 땜빵식 구조)
- **목표**: `index3.8-1.html` (통합된 깔끔한 구조)

### 1.3 핵심 원칙
- **단순한 로직**: 5단계 기본 로직만 구현
- **통합된 함수**: 모드별 중복 함수 제거
- **확장성**: 새로운 모드 추가 시 최소 코드 변경
- **순차적 검증**: 작은 모듈 단위로 개발 및 테스트

## 2. 데이터 구조 결정

### 2.1 옵션 분석

#### 옵션 A: 단일 마스터 DB 사용
**장점:**
- 데이터 중복 없음
- 원본 데이터와 항상 동기화
- 메모리 효율적

**단점:**
- 매번 전체 DB 스캔 필요
- 필터링 로직 복잡
- 처리 속도 느림

#### 옵션 B: 분할 DB 사용 (현재 방식)
**장점:**
- 빠른 로드 속도
- 단순한 로직
- 독립적 처리

**단점:**
- 데이터 중복
- 동기화 이슈
- 저장 공간 낭비

### 2.2 **결정: 분할 DB 사용 유지**
- 현재 `ins_1db.csv`, `ins_2db.csv`, `ins_3db.csv`, `ins_4db.csv` 활용
- 성능과 단순성 우선
- 향후 필요시 단일 DB로 마이그레이션 가능

## 3. 통합 아키텍처 설계

### 3.1 핵심 로직 (5단계)
```javascript
// 1. 기준 선택 → 데이터 필터링
function selectMode(mode, category) {
    // 모드별 데이터 로드
}

// 2. 문제 제시
function displayQuestion(questionIndex) {
    // 문제 표시
}

// 3. 정답 확인
function checkAnswer(userAnswer) {
    // 정답 비교 및 결과 표시
}

// 4. 다음 문제 이동
function nextQuestion() {
    // 다음 문제로 이동
}

// 5. 통계 제공
function updateStatistics() {
    // 통계 업데이트
}
```

### 3.2 모드별 설정 객체
```javascript
const MODE_CONFIG = {
    'basic': {
        resultArea: 'result-area',
        questionText: 'question-text',
        questionCode: 'question-code',
        answerButtons: 'answer-buttons',
        resultMessage: 'result-message'
    },
    'large-category': {
        resultArea: 'large-category-result-area',
        questionText: 'large-category-question-text',
        questionCode: 'large-category-question-code',
        answerButtons: 'large-category-answer-buttons',
        resultMessage: 'large-category-result-message'
    }
};
```

### 3.3 통합 함수 설계
```javascript
// 통합된 문제 표시 함수
function displayQuestion(mode = 'basic', questionIndex = 0) {
    const config = MODE_CONFIG[mode];
    // 모드별 HTML 요소 참조
}

// 통합된 정답 확인 함수
function checkAnswer(mode = 'basic') {
    const config = MODE_CONFIG[mode];
    // 모드별 결과 표시
}

// 통합된 다음 문제 함수
function nextQuestion(mode = 'basic') {
    const config = MODE_CONFIG[mode];
    // 모드별 다음 문제 처리
}
```

## 4. 모듈별 순차 개발 절차서

### 🎯 **핵심 원칙: 작은 단위로 나누어 순차적 검증**

### Phase 1: 기반 구조 구축 (1-2일)

#### 모듈 1.1: 기본 HTML 구조 (2시간)
**목표**: 최소한의 HTML 구조만 구현
**작업**:
- 새 파일 `index3.8-1.html` 생성
- 기본 HTML5 구조
- Tailwind CSS 연결
- Papa Parse 라이브러리 연결

**검증 기준**:
- ✅ 브라우저에서 페이지 로드
- ✅ 콘솔 에러 없음
- ✅ 기본 스타일 적용

#### 모듈 1.2: 설정 객체 구현 (1시간)
**목표**: 모드별 설정 객체만 구현
**작업**:
- `MODE_CONFIG` 객체 정의
- 기본학습/대분류학습 모드 설정

**검증 기준**:
- ✅ 콘솔에서 `MODE_CONFIG` 접근 가능
- ✅ 각 모드별 설정 확인

#### 모듈 1.3: 데이터 로드 함수 (2시간)
**목표**: CSV 파일 로드 기능만 구현
**작업**:
- `loadCategoryData(category)` 함수
- `ins_1db.csv` 로드 테스트

**검증 기준**:
- ✅ CSV 파일 로드 성공
- ✅ 데이터 파싱 확인
- ✅ 콘솔에 데이터 출력

### Phase 2: 핵심 로직 구현 (2-3일)

#### 모듈 2.1: 문제 표시 함수 (3시간)
**목표**: 단일 문제 표시 기능만 구현
**작업**:
- `displayQuestion(mode, index)` 함수
- 대분류학습 모드에서 첫 번째 문제만 표시

**검증 기준**:
- ✅ 재산보험 선택 시 첫 번째 문제 표시
- ✅ 문제 텍스트, 답안 버튼 정상 표시
- ✅ HTML 요소 ID 올바르게 참조

#### 모듈 2.2: 답안 선택 함수 (2시간)
**목표**: 답안 선택 기능만 구현
**작업**:
- `selectAnswer(answer, mode)` 함수
- 버튼 클릭 시 선택 상태 표시

**검증 기준**:
- ✅ 답안 버튼 클릭 시 색상 변경
- ✅ 선택된 답안 변수에 저장
- ✅ 다른 답안 선택 시 이전 선택 해제

#### 모듈 2.3: 정답 확인 함수 (3시간)
**목표**: 정답 확인 기능만 구현
**작업**:
- `checkAnswer(mode)` 함수
- 정답/오답 결과 표시

**검증 기준**:
- ✅ 답안 선택 후 정답 확인 버튼 클릭
- ✅ 정답/오답 결과 메시지 표시
- ✅ 정답과 선택한 답안 비교 정확

#### 모듈 2.4: 다음 문제 함수 (2시간)
**목표**: 다음 문제 이동 기능만 구현
**작업**:
- `nextQuestion(mode)` 함수
- 문제 인덱스 증가 및 다음 문제 표시

**검증 기준**:
- ✅ 다음 문제 버튼 클릭 시 문제 변경
- ✅ 마지막 문제에서 경고 메시지
- ✅ 문제 인덱스 정확히 증가

### Phase 3: UI 구현 (2-3일)

#### 모듈 3.1: 홈 화면 (2시간)
**목표**: 학습 모드 선택 화면만 구현
**작업**:
- 홈 화면 HTML 구조
- 기본학습/대분류학습 버튼

**검증 기준**:
- ✅ 홈 화면 정상 표시
- ✅ 버튼 클릭 시 화면 전환
- ✅ 반응형 디자인 적용

#### 모듈 3.2: 기본학습 화면 (3시간)
**목표**: 기본학습 모드 화면만 구현
**작업**:
- 이어풀기/처음풀기/랜덤풀기 버튼
- 기본학습용 문제 표시 영역

**검증 기준**:
- ✅ 기본학습 화면 정상 표시
- ✅ 3가지 풀기 방식 버튼 작동
- ✅ 문제 표시 영역 정상

#### 모듈 3.3: 대분류학습 화면 (3시간)
**목표**: 대분류학습 모드 화면만 구현
**작업**:
- 4개 카테고리 버튼
- 대분류학습용 문제 표시 영역

**검증 기준**:
- ✅ 대분류학습 화면 정상 표시
- ✅ 4개 카테고리 버튼 작동
- ✅ 카테고리 선택 시 문제 로드

### Phase 4: 통계 및 저장 기능 (1-2일)

#### 모듈 4.1: 진도 관리 (2시간)
**목표**: 완료된 문제 수 추적만 구현
**작업**:
- `updateProgress()` 함수
- 완료된 문제 수 계산

**검증 기준**:
- ✅ 문제 풀이 시 진도 증가
- ✅ 화면에 진도율 표시
- ✅ 정확한 계산 확인

#### 모듈 4.2: 정답률 계산 (2시간)
**목표**: 정답/오답 통계만 구현
**작업**:
- `calculateAccuracy()` 함수
- 정답률 계산 및 표시

**검증 기준**:
- ✅ 정답 시 정답률 증가
- ✅ 오답 시 정답률 감소
- ✅ 정확한 백분율 계산

#### 모듈 4.3: 로컬 스토리지 (2시간)
**목표**: 진행상황 저장/복원만 구현
**작업**:
- `saveProgress()` 함수
- `loadProgress()` 함수

**검증 기준**:
- ✅ 페이지 새로고침 후 진행상황 유지
- ✅ 브라우저 재시작 후 진행상황 복원
- ✅ 데이터 정확성 확인

### Phase 5: 테스트 및 최적화 (1-2일)

#### 모듈 5.1: 기능 테스트 (3시간)
**목표**: 모든 모드별 동작 확인
**작업**:
- 각 모드별 엔드투엔드 테스트
- 에러 상황 테스트

**검증 기준**:
- ✅ 모든 모드 정상 작동
- ✅ 에러 상황 적절히 처리
- ✅ 사용자 경험 만족

#### 모듈 5.2: 성능 최적화 (2시간)
**목표**: 로딩 속도 및 메모리 최적화
**작업**:
- 불필요한 코드 제거
- 메모리 사용량 최적화

**검증 기준**:
- ✅ 페이지 로딩 속도 개선
- ✅ 메모리 사용량 감소
- ✅ 성능 지표 개선

## 5. 코딩 규칙

### 5.1 절대 금지사항
- ❌ 기획서 외 추가 기능 구현
- ❌ 자가발전 코딩
- ❌ 200줄 이상의 함수 작성
- ❌ 중복 코드 작성
- ❌ 다음 모듈로 넘어가기 전 검증 생략

### 5.2 필수 준수사항
- ✅ 각 모듈 완료 후 반드시 검증
- ✅ 기획서 순서대로만 코딩
- ✅ 함수당 50줄 이하 유지
- ✅ 주석 필수 작성
- ✅ 모듈별 독립적 테스트

### 5.3 검증 체크리스트
각 모듈 완료 후 다음 항목 확인:
- [ ] 기능 정상 작동
- [ ] 콘솔 에러 없음
- [ ] 브라우저 호환성 확인
- [ ] 성능 문제 없음
- [ ] 다음 모듈과 연동 가능

## 6. 예상 결과

### 6.1 코드 품질
- **현재**: 2,664줄 (땜빵식)
- **목표**: 1,500줄 이하 (통합 구조)
- **중복 함수**: 0개
- **확장성**: 새로운 모드 추가 시 10줄 이하

### 6.2 성능 개선
- 로딩 속도: 30% 향상
- 메모리 사용량: 20% 감소
- 유지보수성: 80% 향상

## 7. 개발 일정

| Phase | 모듈 | 기간 | 주요 작업 | 완료 기준 |
|-------|------|------|-----------|-----------|
| Phase 1 | 1.1-1.3 | 1일 | 기반 구조 | 기본 HTML/CSS/데이터 로드 완성 |
| Phase 2 | 2.1-2.4 | 2일 | 핵심 로직 | 4개 통합 함수 완성 |
| Phase 3 | 3.1-3.3 | 2일 | UI 구현 | 모든 화면 완성 |
| Phase 4 | 4.1-4.3 | 1일 | 통계 기능 | 진도/통계/저장 완성 |
| Phase 5 | 5.1-5.2 | 1일 | 테스트/최적화 | 전체 테스트 통과 |

**총 예상 기간: 7일**

## 8. 승인 및 시작

이 기획서가 승인되면:
1. **모듈 1.1부터 순차적으로 진행**
2. **각 모듈 완료 후 반드시 검증**
3. **기획서 외 추가 작업 금지**
4. **모듈별 진행상황 보고**

---
**작성일**: 2025년 7월 29일  
**작성자**: 나실장  
**승인자**: 조대표님