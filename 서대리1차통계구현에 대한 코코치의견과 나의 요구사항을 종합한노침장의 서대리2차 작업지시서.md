# 📋 AICU QUIZ 앱 통계기능 완성도 향상 과업지시서 V1.2

**작성자**: 코코치 (프로젝트 총괄 팀장)  
**작성일**: 2025.07.29  
**대상**: 서대리님 (개발 담당), 노팀장님 (기술 자문)  
**목표**: 조대표님 요구사항 100% 반영 및 통계기능 완성도 향상

---

## 🎯 **과업 개요**

서대리님께서 통계 기능의 핵심 인프라를 매우 훌륭하게 구축해 주셨습니다. 조대표님의 요구사항과 코코치의 기술 검토 결과를 종합하여, **완성도 85% → 100%** 달성을 위한 최종 완성 과업을 지시합니다.

### **서대리님 개발 성과 평가**
- ✅ **기술적 구현 능력**: 우수 (통합 스키마, 캐시 시스템, 성능 최적화)
- ✅ **체계적 개발 접근**: 뛰어남 (4단계 Phase별 구현)
- ✅ **코드 품질**: 우수 (모듈화, 에러 처리, 성능 모니터링)
- ⚠️ **요구사항 반영**: 85% (일부 조대표님 요구사항 미반영)

---

## 🚨 **최우선 과업 (치명적 문제 해결)**

### **A1. 멀티디바이스 지원 방안 검토 및 구현**

**문제**: 조대표님께서 명시하신 "어떤 디바이스에서도 수치가 계속 업데이트" 요구사항이 현재 localStorage만으로는 불가능

**해결방안 (우선순위별)**:

1. **단기 해결책 (즉시 구현)**:
   ```javascript
   // 사용자 식별 시스템 구현
   function generateUserKey() {
       const userSettings = JSON.parse(localStorage.getItem('aciu_user_settings') || '{}');
       const userKey = `${userSettings.userName}_${userSettings.userPhone}`.replace(/[^a-zA-Z0-9]/g, '_');
       return userKey || 'default_user';
   }
   
   // 사용자별 데이터 저장
   function saveUserStatistics(stats) {
       const userKey = generateUserKey();
       localStorage.setItem(`aciu_statistics_${userKey}`, JSON.stringify(stats));
   }
   ```

2. **중기 해결책 (다음 단계 구현)**:
   - Google Drive API 연동을 통한 클라우드 저장
   - 사용자 인증 기반 데이터 동기화

### **A2. 사용자 등록 시점 데이터 기록 로직 명확화**

**구현 요구사항**:
```javascript
function initializeUserStatistics(userSettings) {
    const stats = statisticsCache.get();
    if (!stats.meta.registeredAt) {
        // 사용자 등록 시점을 명확히 기록
        stats.meta.registeredAt = new Date().toISOString();
        stats.meta.userName = userSettings.userName;
        stats.meta.dataStartDate = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
        
        // 등록 전 데이터 초기화
        resetAllStatistics(stats);
        
        statisticsCache.set(stats);
        statisticsCache.flush();
        
        console.log(`사용자 ${userSettings.userName} 등록 완료. 데이터 기록 시작.`);
    }
}
```

---

## 🎯 **우선 과업 (핵심 요구사항 반영)**

### **B1. "오늘진도율" → "정답률" 변경 (조대표님 명시적 요구)**

**현재 문제**:
```html
<!-- 현재 코드 -->
<div class="text-2xl font-bold text-orange-600" id="daily-progress-rate">0%</div>
<div class="text-sm text-gray-600">오늘 진도율</div>
```

**수정 요구사항**:
```html
<!-- 수정된 코드 -->
<div class="text-2xl font-bold text-orange-600" id="overall-accuracy-rate">0%</div>
<div class="text-sm text-gray-600">정답률</div>
```

**로직 수정**:
```javascript
function updateProgressData(stats) {
    const global = stats.stats.global.cumulative;
    const counts = stats.questionCounts;
    
    // 완료한 문제수
    document.getElementById('completed-questions').textContent = global.attempted.toLocaleString();
    
    // 전체 진도율
    const progressRate = calculateProgress(global.attempted, counts.total);
    document.getElementById('overall-progress-rate').textContent = progressRate + '%';
    
    // 정답률 (오늘진도율 → 정답률로 변경)
    document.getElementById('overall-accuracy-rate').textContent = global.accuracy + '%';
}
```

### **B2. 대분류학습 제목 우측에 전체 누적 통계 배치**

**현재 HTML 구조 수정**:
```html
<!-- 대분류학습 화면 헤더 수정 -->
<div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-semibold">대분류학습</h2>
    
    <!-- 전체 누적 통계 추가 -->
    <div class="bg-green-50 rounded-lg p-4 min-w-[300px]">
        <h3 class="text-sm font-medium text-green-800 mb-2">대분류학습 전체 누적 통계</h3>
        <div class="grid grid-cols-3 gap-3 text-center">
            <div>
                <div class="text-lg font-bold text-green-600" id="large-category-total-attempted">0</div>
                <div class="text-xs text-gray-600">총 문제</div>
            </div>
            <div>
                <div class="text-lg font-bold text-green-600" id="large-category-total-correct">0</div>
                <div class="text-xs text-gray-600">정답</div>
            </div>
            <div>
                <div class="text-lg font-bold text-green-600" id="large-category-total-accuracy">0%</div>
                <div class="text-xs text-gray-600">정답률</div>
            </div>
        </div>
    </div>
    
    <button onclick="goHome()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
        홈으로
    </button>
</div>
```

### **B3. 기본학습/대분류학습 화면에 "누적현황"과 "금일현황" 구분 표시**

**기본학습 화면 통계 섹션 수정**:
```html
<!-- 기존 단일 통계를 2개 박스로 분리 -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
    <!-- 누적 현황 -->
    <div class="p-4 bg-blue-50 rounded">
        <h4 class="font-semibold mb-2 text-blue-800">📊 누적 현황</h4>
        <div class="grid grid-cols-3 gap-2 text-center text-sm">
            <div>
                <div class="text-xl font-bold text-blue-600" id="basic-cumulative-total">0</div>
                <div class="text-xs text-gray-600">총 문제</div>
            </div>
            <div>
                <div class="text-xl font-bold text-green-600" id="basic-cumulative-correct">0</div>
                <div class="text-xs text-gray-600">정답</div>
            </div>
            <div>
                <div class="text-xl font-bold text-purple-600" id="basic-cumulative-accuracy">0%</div>
                <div class="text-xs text-gray-600">정답률</div>
            </div>
        </div>
    </div>
    
    <!-- 금일 현황 -->
    <div class="p-4 bg-orange-50 rounded">
        <h4 class="font-semibold mb-2 text-orange-800">📅 금일 현황</h4>
        <div class="grid grid-cols-3 gap-2 text-center text-sm">
            <div>
                <div class="text-xl font-bold text-orange-600" id="basic-daily-total">0</div>
                <div class="text-xs text-gray-600">오늘 문제</div>
            </div>
            <div>
                <div class="text-xl font-bold text-green-600" id="basic-daily-correct">0</div>
                <div class="text-xs text-gray-600">오늘 정답</div>
            </div>
            <div>
                <div class="text-xl font-bold text-purple-600" id="basic-daily-accuracy">0%</div>
                <div class="text-xs text-gray-600">오늘 정답률</div>
            </div>
        </div>
    </div>
</div>
```

---

## 🔧 **일반 과업 (기술적 개선)**

### **C1. 데이터 키 통일 (aicu → aciu)**

**전체 코드에서 다음 변경**:
```javascript
// 변경 전
localStorage.setItem('aicu_statistics', ...)
localStorage.getItem('aicu_statistics')
localStorage.removeItem('aicu_statistics')

// 변경 후
localStorage.setItem('aciu_statistics', ...)
localStorage.getItem('aciu_statistics')
localStorage.removeItem('aciu_statistics')
```

### **C2. 레거시 코드 정리**

**window.statistics 사용 완전 제거**:
```javascript
// 제거할 함수들의 window.statistics 참조를 statisticsCache.get()으로 변경
function updateStatistics(isCorrect) {
    const stats = statisticsCache.get();
    if (!stats) return;
    
    // window.statistics 대신 stats.stats.global.cumulative 사용
    stats.stats.global.cumulative.attempted++;
    if (isCorrect) {
        stats.stats.global.cumulative.correct++;
    }
    stats.stats.global.cumulative.accuracy = calculateAccuracy(
        stats.stats.global.cumulative.correct,
        stats.stats.global.cumulative.attempted
    );
    
    statisticsCache.set(stats);
    statisticsCache.flush();
}
```

### **C3. 하드코딩 제거**

**updateQuestionCounts() 함수 수정**:
```javascript
function updateQuestionCounts(stats) {
    const counts = stats.questionCounts;
    
    // 하드코딩 제거 - questionCounts에서 가져오기
    document.getElementById('ins-questions').textContent = counts["인스교재"].toLocaleString();
    document.getElementById('exam-questions').textContent = counts["보험중개사시험"].toLocaleString();
    document.getElementById('total-questions').textContent = counts["total"].toLocaleString();
}
```

---

## 🎯 **특별 과업 (조대표님 추가 요구사항)**

### **D1. 보유문제수 현황 정확한 구현**

**ins_master_db.csv SOURCE 필드 분석 로직**:
```javascript
function countQuestionsBySource(csvData) {
    console.log('=== 조대표님 요구사항에 따른 정확한 문제수 카운트 ===');
    
    const counts = {
        "인스교재": 0,
        "보험중개사시험": 0,
        "total": 0
    };
    
    csvData.forEach(row => {
        if (row.SOURCE && row.QCODE && row.QUESTION && row.ANSWER) {
            const source = row.SOURCE.trim();
            
            // 조대표님 요구: "인스교재" 와 "보험중개사시험" 구분
            if (source.includes('인스교재') || source.includes('인스교제')) {
                counts["인스교재"]++;
            } else if (source.includes('보험중개사') || source.includes('중개사시험')) {
                counts["보험중개사시험"]++;
            }
        }
    });
    
    counts.total = counts["인스교재"] + counts["보험중개사시험"];
    
    console.log('SOURCE 필드 분석 결과:', counts);
    return counts;
}
```

### **D2. "이어풀기" 디폴트 설정**

**기본학습 모드 진입 시 이어풀기 자동 선택**:
```javascript
function showBasicLearningScreen() {
    document.getElementById('home-screen').classList.add('hidden');
    document.getElementById('basic-learning-screen').classList.remove('hidden');
    
    // 조대표님 요구: 이어풀기가 디폴트
    setTimeout(() => {
        selectBasicLearningMode('continue');
    }, 100);
}
```

---

## 📋 **작업 순서 및 체크리스트**

### **1단계: 최우선 과업 (오늘 완료)**
- [ ] A1. 사용자별 데이터 저장 구조 구현
- [ ] A2. 사용자 등록 시점 로직 명확화
- [ ] B1. "오늘진도율" → "정답률" 변경
- [ ] D1. SOURCE 필드 정확한 분석 로직

### **2단계: 우선 과업 (내일 완료)**
- [ ] B2. 대분류학습 제목 우측 전체 통계 배치
- [ ] B3. 누적현황/금일현황 구분 UI 구현
- [ ] D2. 이어풀기 디폴트 설정

### **3단계: 일반 과업 (최종 정리)**
- [ ] C1. aicu → aciu 키 통일
- [ ] C2. window.statistics 레거시 코드 제거
- [ ] C3. 하드코딩 제거

### **4단계: 최종 검증**
- [ ] 조대표님 요구사항 100% 반영 확인
- [ ] 코코치 기술 검토 사항 반영 확인
- [ ] 전체 기능 테스트 및 검증

---

## 🤝 **협업 체계**

### **서대리님**
- 위 과업 순서대로 단계별 구현
- 각 단계 완료 시 노팀장님께 코드 리뷰 요청
- 완료 단계별로 코코치에게 진행 상황 보고

### **노팀장님**
- 서대리님 구현 코드의 기술적 품질 검토
- 성능 및 보안 측면에서의 자문 제공
- 코코치가 지적한 기술적 개선사항 검증

### **코코치**
- 조대표님 요구사항 반영도 최종 확인
- 프로젝트 전체 일정 및 품질 관리
- 조대표님께 최종 결과 보고

---

## 🎯 **성공 기준**

1. **요구사항 반영도**: 100% (조대표님 모든 요구사항 반영)
2. **기술적 완성도**: 95% 이상 (코코치 검토 기준)
3. **사용자 경험**: 조대표님 만족도 95% 이상
4. **코드 품질**: 유지보수성 및 확장성 확보

---

**최종 목표**: 조대표님께서 어떤 디바이스에서든 만족스럽게 사용할 수 있는 완벽한 통계 기능 제공

**서대리님, 지금까지의 훌륭한 개발 성과를 바탕으로 이번 최종 완성 과업도 성공적으로 마무리해 주시기 바랍니다! 💪**