<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AICU í•™ìŠµì•± - ì „ì²´ (789ë¬¸ì œ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .question-container { min-height: 200px; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">AICU í•™ìŠµì•± - ì „ì²´ (789ë¬¸ì œ)</h1>
        
        <!-- ë¡œë”© ìƒíƒœ -->
        <div id="loading-area" class="text-center py-8">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
            <p id="loading-status" class="text-gray-600">ins_789_final_dev.csv íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            <div class="mt-2 w-full bg-gray-200 rounded-full h-2">
                <div id="loading-progress" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>

        <!-- ì§„í–‰ ìƒí™© -->
        <div id="progress-area" class="hidden bg-white rounded-lg shadow p-4 mb-6">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm text-gray-600">ì§„í–‰ë¥ </span>
                <span id="progress-text" class="text-sm font-medium">1 / 789</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div id="progress-bar" class="bg-blue-600 h-2 rounded-full" style="width: 0.1%"></div>
            </div>
            </div>

        <!-- ë¬¸ì œ ì˜ì—­ -->
        <div id="quiz-area" class="hidden bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span id="question-type" class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">ì§„ìœ„í˜•</span>
                    <span id="question-code" class="text-sm text-gray-500">ABANK-0001</span>
                </div>
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold">ë¬¸ì œ</h2>
                    <div class="text-xs text-gray-500">
                        <span id="layer-info">06ì¬ì‚°ë³´í—˜ > í™”ì¬ë³´í—˜</span>
                    </div>
                </div>
            </div>

            <div class="question-container mb-6">
                <p id="question-text" class="text-gray-800 leading-relaxed whitespace-pre-wrap">ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>

            <!-- ì§„ìœ„í˜• ë‹µì•ˆ -->
            <div id="true-false-buttons" class="hidden grid grid-cols-2 gap-4 mb-6">
                <button onclick="selectAnswer('O')" class="answer-btn bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-6 rounded-lg transition duration-200" data-answer="O">O (ë§ë‹¤)</button>
                <button onclick="selectAnswer('X')" class="answer-btn bg-red-500 hover:bg-red-600 text-white font-bold py-4 px-6 rounded-lg transition duration-200" data-answer="X">X (í‹€ë¦¬ë‹¤)</button>
            </div>

            <!-- ì„ íƒí˜• ë‹µì•ˆ -->
            <div id="choice-buttons" class="hidden space-y-3 mb-6">
                <button onclick="selectAnswer('1')" class="answer-btn w-full text-left bg-gray-100 hover:bg-gray-200 text-gray-800 py-3 px-4 rounded-lg transition duration-200" data-answer="1">1ë²ˆ</button>
                <button onclick="selectAnswer('2')" class="answer-btn w-full text-left bg-gray-100 hover:bg-gray-200 text-gray-800 py-3 px-4 rounded-lg transition duration-200" data-answer="2">2ë²ˆ</button>
                <button onclick="selectAnswer('3')" class="answer-btn w-full text-left bg-gray-100 hover:bg-gray-200 text-gray-800 py-3 px-4 rounded-lg transition duration-200" data-answer="3">3ë²ˆ</button>
                <button onclick="selectAnswer('4')" class="answer-btn w-full text-left bg-gray-100 hover:bg-gray-200 text-gray-800 py-3 px-4 rounded-lg transition duration-200" data-answer="4">4ë²ˆ</button>
            </div>

            <!-- ê²°ê³¼ í‘œì‹œ -->
            <div id="result-area" class="hidden mb-6 p-4 rounded-lg">
                <p id="result-text" class="font-bold text-lg mb-2"></p>
                <p id="correct-answer" class="text-sm text-gray-600"></p>
                <div id="explanation-area" class="mt-3 p-3 bg-gray-50 rounded border hidden">
                    <p class="text-sm text-gray-700" id="explanation-text"></p>
                </div>
            </div>

            <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ -->
            <div class="flex justify-between">
                <button onclick="prevQuestion()" id="prev-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-6 rounded-lg transition duration-200">ì´ì „</button>
                <button onclick="checkAnswer()" id="check-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg transition duration-200">ì •ë‹µ í™•ì¸</button>
                <button onclick="nextQuestion()" id="next-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg transition duration-200">ë‹¤ìŒ</button>
            </div>
            
            <!-- ë¹ ë¥¸ ì´ë™ -->
            <div class="mt-4 flex flex-wrap gap-2 justify-center">
                <button onclick="jumpToRandom()" class="bg-purple-500 hover:bg-purple-600 text-white text-sm py-1 px-3 rounded">ëœë¤ ë¬¸ì œ</button>
                <button onclick="jumpToQuestion()" class="bg-indigo-500 hover:bg-indigo-600 text-white text-sm py-1 px-3 rounded">ë¬¸ì œ ë²ˆí˜¸ë¡œ ì´ë™</button>
                <button onclick="showStats()" class="bg-gray-500 hover:bg-gray-600 text-white text-sm py-1 px-3 rounded">ìƒì„¸ í†µê³„</button>
            </div>
        </div>

        <!-- í†µê³„ -->
        <div id="stats-area" class="hidden bg-white rounded-lg shadow p-4">
            <h3 class="font-bold mb-2">í•™ìŠµ í†µê³„</h3>
            <div class="grid grid-cols-4 gap-4 text-center">
                <div>
                    <div id="total-answered" class="text-2xl font-bold text-blue-600">0</div>
                    <div class="text-sm text-gray-600">í‘¼ ë¬¸ì œ</div>
                </div>
                <div>
                    <div id="correct-count" class="text-2xl font-bold text-green-600">0</div>
                    <div class="text-sm text-gray-600">ì •ë‹µ</div>
                </div>
                <div>
                    <div id="accuracy" class="text-2xl font-bold text-purple-600">0%</div>
                    <div class="text-sm text-gray-600">ì •ë‹µë¥ </div>
                </div>
                <div>
                    <div id="remaining" class="text-2xl font-bold text-orange-600">789</div>
                    <div class="text-sm text-gray-600">ë‚¨ì€ ë¬¸ì œ</div>
                </div>
            </div>
        </div>

        <!-- íŒŒì¼ ì •ë³´ -->
        <div class="mt-4 text-center text-sm text-gray-500">
            <p>ë°ì´í„° ì†ŒìŠ¤: <span id="data-source">ins_789_final_dev.csv</span></p>
            <p>ë¡œë“œëœ ë¬¸ì œ ìˆ˜: <span id="loaded-count">0</span>ê°œ</p>
            <p class="mt-2 text-xs">ğŸŒ GitHub Pages ë˜ëŠ” ë¡œì»¬ ì›¹ì„œë²„ì—ì„œ ì™„ë²½ ë™ì‘</p>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let questions = [];
        let currentQuestionIndex = 0; 
        let selectedAnswer = null;
        let answered = false;
        let stats = {
            totalAnswered: 0,
            correctCount: 0
        };

        // CSV íŒŒì¼ ë¡œë”© í•¨ìˆ˜ (789ê°œ ì „ì²´)
        async function loadCSVData() {
            const loadingStatus = document.getElementById('loading-status');
            const loadingProgress = document.getElementById('loading-progress');
            
            try {
                loadingStatus.textContent = "ins_789_final_dev.csv íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘...";
                loadingProgress.style.width = "10%";
                
                // ì‹¤ì œ íŒŒì¼ëª…: ins_789_final_dev.csv
                const response = await fetch('ins_789_final_dev.csv');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                loadingStatus.textContent = "ëŒ€ìš©ëŸ‰ CSV íŒŒì¼ íŒŒì‹± ì¤‘... (ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”)";
                loadingProgress.style.width = "50%";
                
                const csvContent = await response.text();
                
                loadingStatus.textContent = "789ê°œ ë¬¸ì œ ë°ì´í„° ì²˜ë¦¬ ì¤‘...";
                loadingProgress.style.width = "80%";
                
                // PapaParseë¡œ CSV íŒŒì‹± (ëŒ€ìš©ëŸ‰ ìµœì í™”)
                const parsed = Papa.parse(csvContent, {
                    header: true,
                    dynamicTyping: false,
                    skipEmptyLines: true,
                    delimiter: ',',
                    quoteChar: '"',
                    fastMode: true // ëŒ€ìš©ëŸ‰ íŒŒì¼ ìµœì í™”
                });
                
                if (parsed.errors.length > 0) {
                    console.warn('CSV íŒŒì‹± ê²½ê³ :', parsed.errors.slice(0, 5)); // ì²˜ìŒ 5ê°œë§Œ í‘œì‹œ
                }
                
                // ì¸ìŠ¤êµì¬ ë¬¸ì œë§Œ í•„í„°ë§ ë° ìœ íš¨ì„± ê²€ì‚¬
                questions = parsed.data.filter(row => 
                    row.SOURCE === 'ì¸ìŠ¤êµì¬' && 
                    row.QCODE && 
                    row.QUESTION && 
                    row.ANSWER
                );
                
                loadingStatus.textContent = `${questions.length}ê°œ ì¸ìŠ¤êµì¬ ë¬¸ì œ ë¡œë“œ ì™„ë£Œ!`;
                loadingProgress.style.width = "100%";
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('loaded-count').textContent = questions.length;
                document.getElementById('progress-text').textContent = `1 / ${questions.length}`;
                document.getElementById('remaining').textContent = questions.length;
                
                // ë¡œë”© ì™„ë£Œ í›„ ì•± ì‹œì‘
                setTimeout(startQuiz, 1000);
                
            } catch (error) {
                console.error('CSV ë¡œë”© ì˜¤ë¥˜:', error);
                loadingStatus.innerHTML = `
                    <span class="text-red-600 font-bold">CSV ë¡œë”© ì‹¤íŒ¨: ${error.message}</span><br>
                    <span class="text-sm mt-2">í•´ê²° ë°©ë²•:</span><br>
                    <span class="text-sm">1. ins_789_final_dev.csv íŒŒì¼ì´ ê°™ì€ í´ë”ì— ìˆëŠ”ì§€ í™•ì¸</span><br>
                    <span class="text-sm">2. GitHub Pagesì—ì„œ ì‹¤í–‰ (ê¶Œì¥)</span><br>
                    <span class="text-sm">3. ë¡œì»¬ ì›¹ì„œë²„ ì‚¬ìš© (python -m http.server)</span>
                `;
                loadingProgress.style.width = "0%";
            }
        }

        // í€´ì¦ˆ ì‹œì‘
        function startQuiz() {
            document.getElementById('loading-area').classList.add('hidden');
            document.getElementById('progress-area').classList.remove('hidden');
            document.getElementById('quiz-area').classList.remove('hidden');
            document.getElementById('stats-area').classList.remove('hidden');
            
            displayQuestion();
            updateStats();
        }

        // ë¬¸ì œ í‘œì‹œ
        function displayQuestion() {
            if (questions.length === 0) {
                document.getElementById('question-text').textContent = "ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                return;
            }

            const question = questions[currentQuestionIndex];
            
            // ë¬¸ì œ ì •ë³´ ì—…ë°ì´íŠ¸
            document.getElementById('question-type').textContent = question.TYPE;
            document.getElementById('question-code').textContent = question.QCODE;
            document.getElementById('question-text').textContent = question.QUESTION;
            
            // ë¶„ë¥˜ ì •ë³´ í‘œì‹œ
            document.getElementById('layer-info').textContent = `${question.LAYER1} > ${question.LAYER2}`;
            
            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            document.getElementById('progress-text').textContent = `${currentQuestionIndex + 1} / ${questions.length}`;
            document.getElementById('progress-bar').style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;
            
            // ë‹µì•ˆ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
            if (question.TYPE === 'ì§„ìœ„í˜•') {
                document.getElementById('true-false-buttons').classList.remove('hidden');
                document.getElementById('choice-buttons').classList.add('hidden');
            } else {
                document.getElementById('true-false-buttons').classList.add('hidden');
                document.getElementById('choice-buttons').classList.remove('hidden');
            }
            
            // ìƒíƒœ ì´ˆê¸°í™”
            selectedAnswer = null;
            answered = false;
            document.getElementById('result-area').classList.add('hidden');
            document.getElementById('explanation-area').classList.add('hidden');
            document.getElementById('check-btn').classList.remove('hidden');
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.classList.remove('bg-blue-200', 'border-blue-500', 'border-2', 'bg-green-300', 'bg-red-300');
                btn.disabled = false;
            });
            
            // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ ìƒíƒœ
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').style.display = answered ? 'block' : 'none';
        }

        // ë‹µì•ˆ ì„ íƒ
        function selectAnswer(answer) {
            if (answered) return;
            
            selectedAnswer = answer;
            
            // ëª¨ë“  ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.classList.remove('bg-blue-200', 'border-blue-500', 'border-2');
            });
            
            // ì„ íƒëœ ë²„íŠ¼ ê°•ì¡°
            document.querySelector(`[data-answer="${answer}"]`).classList.add('bg-blue-200', 'border-blue-500', 'border-2');
        }

        // ì •ë‹µ í™•ì¸
        function checkAnswer() {
            if (!selectedAnswer || answered) return;
            
            const question = questions[currentQuestionIndex];
            const isCorrect = selectedAnswer === question.ANSWER;
            
            answered = true;
            stats.totalAnswered++;
            if (isCorrect) stats.correctCount++;
            
            // ê²°ê³¼ í‘œì‹œ
            const resultArea = document.getElementById('result-area');
            const resultText = document.getElementById('result-text');
            const correctAnswerText = document.getElementById('correct-answer');

            if (isCorrect) { 
                resultText.textContent = 'ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰';
                resultText.className = 'font-bold text-lg mb-2 text-green-600';
                resultArea.className = 'mb-6 p-4 rounded-lg bg-green-50 border border-green-200';
            } else {
                resultText.textContent = 'ì˜¤ë‹µì…ë‹ˆë‹¤ ğŸ˜”';
                resultText.className = 'font-bold text-lg mb-2 text-red-600';
                resultArea.className = 'mb-6 p-4 rounded-lg bg-red-50 border border-red-200';
                correctAnswerText.textContent = `ì •ë‹µ: ${question.ANSWER}`;
            }
            
            // í•´ì„¤ í‘œì‹œ (ìˆëŠ” ê²½ìš°)
            if (question.EXPLAIN && question.EXPLAIN.trim() !== '') {
                document.getElementById('explanation-text').textContent = question.EXPLAIN;
                document.getElementById('explanation-area').classList.remove('hidden');
            }
            
            resultArea.classList.remove('hidden');
            document.getElementById('check-btn').classList.add('hidden');
            document.getElementById('next-btn').style.display = 'block';
            
            // ì •ë‹µ í‘œì‹œ
            document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.disabled = true;
                if (btn.dataset.answer === question.ANSWER) {
                    btn.classList.add('bg-green-300');
                } else if (btn.dataset.answer === selectedAnswer && selectedAnswer !== question.ANSWER) {
                    btn.classList.add('bg-red-300');
                }
            });
            
            updateStats();
        }

        // ë‹¤ìŒ ë¬¸ì œ
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                alert('ëª¨ë“  789ê°œ ë¬¸ì œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ğŸ‰ğŸ‰ğŸ‰');
            }
        }

        // ì´ì „ ë¬¸ì œ
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        // ëœë¤ ë¬¸ì œë¡œ ì´ë™
        function jumpToRandom() {
            currentQuestionIndex = Math.floor(Math.random() * questions.length);
            displayQuestion();
        }

        // ë¬¸ì œ ë²ˆí˜¸ë¡œ ì´ë™
        function jumpToQuestion() {
            const questionNum = prompt(`ë¬¸ì œ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (1-${questions.length}):`);
            if (questionNum) {
                const num = parseInt(questionNum) - 1;
                if (num >= 0 && num < questions.length) {
                    currentQuestionIndex = num;
                    displayQuestion();
                } else {
                    alert('ì˜¬ë°”ë¥¸ ë¬¸ì œ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // ìƒì„¸ í†µê³„ í‘œì‹œ
        function showStats() {
            const remaining = questions.length - stats.totalAnswered;
            const accuracy = stats.totalAnswered > 0 ? Math.round((stats.correctCount / stats.totalAnswered) * 100) : 0;
            
            alert(`ìƒì„¸ í†µê³„\nì´ ë¬¸ì œ: ${questions.length}ê°œ\ní‘¼ ë¬¸ì œ: ${stats.totalAnswered}ê°œ\nì •ë‹µ: ${stats.correctCount}ê°œ\nì˜¤ë‹µ: ${stats.totalAnswered - stats.correctCount}ê°œ\nì •ë‹µë¥ : ${accuracy}%\në‚¨ì€ ë¬¸ì œ: ${remaining}ê°œ`);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            document.getElementById('total-answered').textContent = stats.totalAnswered;
            document.getElementById('correct-count').textContent = stats.correctCount;
            const accuracy = stats.totalAnswered > 0 ? Math.round((stats.correctCount / stats.totalAnswered) * 100) : 0;
            document.getElementById('accuracy').textContent = accuracy + '%';
            document.getElementById('remaining').textContent = questions.length - stats.totalAnswered;
        }

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') prevQuestion();
            if (e.key === 'ArrowRight') nextQuestion();
            if (e.key === 'Enter') checkAnswer();
            if (e.key === '1') selectAnswer('1');
            if (e.key === '2') selectAnswer('2');
            if (e.key === '3') selectAnswer('3');
            if (e.key === '4') selectAnswer('4');
            if (e.key === 'o' || e.key === 'O') selectAnswer('O');
            if (e.key === 'x' || e.key === 'X') selectAnswer('X');
            if (e.key === 'r' || e.key === 'R') jumpToRandom();
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ CSV ë°ì´í„° ë¡œë”© ì‹œì‘
        window.addEventListener('load', loadCSVData);
    </script>
</body>
</html>