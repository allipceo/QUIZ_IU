<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AICU QUIZ ì•±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .hidden { display: none; }
        
        /* ì¤‘ë¶„ë¥˜ í•™ìŠµ ëª¨ë“œ ìŠ¤íƒ€ì¼ë§ */
        /* ë©”ì¸ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ì˜ì—­ */
        .main-category-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            max-width: 600px;
            margin: 0 auto 20px;
        }

        .main-category-button {
            min-height: 60px;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
        }

        .main-category-button:hover {
            background: #f0f9ff;
            border-color: #3b82f6;
            transform: translateY(-2px);
        }

        .main-category-button.active {
            background: #3b82f6;
            color: white;
            border-color: #2563eb;
            font-weight: bold;
        }

        .main-category-button.other-button {
            background: #f3f4f6;
            border-style: dashed;
        }

        .main-category-button.other-button:hover {
            background: #e5e7eb;
        }

        /* ë¬¸ì œ ìˆ˜ í‘œì‹œ */
        .category-count {
            display: block;
            font-size: 12px;
            color: #6b7280;
            margin-top: 4px;
        }

        .active .category-count {
            color: #e5e7eb;
        }

        /* ê¸°íƒ€ ì¹´í…Œê³ ë¦¬ ìƒì„¸ ì˜ì—­ */
        .other-category-section {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
            max-height: 0; /* ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•´ ì¶”ê°€ */
            overflow: hidden; /* ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•´ ì¶”ê°€ */
            transition: max-height 0.3s ease-in-out; /* ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•´ ì¶”ê°€ */
        }

        .other-category-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 12px 0;
        }

        .other-category-button {
            font-size: 12px;
            padding: 8px 12px;
            min-height: 36px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .other-category-button:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }

        .other-category-button.active {
            background: #1f2937;
            color: white;
            border-color: #374151;
        }

        .close-other-btn {
            width: 100%;
            padding: 8px;
            background: #e5e7eb;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 8px;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .main-category-buttons {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .main-category-button {
                min-height: 50px;
                font-size: 14px;
                padding: 10px 12px;
            }
            
            .other-category-button {
                font-size: 11px;
                padding: 6px 10px;
                min-height: 32px;
            }
        }

        /* statistics1.html ìŠ¤íƒ€ì¼ í†µí•© */
        .card {
            background-color: #ffffff;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-md */
            padding: 1.5rem; /* p-6 */
        }
        .large-number {
            font-size: 2.5rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1d4ed8; /* Tailwind blue-700 */
        }
        .sub-text {
            font-size: 0.875rem; /* text-sm */
            color: #6b7280; /* Tailwind gray-500 */
        }
        .progress-bar-container {
            background-color: #e5e7eb; /* Tailwind gray-200 */
            border-radius: 0.5rem; /* rounded-full */
            height: 0.75rem; /* h-3 */
            overflow: hidden;
        }
        .progress-bar {
            background-color: #3b82f6; /* Tailwind blue-500 */
            height: 100%;
            border-radius: 0.5rem; /* rounded-full */
            transition: width 0.5s ease-in-out;
        }
        .category-card {
            background-color: #eff6ff; /* Tailwind blue-50 */
            border-radius: 0.75rem; /* rounded-xl */
            padding: 1rem; /* p-4 */
            border: 1px solid #bfdbfe; /* Tailwind blue-200 */
        }
        .category-title {
            font-size: 1.125rem; /* text-lg */
            font-weight: 700; /* font-bold */
            color: #1e40af; /* Tailwind blue-800 */
        }
        .category-progress-number {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 700; /* font-bold */
            color: #1d4ed8; /* Tailwind blue-700 */
        }
        .cut-off-info {
            background-color: #fef2f2; /* Tailwind red-50 */
            border: 1px solid #fca5a5; /* Tailwind red-300 */
            color: #dc2626; /* Tailwind red-600 */
            padding: 0.75rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-align: center;
        }
        .average-score-card {
            background-color: #ecfdf5; /* Tailwind green-50 */
            border: 1px solid #a7f3d0; /* Tailwind green-300 */
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .average-score-number {
            font-size: 3rem; /* text-5xl */
            font-weight: 700; /* font-bold */
            color: #047857; /* Tailwind green-700 */
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="bg-white shadow-lg">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <h1 class="text-xl font-bold text-blue-700">ACIU QUIZ ì•±</h1>
                    <span class="text-sm text-gray-600" id="current-mode">ëª¨ë“œ ì„ íƒ</span>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-sm text-gray-600">
                        <span id="user-info">ì‚¬ìš©ì: ì¡°ëŒ€í‘œë‹˜</span> | 
                        <span id="exam-dday">D-90ì¼</span>
                    </div>
                    <div class="text-sm text-gray-600" id="current-time"></div>
                    <button onclick="ACIUApp.ui.showSettingsModal()" class="text-gray-600 hover:text-blue-600">
                        âš™ï¸
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="container mx-auto px-4 py-6 max-w-6xl">
        <!-- ì˜¤ëŠ˜ì˜ ëª…ì–¸ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="text-center">
                <p class="text-lg text-gray-700 italic" id="quote-of-day">
                    "í•™ìŠµì€ ê°€ì¥ ì¢‹ì€ íˆ¬ìì…ë‹ˆë‹¤."
                </p>
            </div>
        </div>

        <!-- ë³´ìœ  ë¬¸ì œìˆ˜ í˜„í™© -->
        <div class="card mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ“Š ë³´ìœ  ë¬¸ì œ í˜„í™©</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                <!-- ì¸ìŠ¤êµì¬ -->
                <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <p class="text-sm text-gray-600 mb-1">ì¸ìŠ¤êµì¬</p>
                    <p class="large-number" id="ins-total-count">0</p>
                    <p class="sub-text">ì„ íƒí˜• <span id="ins-choice-count">0</span>ê°œ | ì§„ìœ„í˜• <span id="ins-tf-count">0</span>ê°œ</p>
                </div>
                <!-- ë³´í—˜ì¤‘ê°œì‚¬ì‹œí—˜ -->
                <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                    <p class="text-sm text-gray-600 mb-1">ë³´í—˜ì¤‘ê°œì‚¬ì‹œí—˜</p>
                    <p class="large-number" id="broker-total-count">0</p>
                    <p class="sub-text">ì§„ìœ„í˜• <span id="broker-tf-count">0</span>ê°œ | ì„ íƒí˜• <span id="broker-choice-count">0</span>ê°œ</p>
                </div>
                <!-- ì´ê³„ -->
                <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                    <p class="text-sm text-gray-600 mb-1">ì´ê³„</p>
                    <p class="large-number" id="total-question-count">0</p>
                    <p class="sub-text">ì „ì²´ ë¬¸ì œ ìˆ˜</p>
                </div>
            </div>
        </div>

        <!-- í•™ìŠµ ì§„ë„ ìš”ì•½ -->
        <div class="card mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ“ˆ í•™ìŠµ ì§„ë„ í˜„í™© (ëŒ€ë¶„ë¥˜ë³„)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="category-progress-display">
                <!-- ì¬ì‚°ë³´í—˜ -->
                <div class="category-card">
                    <h3 class="category-title mb-2">ì¬ì‚°ë³´í—˜</h3>
                    <p class="text-gray-700 text-sm mb-1">
                        í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="prop-completed">0</span> / <span id="prop-total">0</span>
                    </p>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: 0%;"></div>
                    </div>
                    <p class="text-right text-base font-semibold text-blue-600 mt-1" id="prop-percentage">0%</p>
                    <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="prop-unlearned">0</span>ê°œ</p>
                </div>
                <!-- íŠ¹ì¢…ë³´í—˜ -->
                <div class="category-card">
                    <h3 class="category-title mb-2">íŠ¹ì¢…ë³´í—˜</h3>
                    <p class="text-gray-700 text-sm mb-1">
                        í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="spec-completed">0</span> / <span id="spec-total">0</span>
                    </p>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: 0%;"></div>
                    </div>
                    <p class="text-right text-base font-semibold text-blue-600 mt-1" id="spec-percentage">0%</p>
                    <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="spec-unlearned">0</span>ê°œ</p>
                </div>
                <!-- ë°°ìƒì±…ì„ë³´í—˜ -->
                <div class="category-card">
                    <h3 class="category-title mb-2">ë°°ìƒì±…ì„ë³´í—˜</h3>
                    <p class="text-gray-700 text-sm mb-1">
                        í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="liab-completed">0</span> / <span id="liab-total">0</span>
                    </p>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: 0%;"></div>
                    </div>
                    <p class="text-right text-base font-semibold text-blue-600 mt-1" id="liab-percentage">0%</p>
                    <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="liab-unlearned">0</span>ê°œ</p>
                </div>
                <!-- í•´ìƒë³´í—˜ -->
                <div class="category-card">
                    <h3 class="category-title mb-2">í•´ìƒë³´í—˜</h3>
                    <p class="text-gray-700 text-sm mb-1">
                        í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="marine-completed">0</span> / <span id="marine-total">0</span>
                    </p>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: 0%;"></div>
                    </div>
                    <p class="text-right text-base font-semibold text-blue-600 mt-1" id="marine-percentage">0%</p>
                    <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="marine-unlearned">0</span>ê°œ</p>
                </div>
            </div>
            <!-- 4ê³¼ëª© í‰ê·  ì ìˆ˜ ì¹´ë“œ -->
            <div class="mt-8">
                <div class="average-score-card">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">4ê³¼ëª© í‰ê·  í•™ìŠµë¥ </h3>
                    <p class="average-score-number" id="average-percentage">0%</p>
                    <p class="text-gray-600 text-sm">í•©ê²© ì»¤íŠ¸ë¼ì¸: **60% ì´ìƒ**</p>
                </div>
            </div>
            <!-- ì»¤íŠ¸ë¼ì¸ ì •ë³´ ì¶”ê°€ -->
            <div class="mt-8 space-y-4">
                <div class="cut-off-info">
                    <p class="text-lg">âœ… **í•©ê²© ê¸°ì¤€:**</p>
                    <p class="text-md mt-2">ê³¼ëª©ë³„ ì»¤íŠ¸ë¼ì¸: **40ì  ì´ìƒ**</p>
                    <p class="text-md">4ê³¼ëª© í‰ê·  ì»¤íŠ¸ë¼ì¸: **60ì  ì´ìƒ**</p>
                </div>
            </div>
        </div>

        <!-- í•™ìŠµ ëª¨ë“œ ì„ íƒ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">í•™ìŠµ ëª¨ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4">
                <button onclick="ACIUApp.learning.startMode('basic')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-6 rounded-lg">
                    ê¸°ë³¸ í•™ìŠµ
                </button>
                <button onclick="ACIUApp.learning.startMode('layer1')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-6 rounded-lg">
                    ëŒ€ë¶„ë¥˜ í•™ìŠµ
                </button>
                <button onclick="ACIUApp.learning.startMode('layer2')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-4 px-6 rounded-lg">
                    ì¤‘ë¶„ë¥˜ í•™ìŠµ
                </button>
                <button onclick="ACIUApp.learning.startMode('choice')" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-4 px-6 rounded-lg">
                    ì„ íƒí˜• í•™ìŠµ
                </button>
                <button onclick="ACIUApp.learning.startMode('truefalse')" class="bg-red-500 hover:bg-red-600 text-white font-bold py-4 px-6 rounded-lg">
                    ì§„ìœ„í˜• í•™ìŠµ
                </button>
                <button onclick="ACIUApp.learning.startMode('mock')" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-4 px-6 rounded-lg">
                    ëª¨ì˜ê³ ì‚¬
                </button>
            </div>
        </div>

        <!-- ê¸°ë³¸ í•™ìŠµ í™”ë©´ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
        <div id="basic-learning-screen" class="hidden">
            <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="bg-white rounded-lg shadow-lg p-4 mb-6">
                <div class="flex justify-between items-center">
                    <button onclick="ACIUApp.ui.goToHome()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                        ğŸ  í™ˆìœ¼ë¡œ
                    </button>
                    <h2 class="text-xl font-semibold text-gray-800">ê¸°ë³¸ í•™ìŠµ</h2>
                    <div class="text-sm text-gray-600">
                        ë¬¸ì œ <span id="current-question-number">1</span> / <span id="total-questions">1379</span>
                    </div>
                </div>
            </div>

            <!-- í†µê³„ ìë£Œ (ë”ë¯¸ ë°ì´í„°) -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-white rounded-lg shadow-lg p-4">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">í•™ìŠµ í˜„í™©</h3>
                    <p class="text-2xl font-bold text-blue-600" id="learning-progress">3.3%</p>
                    <p class="text-sm text-gray-600">ì´ 1379ë¬¸ì œ ì¤‘ 45ë¬¸ì œ ì™„ë£Œ</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-4">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">í•™ìŠµ ì„±ê³¼</h3>
                    <p class="text-2xl font-bold text-green-600" id="learning-performance">71%</p>
                    <p class="text-sm text-gray-600">í’€ì´ 45ë¬¸ì œ ì¤‘ 32ë¬¸ì œ ì •ë‹µ</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-4">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">ì˜¤ëŠ˜ì˜ í†µê³„</h3>
                    <p class="text-2xl font-bold text-orange-600" id="today-stats">75%</p>
                    <p class="text-sm text-gray-600">ì˜¤ëŠ˜ 8ë¬¸ì œ í’€ì´</p>
                </div>
            </div>

            <!-- ë¬¸ì œ í’€ì´ ê¸°ëŠ¥ ì„ íƒ -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">ë¬¸ì œ í’€ì´ ë°©ì‹ ì„ íƒ</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <button onclick="ACIUApp.learning.startContinue()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg">
                        ì´ì–´í’€ê¸°
                    </button>
                    <button onclick="ACIUApp.learning.startFromBeginning()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg">
                        ì²˜ìŒë¶€í„° í’€ê¸°
                    </button>
                    <button onclick="ACIUApp.learning.startRandom()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-4 rounded-lg">
                        ëœë¤ í’€ê¸°
                    </button>
                </div>
                <div class="text-center">
                    <span class="text-sm text-gray-600">í˜„ì¬: í•œ ë¬¸ì œì”© í’€ê¸°</span>
                </div>
            </div>

            <!-- ë¬¸ì œ í‘œì‹œ ì˜ì—­ -->
            <div id="question-area" class="hidden">
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <!-- ë¬¸ì œ ì •ë³´ -->
                    <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-gray-600" id="question-type">ì§„ìœ„í˜•</span>
                            <span class="text-sm text-gray-600" id="question-code">ABANK-0001</span>
                        </div>
                        <div class="text-sm text-gray-600 mb-2">
                            <span id="layer-info">06ì¬ì‚°ë³´í—˜ > í™”ì¬ë³´í—˜</span>
                        </div>
                    </div>

                    <!-- ë¬¸ì œ ë‚´ìš© -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ë¬¸ì œ</h3>
                        <p class="text-gray-700 leading-relaxed" id="question-text">
                            ë¬¸ì œ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                        </p>
                    </div>

                    <!-- ë‹µì•ˆ ì„ íƒ -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ë‹µì•ˆ ì„ íƒ</h3>
                        <div id="answer-buttons" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- ì§„ìœ„í˜• ë²„íŠ¼ (ê¸°ë³¸) -->
                            <button onclick="ACIUApp.learning.selectAnswer('O')" class="answer-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="O">
                                O
                            </button>
                            <button onclick="ACIUApp.learning.selectAnswer('X')" class="answer-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="X">
                                X
                            </button>
                        </div>
                    </div>

                    <!-- ê²°ê³¼ í‘œì‹œ -->
                    <div id="result-area" class="hidden mb-6">
                        <div class="p-4 rounded-lg" id="result-message">
                            <!-- ê²°ê³¼ ë©”ì‹œì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
                    <div class="flex justify-between items-center">
                        <button onclick="ACIUApp.learning.prevQuestion()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                            ì´ì „ ë¬¸ì œ
                        </button>
                        <div class="flex space-x-2">
                            <button onclick="ACIUApp.learning.checkAnswer()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                                ì •ë‹µ í™•ì¸
                            </button>
                            <button onclick="ACIUApp.learning.showExplanation()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg hidden" id="explanation-btn">
                                í•´ì„¤ ë³´ê¸°
                            </button>
                        </div>
                        <button onclick="ACIUApp.learning.nextQuestion()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                            ë‹¤ìŒ ë¬¸ì œ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ëŒ€ë¶„ë¥˜ í•™ìŠµ í™”ë©´ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
        <div id="large-category-learning-screen" class="hidden">
            <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="bg-white rounded-lg shadow-lg p-4 mb-6">
                <div class="flex justify-between items-center">
                    <button onclick="ACIUApp.ui.goToHome()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                        ğŸ  í™ˆìœ¼ë¡œ
                    </button>
                    <h2 class="text-xl font-semibold text-gray-800">ëŒ€ë¶„ë¥˜ í•™ìŠµ</h2>
                    <div class="text-sm text-gray-600">
                        ì„ íƒëœ ëŒ€ë¶„ë¥˜: <span id="selected-category">ì—†ìŒ</span>
                    </div>
                </div>
            </div>

            <!-- ë³´ìœ  ë¬¸ì œ í˜„í™© (ìƒì„¸) -->
            <div class="card mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ“Š ë³´ìœ  ë¬¸ì œ í˜„í™©</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                    <!-- ì¸ìŠ¤êµì¬ -->
                    <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <p class="text-sm text-gray-600 mb-1">ì¸ìŠ¤êµì¬</p>
                        <p class="large-number" id="large-ins-total-count">0</p>
                        <p class="sub-text">ì„ íƒí˜• <span id="large-ins-choice-count">0</span>ê°œ | ì§„ìœ„í˜• <span id="large-ins-tf-count">0</span>ê°œ</p>
                    </div>
                    <!-- ë³´í—˜ì¤‘ê°œì‚¬ì‹œí—˜ -->
                    <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                        <p class="text-sm text-gray-600 mb-1">ë³´í—˜ì¤‘ê°œì‚¬ì‹œí—˜</p>
                        <p class="large-number" id="large-broker-total-count">0</p>
                        <p class="sub-text">ì§„ìœ„í˜• <span id="large-broker-tf-count">0</span>ê°œ | ì„ íƒí˜• <span id="large-broker-choice-count">0</span>ê°œ</p>
                    </div>
                    <!-- ì´ê³„ -->
                    <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                        <p class="text-sm text-gray-600 mb-1">ì´ê³„</p>
                        <p class="large-number" id="large-total-question-count">0</p>
                        <p class="sub-text">ì „ì²´ ë¬¸ì œ ìˆ˜</p>
                    </div>
                </div>
            </div>

            <!-- í•™ìŠµ ì§„ë„ í˜„í™© (ëŒ€ë¶„ë¥˜ë³„) -->
            <div class="card mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ“ˆ í•™ìŠµ ì§„ë„ í˜„í™© (ëŒ€ë¶„ë¥˜ë³„)</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="large-category-progress-display">
                    <!-- ì¬ì‚°ë³´í—˜ -->
                    <div class="category-card">
                        <h3 class="category-title mb-2">ì¬ì‚°ë³´í—˜</h3>
                        <p class="text-gray-700 text-sm mb-1">
                            í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="large-prop-completed">0</span> / <span id="large-prop-total">0</span>
                        </p>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 0%;"></div>
                        </div>
                        <p class="text-right text-base font-semibold text-blue-600 mt-1" id="large-prop-percentage">0%</p>
                        <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="large-prop-unlearned">0</span>ê°œ</p>
                    </div>
                    <!-- íŠ¹ì¢…ë³´í—˜ -->
                    <div class="category-card">
                        <h3 class="category-title mb-2">íŠ¹ì¢…ë³´í—˜</h3>
                        <p class="text-gray-700 text-sm mb-1">
                            í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="spec-completed">0</span> / <span id="spec-total">0</span>
                        </p>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 0%;"></div>
                        </div>
                        <p class="text-right text-base font-semibold text-blue-600 mt-1" id="spec-percentage">0%</p>
                        <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="spec-unlearned">0</span>ê°œ</p>
                    </div>
                    <!-- ë°°ìƒì±…ì„ë³´í—˜ -->
                    <div class="category-card">
                        <h3 class="category-title mb-2">ë°°ìƒì±…ì„ë³´í—˜</h3>
                        <p class="text-gray-700 text-sm mb-1">
                            í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="liab-completed">0</span> / <span id="liab-total">0</span>
                        </p>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 0%;"></div>
                        </div>
                        <p class="text-right text-base font-semibold text-blue-600 mt-1" id="liab-percentage">0%</p>
                        <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="liab-unlearned">0</span>ê°œ</p>
                    </div>
                    <!-- í•´ìƒë³´í—˜ -->
                    <div class="category-card">
                        <h3 class="category-title mb-2">í•´ìƒë³´í—˜</h3>
                        <p class="text-gray-700 text-sm mb-1">
                            í•™ìŠµ í˜„í™©: <span class="category-progress-number" id="marine-completed">0</span> / <span id="marine-total">0</span>
                        </p>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 0%;"></div>
                        </div>
                        <p class="text-right text-base font-semibold text-blue-600 mt-1" id="marine-percentage">0%</p>
                        <p class="text-gray-600 text-sm mt-2">ë¯¸í•™ìŠµ ë¬¸ì œ: <span id="marine-unlearned">0</span>ê°œ</p>
                    </div>
                </div>
                <!-- 4ê³¼ëª© í‰ê·  ì ìˆ˜ ì¹´ë“œ -->
                <div class="mt-8">
                    <div class="average-score-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">4ê³¼ëª© í‰ê·  í•™ìŠµë¥ </h3>
                        <p class="average-score-number" id="large-average-percentage">0%</p>
                        <p class="text-gray-600 text-sm">í•©ê²© ì»¤íŠ¸ë¼ì¸: **60% ì´ìƒ**</p>
                    </div>
                </div>
                <!-- ì»¤íŠ¸ë¼ì¸ ì •ë³´ ì¶”ê°€ -->
                <div class="mt-8 space-y-4">
                    <div class="cut-off-info">
                        <p class="text-lg">âœ… **í•©ê²© ê¸°ì¤€:**</p>
                        <p class="text-md mt-2">ê³¼ëª©ë³„ ì»¤íŠ¸ë¼ì¸: **40ì  ì´ìƒ**</p>
                        <p class="text-md">4ê³¼ëª© í‰ê·  ì»¤íŠ¸ë¼ì¸: **60ì  ì´ìƒ**</p>
                    </div>
                </div>
            </div>

            <!-- ëŒ€ë¶„ë¥˜ ì„ íƒ -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">ëŒ€ë¶„ë¥˜ ì„ íƒ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="large-category-buttons-container">
                    <!-- ëŒ€ë¶„ë¥˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤. -->
                </div>
            </div>

            <!-- ë¬¸ì œ í‘œì‹œ ì˜ì—­ (ëŒ€ë¶„ë¥˜ ì„ íƒ í›„ í‘œì‹œ) -->
            <div id="large-category-question-area" class="hidden">
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <!-- ë¬¸ì œ ì •ë³´ -->
                    <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-gray-600" id="large-category-question-type">ì§„ìœ„í˜•</span>
                            <span class="text-sm text-gray-600" id="large-category-question-code">ABANK-0001</span>
                        </div>
                        <div class="text-sm text-gray-600 mb-2">
                            <span id="large-category-layer-info">06ì¬ì‚°ë³´í—˜ > í™”ì¬ë³´í—˜</span>
                        </div>
                    </div>

                    <!-- ë¬¸ì œ ë‚´ìš© -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ë¬¸ì œ</h3>
                        <p class="text-gray-700 leading-relaxed" id="large-category-question-text">
                            ëŒ€ë¶„ë¥˜ë¥¼ ì„ íƒí•˜ë©´ ë¬¸ì œê°€ í‘œì‹œë©ë‹ˆë‹¤.
                        </p>
                    </div>

                    <!-- ë‹µì•ˆ ì„ íƒ -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ë‹µì•ˆ ì„ íƒ</h3>
                        <div id="large-category-answer-buttons" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë‹µì•ˆ ë²„íŠ¼ë“¤ -->
                        </div>
                    </div>

                    <!-- ê²°ê³¼ í‘œì‹œ -->
                    <div id="large-category-result-area" class="hidden mb-6">
                        <div class="p-4 rounded-lg" id="large-category-result-message">
                            <!-- ê²°ê³¼ ë©”ì‹œì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
                    <div class="flex justify-between items-center">
                        <button onclick="ACIUApp.learning.prevQuestion('large')" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                            ì´ì „ ë¬¸ì œ
                        </button>
                        <div class="flex space-x-2">
                            <button onclick="ACIUApp.learning.checkAnswer('large')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                                ì •ë‹µ í™•ì¸
                            </button>
                            <button onclick="ACIUApp.learning.showExplanation('large')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg hidden" id="large-category-explanation-btn">
                                í•´ì„¤ ë³´ê¸°
                            </button>
                        </div>
                        <button onclick="ACIUApp.learning.nextQuestion('large')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                            ë‹¤ìŒ ë¬¸ì œ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì¤‘ë¶„ë¥˜ í•™ìŠµ í™”ë©´ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
        <div id="mid-category-learning-screen" class="hidden">
            <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="bg-white rounded-lg shadow-lg p-4 mb-6">
                <div class="flex justify-between items-center">
                    <button onclick="ACIUApp.ui.goToHome()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                        ğŸ  í™ˆìœ¼ë¡œ
                    </button>
                    <h2 class="text-xl font-semibold text-gray-800">ì¤‘ë¶„ë¥˜ í•™ìŠµ</h2>
                    <div class="text-sm text-gray-600">
                        ì„ íƒëœ ëŒ€ë¶„ë¥˜: <span id="selected-large-category">ì—†ìŒ</span> | 
                        ì„ íƒëœ ì¤‘ë¶„ë¥˜: <span id="selected-mid-category">ì—†ìŒ</span>
                    </div>
                </div>
            </div>

            <!-- ì¤‘ë¶„ë¥˜ ì„ íƒ ì˜ì—­ -->
            <div id="mid-category-selection-area" class="category-section"> <!-- ID ë³€ê²½ -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">ì¤‘ë¶„ë¥˜ ì„ íƒ</h3>
                    
                    <!-- ë©”ì¸ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ë“¤ -->
                    <div class="main-category-buttons" id="mid-main-category-buttons"> <!-- ID ì¶”ê°€ -->
                        <!-- ë™ì  ìƒì„±: ë©”ì¸ ì¹´í…Œê³ ë¦¬ + ê¸°íƒ€ ë²„íŠ¼ -->
                    </div>
                    
                    <!-- ê¸°íƒ€ ì¹´í…Œê³ ë¦¬ ìƒì„¸ (í† ê¸€ ë°©ì‹) -->
                    <div id="other-categories-detail" class="other-category-section" style="max-height:0;"> <!-- style="display:none;" -> style="max-height:0;" -->
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">ê¸°íƒ€ ì„¸ë¶€ ë¶„ë¥˜</h4>
                        <div class="other-category-buttons" id="mid-other-category-buttons"> <!-- ID ì¶”ê°€ -->
                            <!-- ë™ì  ìƒì„±: ê¸°íƒ€ ì„¸ë¶€ ì¹´í…Œê³ ë¦¬ë“¤ -->
                        </div>
                        <button onclick="ACIUApp.ui.categorySelection.toggleOtherCategories()" class="close-other-btn bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-2 px-4 rounded-lg">
                            ì ‘ê¸°
                        </button>
                    </div>
                </div>
            </div>

            <!-- ë¬¸ì œ í‘œì‹œ ì˜ì—­ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
            <div id="mid-category-question-area" class="hidden">
                <!-- ë¬¸ì œ ë‚´ìš© -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <div class="mb-4">
                        <div class="text-sm text-gray-600 mb-2">
                            ë¬¸ì œ <span id="mid-category-question-number">1</span> / <span id="mid-category-total-questions">0</span>
                        </div>
                        <div class="text-lg font-semibold text-gray-800 mb-4" id="mid-category-question-text">
                            <!-- ë¬¸ì œ í…ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- ë‹µì•ˆ ì„ íƒ ì˜ì—­ -->
                    <div id="mid-category-answer-buttons" class="mb-6">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ë‹µì•ˆ ë²„íŠ¼ë“¤ -->
                    </div>

                    <!-- ê²°ê³¼ í‘œì‹œ -->
                    <div id="mid-category-result-area" class="hidden mb-6">
                        <div class="p-4 rounded-lg" id="mid-category-result-message">
                            <!-- ê²°ê³¼ ë©”ì‹œì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
                    <div class="flex justify-between items-center">
                        <button onclick="ACIUApp.learning.prevQuestion('mid')" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                            ì´ì „ ë¬¸ì œ
                        </button>
                        <div class="flex space-x-2">
                            <button onclick="ACIUApp.learning.checkAnswer('mid')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                                ì •ë‹µ í™•ì¸
                            </button>
                            <button onclick="ACIUApp.learning.showExplanation('mid')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg hidden" id="mid-category-explanation-btn">
                                í•´ì„¤ ë³´ê¸°
                            </button>
                        </div>
                        <button onclick="ACIUApp.learning.nextQuestion('mid')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                            ë‹¤ìŒ ë¬¸ì œ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- í†µê³„ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="text-center">
                <button onclick="ACIUApp.ui.loadStatisticsData()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg text-lg">
                    ğŸ“Š í†µê³„ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
                </button>
                <p class="text-sm text-gray-600 mt-2">ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í˜„ì¬ìƒíƒœ ì´ê´„ì´ í‘œì‹œë©ë‹ˆë‹¤</p>
            </div>
        </div>

        <!-- í†µê³„ ì„¹ì…˜ (ì´ˆê¸° ìˆ¨ê¹€) -->
        <div id="statistics-section" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">í˜„ì¬ìƒíƒœ ì´ê´„</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- ê³¼ëª©ë³„ ì ìˆ˜ ì¹´ë“œ -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">ê³¼ëª©ë³„ ì ìˆ˜</h3>
                        <div class="space-y-2" id="subject-cards">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ê³¼ëª©ë³„ ì¹´ë“œë“¤ -->
                        </div>
                    </div>
                    
                    <!-- ì „ì²´ ìš”ì•½ ì¹´ë“œ -->
                    <div class="bg-blue-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">ì „ì²´ ìš”ì•½</h3>
                        <div class="space-y-3" id="summary-cards">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ìš”ì•½ ì¹´ë“œë“¤ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div id="settings-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-96">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">ì„¤ì •</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ì‚¬ìš©ìëª…</label>
                    <input type="text" id="user-name-input" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="ì‚¬ìš©ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ì‹œí—˜ ë‚ ì§œ</label>
                    <input type="date" id="exam-date-input" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                </div>
                <div class="flex space-x-2">
                    <button onclick="ACIUApp.ui.saveSettings()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                        ì €ì¥
                    </button>
                    <button onclick="ACIUApp.ui.hideSettingsModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">
                        ì·¨ì†Œ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì˜¤ë¥˜ ë©”ì‹œì§€ ëª¨ë‹¬ -->
    <div id="error-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-96 text-center">
            <h3 class="text-lg font-semibold text-red-600 mb-4">ì˜¤ë¥˜ ë°œìƒ!</h3>
            <p id="error-message-text" class="text-gray-700 mb-6">ì˜¤ë¥˜ ë©”ì‹œì§€</p>
            <button onclick="ACIUApp.ui.hideErrorMessage()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                í™•ì¸
            </button>
        </div>
    </div>

    <script>
        // ACIUApp ë„¤ì„ìŠ¤í˜ì´ìŠ¤ êµ¬ì¡°
        const ACIUApp = {
            // íƒ€ì´ë¨¸ ê´€ë¦¬
            timers: {
                timeUpdate: null,
                quoteUpdate: null,
                ddayUpdate: null
            },

            // ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í™•ì¸
            compatibility: {
                checkBrowserSupport() {
                    if (!window.localStorage) {
                        this.showErrorMessage('localStorageë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.');
                        return false;
                    }
                    return true;
                }
            },

            // ë°ì´í„° ê´€ë¦¬
            data: {
                questions: [],
                userSettings: {
                    name: 'ì¡°ëŒ€í‘œë‹˜',
                    examDate: '2025-10-25',
                    lastUpdated: new Date().toISOString()
                },
                learningHistory: {
                    attempts: {}, // attemptsëŠ” ê°ì²´ë¡œ QCODEë¥¼ í‚¤ë¡œ ê°€ì§
                    lastUpdated: new Date().toISOString()
                },
                
                // ì¤‘ë¶„ë¥˜ í•™ìŠµìš© ë°ì´í„° êµ¬ì¡° (ë…¸íŒ€ì¥ í™•ì •)
                mainCategories: {
                    '06ì¬ì‚°ë³´í—˜': [
                        { name: 'í™”ì¬ë³´í—˜', count: 188 },
                        { name: 'ì¬ë¬¼ë³´í—˜ì¬ë³´í—˜', count: 130 },
                        { name: 'íŒ¨í‚¤ì§€ë³´í—˜', count: 53 }
                    ],
                    '07íŠ¹ì¢…ë³´í—˜': [
                        { name: 'ë¯¸í™•ì¸', count: 110 },
                        { name: 'ê¸°ìˆ ë³´í—˜', count: 93 },
                        { name: 'ë²”ì£„ë³´í—˜', count: 51 }
                    ],
                    '08ë°°ìƒì±…ì„ë³´í—˜': [], // 50ë¬¸ì œ ì´ìƒ ì—†ìŒ
                    '09í•´ìƒë³´í—˜': [
                        { name: 'ë¯¸í™•ì¸', count: 165 },
                        { name: 'í•´ìƒë³´í—˜ì¡°ê±´ê³¼ë³´ìƒë²”ìœ„', count: 57 },
                        { name: 'í•´ìƒë³´í—˜ì˜ì†í•´ì‚¬ì •', count: 53 }
                    ]
                },
                
                otherCategories: {
                    '06ì¬ì‚°ë³´í—˜': [
                        { name: 'ë™ì‚°ì¢…í•©ë³´í—˜', count: 15 },
                        { name: 'ê¸°ì—…íœ´ì§€ë³´í—˜', count: 8 },
                        { name: 'ì¬ë¬¼ë³´í—˜', count: 5 }
                    ],
                    '07íŠ¹ì¢…ë³´í—˜': [
                        { name: 'ê¸°íƒ€íŠ¹ì¢…ë³´í—˜', count: 26 },
                        { name: 'ì¢…í•©ë³´í—˜', count: 8 },
                        { name: 'ê°œìš”', count: 4 }
                    ],
                    '08ë°°ìƒì±…ì„ë³´í—˜': [
                        { name: 'ë³´ê´€ìë°°ìƒì±…ì„', count: 49 },
                        { name: 'ì „ë¬¸ì§ì—…ë°°ìƒ', count: 47 },
                        { name: 'ê°œìš”', count: 37 },
                        { name: 'ë„ê¸‰ì—…ìë°°ìƒì±…ì„', count: 33 },
                        { name: 'ì„ì›ë°°ìƒ', count: 32 },
                        { name: 'ì‹œì„¤ì†Œìœ ê´€ë¦¬ì', count: 26 },
                        { name: 'ìƒì‚°ë¬¼ë°°ìƒì±…ì„', count: 24 },
                        { name: 'ê¸°íƒ€ì£¼ìš”ë³´í—˜', count: 20 }
                    ],
                    '09í•´ìƒë³´í—˜': [
                        { name: 'ì í•˜ë³´í—˜', count: 42 },
                        { name: 'í•´ìƒë³´í—˜ê¸°ì´ˆ', count: 33 },
                        { name: 'ê³„ì•½ì˜ ì²´ê²°ê³¼ ë³´í—˜ë£Œ', count: 23 },
                        { name: 'ì„ ë°•ë³´í—˜', count: 23 },
                        { name: 'ìš´ì†¡ë³´í—˜', count: 20 },
                        { name: 'í•´ìƒë³´í—˜ì¡°ê±´', count: 4 }
                    ]
                }
            },

            // CSV ë°ì´í„° ë¡œë”©
            async loadQuestions() {
                try {
                    const response = await fetch('ins_master_db.csv');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const csvContent = await response.text();
                    
                    const parsed = Papa.parse(csvContent, {
                        header: true,
                        dynamicTyping: false,
                        skipEmptyLines: true,
                        delimiter: ',',
                        quoteChar: '"',
                        fastMode: true
                    });

                    // í•„í„°ë§: QCODEê°€ ìˆê³  SOURCEê°€ 'ì¸ìŠ¤êµì¬' ë˜ëŠ” 'ì¤‘ê°œì‚¬ì‹œí—˜'ì¸ ê²½ìš°
                    this.questions = parsed.data.filter(row =>
                        row.QCODE && 
                        (row.SOURCE === 'ì¸ìŠ¤êµì¬' || row.SOURCE === 'ì¤‘ê°œì‚¬ì‹œí—˜')
                    );

                    console.log(`ë°ì´í„° ë¡œë”© ì™„ë£Œ: ${this.questions.length}ê°œ ë¬¸ì œ`);
                    
                    // ë°ì´í„° ë¡œë”© ì™„ë£Œ í›„ UI ì—…ë°ì´íŠ¸
                    ACIUApp.ui.updateQuestionCounts();
                    ACIUApp.ui.updateStatistics();
                    ACIUApp.ui.updateLargeCategoryStats(); // ëŒ€ë¶„ë¥˜ í†µê³„ë„ ì—…ë°ì´íŠ¸
                } catch (error) {
                    console.error('ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:', error);
                    ACIUApp.ui.showErrorMessage('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. íŒŒì¼ ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                }
            },

            // ì‚¬ìš©ì ì„¤ì • ë¡œë”©
            loadUserSettings() {
                try {
                    const saved = localStorage.getItem('aciu_user_settings');
                    if (saved) {
                        this.userSettings = { ...this.userSettings, ...JSON.parse(saved) };
                    }
                } catch (error) {
                    console.error('ì‚¬ìš©ì ì„¤ì • ë¡œë”© ì‹¤íŒ¨:', error);
                }
            },

            // ì‚¬ìš©ì ì„¤ì • ì €ì¥
            saveUserSettings() {
                try {
                    localStorage.setItem('aciu_user_settings', JSON.stringify(this.userSettings));
                } catch (error) {
                    console.error('ì‚¬ìš©ì ì„¤ì • ì €ì¥ ì‹¤íŒ¨:', error);
                }
            },

            // í•™ìŠµ ì´ë ¥ ë¡œë”©
            loadLearningHistory() {
                try {
                    const saved = localStorage.getItem('aciu_learning_history');
                    if (saved) {
                        this.learningHistory = { ...this.learningHistory, ...JSON.parse(saved) };
                    }
                } catch (error) {
                    console.error('í•™ìŠµ ì´ë ¥ ë¡œë”© ì‹¤íŒ¨:', error);
                }
            }
        },

        // UI ê´€ë¦¬
        ui: {
            // ì´ˆê¸°í™”
            init() {
                this.updateHeader();
                this.updateQuestionCounts();
                this.updateStatistics();
                this.updateQuote();
                this.updateCurrentTime();
                this.updateDdayCount();
                this.updateLargeCategoryStats(); // ì´ˆê¸° ë¡œë”© ì‹œ ëŒ€ë¶„ë¥˜ í†µê³„ë„ ì—…ë°ì´íŠ¸
            },

            // í—¤ë” ì—…ë°ì´íŠ¸
            updateHeader() {
                const userInfo = document.getElementById('user-info');
                const examDday = document.getElementById('exam-dday');
                
                userInfo.textContent = `ì‚¬ìš©ì: ${ACIUApp.data.userSettings.name}`;
                
                const examDate = new Date(ACIUApp.data.userSettings.examDate);
                const today = new Date();
                const diffTime = examDate.getTime() - today.getTime();
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                examDday.textContent = `D-${Math.max(0, diffDays)}ì¼`;
            },

            // ì†ŒìŠ¤ë³„ ë¬¸ì œ ìˆ˜ ì—…ë°ì´íŠ¸
            updateQuestionCounts() {
                const questions = ACIUApp.data.questions;
                
                // ì†ŒìŠ¤ë³„ ë¬¸ì œ ìˆ˜ ê³„ì‚°
                const insQuestions = questions.filter(q => q.SOURCE === 'ì¸ìŠ¤êµì¬').length;
                const examQuestions = questions.filter(q => q.SOURCE === 'ì¤‘ê°œì‚¬ì‹œí—˜').length;
                const totalQuestions = questions.length;
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('ins-total-count').textContent = insQuestions.toLocaleString();
                document.getElementById('ins-choice-count').textContent = questions.filter(q => q.SOURCE === 'ì¸ìŠ¤êµì¬' && q.TYPE === 'ì„ íƒí˜•').length;
                document.getElementById('ins-tf-count').textContent = questions.filter(q => q.SOURCE === 'ì¸ìŠ¤êµì¬' && q.TYPE === 'ì§„ìœ„í˜•').length;

                document.getElementById('broker-total-count').textContent = examQuestions.toLocaleString();
                document.getElementById('broker-tf-count').textContent = questions.filter(q => q.SOURCE === 'ì¤‘ê°œì‚¬ì‹œí—˜' && q.TYPE === 'ì§„ìœ„í˜•').length;
                document.getElementById('broker-choice-count').textContent = questions.filter(q => q.SOURCE === 'ì¤‘ê°œì‚¬ì‹œí—˜' && q.TYPE === 'ì„ íƒí˜•').length;

                document.getElementById('total-question-count').textContent = totalQuestions.toLocaleString();
            },

            // í†µê³„ ì—…ë°ì´íŠ¸ (ë©”ì¸ ëŒ€ë¬¸ìš©)
            updateStatistics() {
                const totalQuestions = ACIUApp.data.questions.length;
                const solvedQcodes = new Set(Object.keys(ACIUApp.data.learningHistory.attempts));
                const overallRate = totalQuestions > 0 ? Math.round((solvedQcodes.size / totalQuestions) * 100) : 0;
                
                // ì¼ì¼ ì§„ë„ìœ¨
                const today = new Date().toISOString().slice(0, 10);
                const todayData = Object.values(ACIUApp.data.learningHistory.attempts)
                    .filter(attempt => attempt.timestamp.slice(0, 10) === today);
                const todaySolved = todayData.length;
                const todayCorrect = todayData.filter(attempt => attempt.isCorrect).length; // isCorrect í•„ë“œ ì‚¬ìš©
                const dailyRate = todaySolved > 0 ? Math.round((todayCorrect / todaySolved) * 100) : 0;
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('completed-questions').textContent = solvedQcodes.size.toLocaleString();
                document.getElementById('overall-progress-rate').textContent = `${overallRate}%`;
                document.getElementById('daily-progress-rate').textContent = `${dailyRate}%`;
            },

            // ëŒ€ë¶„ë¥˜ í•™ìŠµ í†µê³„ ì—…ë°ì´íŠ¸ (statistics1.html í¬ë§· í†µí•©)
            updateLargeCategoryStats() {
                const categories = ['06ì¬ì‚°ë³´í—˜', '07íŠ¹ì¢…ë³´í—˜', '08ë°°ìƒì±…ì„ë³´í—˜', '09í•´ìƒë³´í—˜'];
                
                // ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ í†µê³„ ê³„ì‚°
                const categoryProgress = {};
                categories.forEach(catCode => {
                    // í•´ë‹¹ ëŒ€ë¶„ë¥˜ì˜ ì´ ë¬¸ì œ ìˆ˜
                    const totalQuestionsInCat = ACIUApp.data.questions.filter(q => q.LAYER1 === catCode).length;
                    
                    // í•´ë‹¹ ëŒ€ë¶„ë¥˜ì˜ ì™„ë£Œëœ ë¬¸ì œ ìˆ˜ (í•™ìŠµ ì´ë ¥ì—ì„œ ê³„ì‚°)
                    // ACIUApp.data.learningHistory.attemptsëŠ” ê°ì²´ì´ë¯€ë¡œ Object.valuesë¡œ ë°°ì—´í™” í›„ í•„í„°ë§
                    const completedQuestionsInCat = Object.values(ACIUApp.data.learningHistory.attempts).filter(attempt => {
                        // ê° ì‹œë„(attempt)ì˜ layer1ì´ í˜„ì¬ catCodeì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
                        return attempt.layer1 === catCode;
                    }).length;
                    
                    const unlearnedQuestionsInCat = totalQuestionsInCat - completedQuestionsInCat;
                    const percentage = totalQuestionsInCat > 0 ? Math.round((completedQuestionsInCat / totalQuestionsInCat) * 100) : 0;
                    
                    categoryProgress[catCode] = {
                        total: totalQuestionsInCat,
                        completed: completedQuestionsInCat,
                        unlearned: unlearnedQuestionsInCat,
                        percentage: percentage
                    };
                });

                categories.forEach(catCode => {
                    const categoryName = catCode.substring(2); // '06ì¬ì‚°ë³´í—˜' -> 'ì¬ì‚°ë³´í—˜'
                    const data = categoryProgress[catCode];
                    if (data) {
                        const prefix = {
                            '06ì¬ì‚°ë³´í—˜': 'prop', '07íŠ¹ì¢…ë³´í—˜': 'spec',
                            '08ë°°ìƒì±…ì„ë³´í—˜': 'liab', '09í•´ìƒë³´í—˜': 'marine'
                        }[catCode];

                        // Ensure elements exist before updating
                        const completedElem = document.getElementById(`${prefix}-completed`);
                        const totalElem = document.getElementById(`${prefix}-total`);
                        const unlearnedElem = document.getElementById(`${prefix}-unlearned`);
                        const percentageElem = document.getElementById(`${prefix}-percentage`);
                        const progressBar = completedElem ? completedElem.closest('.category-card')?.querySelector('.progress-bar') : null;

                        if (completedElem) completedElem.textContent = data.completed;
                        if (totalElem) totalElem.textContent = data.total;
                        if (unlearnedElem) unlearnedElem.textContent = data.unlearned;
                        if (percentageElem) percentageElem.textContent = `${data.percentage}%`;
                        if (progressBar) progressBar.style.width = `${data.percentage}%`;
                    }
                });

                // 4ê³¼ëª© í‰ê·  í•™ìŠµë¥  ê³„ì‚° ë° ì—…ë°ì´íŠ¸
                let totalPercentage = 0;
                let categoryCount = 0;
                for (const catCode in categoryProgress) { // ë”ë¯¸ ëŒ€ì‹  ì‹¤ì œ categoryProgress ì‚¬ìš©
                    if (categoryProgress.hasOwnProperty(catCode)) {
                        totalPercentage += categoryProgress[catCode].percentage;
                        categoryCount++;
                    }
                }
                const average = categoryCount > 0 ? (totalPercentage / categoryCount).toFixed(2) : 0;
                // Ensure element exists before updating
                const largeAveragePercentageElem = document.getElementById('large-average-percentage');
                if (largeAveragePercentageElem) {
                    largeAveragePercentageElem.textContent = `${average}%`;
                }
            },

            // í˜„ì¬ ì‹œê°„ ì—…ë°ì´íŠ¸
            updateCurrentTime() {
                const now = new Date();
                const timeString = now.toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: true
                });
                document.getElementById('current-time').textContent = timeString;
            },

            // D-Day ì—…ë°ì´íŠ¸
            updateDdayCount() {
                const examDate = new Date(ACIUApp.data.userSettings.examDate);
                const today = new Date();
                const diffTime = examDate.getTime() - today.getTime();
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                document.getElementById('exam-dday').textContent = `D-${Math.max(0, diffDays)}ì¼`;
            },

            // ëª…ì–¸ ì—…ë°ì´íŠ¸
            updateQuote() {
                const quotes = [
                    "í•™ìŠµì€ ê°€ì¥ ì¢‹ì€ íˆ¬ìì…ë‹ˆë‹¤.",
                    "ê¾¸ì¤€í•¨ì´ ìµœê³ ì˜ ì¬ëŠ¥ì…ë‹ˆë‹¤.",
                    "ì˜¤ëŠ˜ì˜ ë…¸ë ¥ì´ ë‚´ì¼ì˜ ì„±ê³µì„ ë§Œë“­ë‹ˆë‹¤.",
                    "ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆì…ë‹ˆë‹¤.",
                    "ì‘ì€ ì§„ì „ë„ í° ì„±ì·¨ì˜ ì‹œì‘ì…ë‹ˆë‹¤.",
                    "ëê¹Œì§€ ê°€ëŠ” ìê°€ ì´ê¸´ë‹¤.",
                    "ìì‹ ì„ ë¯¿ì–´ë¼, ë‹¹ì‹ ì€ í•  ìˆ˜ ìˆë‹¤.",
                    "ì‹œê°„ì€ ê°€ì¥ ê·€ì¤‘í•œ ìì‚°ì…ë‹ˆë‹¤.",
                    "ëª©í‘œë¥¼ í–¥í•´ í•œ ê±¸ìŒì”© ë‚˜ì•„ê°€ë¼.",
                    "ë°°ì›€ì—ëŠ” ëì´ ì—†ë‹¤."
                ];
                
                const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
                document.getElementById('quote-of-day').textContent = `"${randomQuote}"`;
            },

            // ì„¤ì • ëª¨ë‹¬ í‘œì‹œ
            showSettingsModal() {
                document.getElementById('user-name-input').value = ACIUApp.data.userSettings.name;
                document.getElementById('exam-date-input').value = ACIUApp.data.userSettings.examDate;
                document.getElementById('settings-modal').classList.remove('hidden');
            },

            // ì„¤ì • ëª¨ë‹¬ ìˆ¨ê¸°ê¸°
            hideSettingsModal() {
                document.getElementById('settings-modal').classList.add('hidden');
            },

            // ì„¤ì • ì €ì¥
            saveSettings() {
                const name = document.getElementById('user-name-input').value.trim();
                const examDate = document.getElementById('exam-date-input').value;
                
                if (name) {
                    ACIUApp.data.userSettings.name = name;
                }
                if (examDate) {
                    ACIUApp.data.userSettings.examDate = examDate;
                }
                
                ACIUApp.data.userSettings.lastUpdated = new Date().toISOString();
                ACIUApp.data.saveUserSettings();
                this.updateHeader();
                this.hideSettingsModal();
            },

            // í†µê³„ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (ë©”ì¸ í™”ë©´ì—ì„œ í†µê³„ ì„¹ì…˜ í† ê¸€)
            loadStatisticsData() {
                console.log('í†µê³„ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹œì‘');
                
                const statsSection = document.getElementById('statistics-section');
                if (statsSection.classList.contains('hidden')) {
                    statsSection.classList.remove('hidden');
                    this.updateSubjectCards();
                    this.updateSummaryCards();
                } else {
                    statsSection.classList.add('hidden');
                }
                
                console.log('í†µê³„ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ');
            },

            // ê³¼ëª©ë³„ ì ìˆ˜ ì¹´ë“œ ì—…ë°ì´íŠ¸ (ë”ë¯¸ ë°ì´í„° ì ìš©)
            updateSubjectCards() {
                const subjects = ['06ì¬ì‚°ë³´í—˜', '07íŠ¹ì¢…ë³´í—˜', '08ë°°ìƒì±…ì„ë³´í—˜', '09í•´ìƒë³´í—˜'];
                const scores = [55, 65, 67, 30]; // ë”ë¯¸ ì ìˆ˜
                const subjectCards = document.getElementById('subject-cards');
                subjectCards.innerHTML = '';
                
                subjects.forEach((subject, index) => {
                    const score = scores[index];
                    const isPass = score >= 40;
                    const card = document.createElement('div');
                    card.className = 'flex justify-between items-center p-2 bg-white rounded border';
                    card.innerHTML = `
                        <div class="flex-1">
                            <div class="font-medium text-sm">${subject}</div>
                            <div class="text-xs text-gray-500">ê¸°ì¤€: 40ì </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold ${isPass ? 'text-green-600' : 'text-red-600'}">${score}ì </div>
                            <div class="text-xs ${isPass ? 'text-green-600' : 'text-red-600'}">${isPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</div>
                        </div>
                    `;
                    subjectCards.appendChild(card);
                });
            },

            // ì „ì²´ ìš”ì•½ ì¹´ë“œ ì—…ë°ì´íŠ¸ (ë”ë¯¸ ë°ì´í„° ì ìš©)
            updateSummaryCards() {
                const scores = [55, 65, 67, 30]; // ë”ë¯¸ ì ìˆ˜
                const overallScore = Math.round(scores.reduce((a, b) => a + b, 0) / scores.length);
                const lowestScore = Math.min(...scores);
                const isPass = overallScore >= 60 && lowestScore >= 40;
                
                const summaryCards = document.getElementById('summary-cards');
                summaryCards.innerHTML = '';
                
                // í‰ê·  ì ìˆ˜ ì¹´ë“œ
                const isAvgPass = overallScore >= 60;
                const avgCard = document.createElement('div');
                avgCard.className = 'flex justify-between items-center p-3 bg-white rounded border';
                avgCard.innerHTML = `
                    <div class="flex-1">
                        <div class="font-semibold">í‰ê· ì ìˆ˜</div>
                        <div class="text-xs text-gray-500">ê¸°ì¤€: 60ì </div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold ${isAvgPass ? 'text-green-600' : 'text-red-600'}">${overallScore}ì </div>
                        <div class="text-xs ${isAvgPass ? 'text-green-600' : 'text-red-600'}">${isAvgPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</div>
                    </div>
                `;
                summaryCards.appendChild(avgCard);
                
                // ìµœì¢… í•©ê²© ì—¬ë¶€ ì¹´ë“œ
                const finalCard = document.createElement('div');
                finalCard.className = `flex justify-between items-center p-3 rounded border ${isPass ? 'bg-green-100 border-green-300' : 'bg-red-100 border-red-300'}`;
                finalCard.innerHTML = `
                    <div class="flex-1">
                        <div class="font-bold">ìµœì¢…í•©ê²©ì—¬ë¶€</div>
                        <div class="text-xs text-gray-500">ëª¨ë“  ì¡°ê±´ ë§Œì¡±</div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold ${isPass ? 'text-green-600' : 'text-red-600'}">${isPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</div>
                        <div class="text-xs ${isPass ? 'text-green-600' : 'text-red-600'}">${isPass ? 'ğŸ‰' : 'âš ï¸'}</div>
                    </div>
                `;
                summaryCards.appendChild(finalCard);
            },

            // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ (alert ëŒ€ì‹  ëª¨ë‹¬ ì‚¬ìš©)
            showErrorMessage(message) {
                const errorModal = document.getElementById('error-modal');
                const errorMessageText = document.getElementById('error-message-text');
                if (errorMessageText) { // Ensure element exists
                    errorMessageText.textContent = message;
                }
                if (errorModal) { // Ensure element exists
                    errorModal.classList.remove('hidden');
                }
            },
            hideErrorMessage() {
                const errorModal = document.getElementById('error-modal');
                if (errorModal) { // Ensure element exists
                    errorModal.classList.add('hidden');
                }
            },

            // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
            hideAllScreens() {
                document.getElementById('basic-learning-screen').classList.add('hidden');
                document.getElementById('large-category-learning-screen').classList.add('hidden');
                document.getElementById('mid-category-learning-screen').classList.add('hidden');
            },

            // í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°
            goToHome() {
                console.log('í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°');
                this.hideAllScreens();
                document.getElementById('current-mode').textContent = 'ëª¨ë“œ ì„ íƒ';
                // Reset category selection state when going home
                ACIUApp.ui.categorySelection.selectedLargeCategory = null;
                ACIUApp.ui.categorySelection.selectedMidCategory = null;
                ACIUApp.ui.categorySelection.isOtherCategoryOpen = false;
                ACIUApp.ui.categorySelection.saveState(); // Save cleared state
            },

            // ì¤‘ë¶„ë¥˜ ì„ íƒ ê´€ë¦¬ì
            categorySelection: {
                selectedLargeCategory: null,
                selectedMidCategory: null,
                isOtherCategoryOpen: false,
                
                // ëŒ€ë¶„ë¥˜ ì„ íƒ ì‹œ ì¤‘ë¶„ë¥˜ í‘œì‹œ (ì¤‘ë¶„ë¥˜ í•™ìŠµ í™”ë©´ ë‚´ 1ë‹¨ê³„)
                showMidCategories(largeCategoryCode) { // ì¸ì ì´ë¦„ì„ largeCategoryCodeë¡œ ë³€ê²½
                    console.log(`ì¤‘ë¶„ë¥˜ í•™ìŠµ í™”ë©´ - ëŒ€ë¶„ë¥˜ ì„ íƒ: ${largeCategoryCode}`);
                    this.selectedLargeCategory = largeCategoryCode;
                    this.selectedMidCategory = null;
                    this.isOtherCategoryOpen = false;
                    
                    const container = document.getElementById('mid-main-category-buttons');
                    if (!container) {
                        console.error("Error: mid-main-category-buttons container not found.");
                        return;
                    }
                    container.innerHTML = ''; // ê¸°ì¡´ ë²„íŠ¼ ì´ˆê¸°í™”
                    
                    // '08ë°°ìƒì±…ì„ë³´í—˜' íŠ¹ìˆ˜ ì¼€ì´ìŠ¤ ì²˜ë¦¬
                    if (largeCategoryCode === '08ë°°ìƒì±…ì„ë³´í—˜') {
                        // ë©”ì¸ ì¤‘ë¶„ë¥˜ê°€ ì—†ìœ¼ë¯€ë¡œ ê¸°íƒ€ ì„¸ë¶€ë¶„ë¥˜ë§Œ í‘œì‹œ
                        const otherCats = ACIUApp.data.otherCategories[largeCategoryCode] || [];
                        if (otherCats.length > 0) {
                            const otherCount = otherCats.reduce((sum, cat) => sum + cat.count, 0);
                            const otherButton = this.createOtherButton(otherCount, largeCategoryCode);
                            container.appendChild(otherButton);
                        } else {
                            // ë°°ìƒì±…ì„ë³´í—˜ì— ê¸°íƒ€ ë¬¸ì œë„ ì—†ëŠ” ê²½ìš°
                            ACIUApp.ui.showErrorMessage(`"${largeCategoryCode.substring(2)}" ì¹´í…Œê³ ë¦¬ì—ëŠ” í˜„ì¬ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.`);
                        }
                    } else {
                        // ì¼ë°˜ì ì¸ ê²½ìš°: ë©”ì¸ ì¤‘ë¶„ë¥˜ ë²„íŠ¼ë“¤ ìƒì„±
                        const mainCats = ACIUApp.data.mainCategories[largeCategoryCode] || [];
                        mainCats.forEach(cat => {
                            const button = this.createMainCategoryButton(cat.name, cat.count, largeCategoryCode); // largeCategoryCode ì „ë‹¬
                            container.appendChild(button);
                        });
                        
                        // ê¸°íƒ€ ë²„íŠ¼ ìƒì„± (ê¸°íƒ€ ì¹´í…Œê³ ë¦¬ê°€ ìˆëŠ” ê²½ìš°)
                        const otherCats = ACIUApp.data.otherCategories[largeCategoryCode] || [];
                        if (otherCats.length > 0) {
                            const otherCount = otherCats.reduce((sum, cat) => sum + cat.count, 0);
                            const otherButton = this.createOtherButton(otherCount, largeCategoryCode); // largeCategoryCode ì „ë‹¬
                            container.appendChild(otherButton);
                        } else if (mainCats.length === 0) {
                             // ë©”ì¸ë„ ê¸°íƒ€ë„ ì—†ëŠ” ê²½ìš°
                            ACIUApp.ui.showErrorMessage(`"${largeCategoryCode.substring(2)}" ì¹´í…Œê³ ë¦¬ì—ëŠ” í˜„ì¬ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.`);
                        }
                    }
                    
                    // ê¸°íƒ€ ì¹´í…Œê³ ë¦¬ ìƒì„¸ëŠ” ìˆ¨ê¹€
                    document.getElementById('other-categories-detail').style.maxHeight = '0px'; // display:none ëŒ€ì‹  maxHeight ì‚¬ìš©

                    this.updateBreadcrumb(); // ë¸Œë ˆë“œí¬ëŸ¼ ì—…ë°ì´íŠ¸
                    this.saveState(); // ìƒíƒœ ì €ì¥
                },
                
                // ë©”ì¸ ì¤‘ë¶„ë¥˜ ë²„íŠ¼ ìƒì„±
                createMainCategoryButton(name, count, largeCategoryCode) { // largeCategoryCode ì¸ì ì¶”ê°€
                    const button = document.createElement('button');
                    button.className = 'main-category-button';
                    
                    // 'ë¯¸í™•ì¸' ì¹´í…Œê³ ë¦¬ ë„¤ì´ë° ë³€ê²½
                    const displayName = name === 'ë¯¸í™•ì¸' ? 'ë¯¸ë¶„ë¥˜' : name;
                    
                    button.innerHTML = `
                        ${displayName}
                        <span class="category-count">(${count}ë¬¸ì œ)</span>
                    `;
                    button.onclick = () => this.selectMidCategory(name, largeCategoryCode); // largeCategoryCode ì „ë‹¬
                    return button;
                },
                
                // ê¸°íƒ€ ë²„íŠ¼ ìƒì„±
                createOtherButton(totalCount, largeCategoryCode) { // largeCategoryCode ì¸ì ì¶”ê°€
                    const button = document.createElement('button');
                    button.className = 'main-category-button other-button';
                    button.innerHTML = `
                        ê¸°íƒ€ ì„¸ë¶€ë¶„ë¥˜
                        <span class="category-count">(${totalCount}ë¬¸ì œ)</span>
                    `;
                    button.onclick = () => this.toggleOtherCategories(largeCategoryCode); // largeCategoryCode ì „ë‹¬
                    return button;
                },
                
                // ê¸°íƒ€ ì¹´í…Œê³ ë¦¬ í† ê¸€
                toggleOtherCategories(largeCategoryCode) { // largeCategoryCode ì¸ì ì¶”ê°€
                    this.isOtherCategoryOpen = !this.isOtherCategoryOpen;
                    const detailSection = document.getElementById('other-categories-detail');
                    
                    if (this.isOtherCategoryOpen) {
                        this.showOtherCategoriesDetail(largeCategoryCode); // largeCategoryCode ì „ë‹¬
                        detailSection.style.maxHeight = '500px'; // ì¶©ë¶„í•œ ë†’ì´ë¡œ í¼ì¹˜ê¸°
                    } else {
                        detailSection.style.maxHeight = '0px'; // ì ‘ê¸°
                    }
                },
                
                // ê¸°íƒ€ ì¹´í…Œê³ ë¦¬ ìƒì„¸ í‘œì‹œ
                showOtherCategoriesDetail(largeCategoryCode) { // largeCategoryCode ì¸ì ì¶”ê°€
                    const container = document.getElementById('mid-other-category-buttons');
                    if (!container) {
                        console.error("Error: mid-other-category-buttons container not found.");
                        return;
                    }
                    container.innerHTML = '';
                    
                    const otherCats = ACIUApp.data.otherCategories[largeCategoryCode] || []; // largeCategoryCode ì‚¬ìš©
                    otherCats.forEach(cat => {
                        const button = document.createElement('button');
                        button.className = 'other-category-button';
                        
                        // 'ë¯¸í™•ì¸' ì¹´í…Œê³ ë¦¬ ë„¤ì´ë° ë³€ê²½
                        const displayName = cat.name === 'ë¯¸í™•ì¸' ? 'ë¯¸ë¶„ë¥˜' : cat.name;
                        
                        button.innerHTML = `${displayName} (${cat.count})`;
                        button.onclick = () => this.selectMidCategory(cat.name, largeCategoryCode); // largeCategoryCode ì „ë‹¬
                        container.appendChild(button);
                    });
                },
                
                // ì¤‘ë¶„ë¥˜ ì„ íƒ ì²˜ë¦¬ (ì¤‘ë¶„ë¥˜ í•™ìŠµ í™”ë©´ ë‚´ 2ë‹¨ê³„)
                selectMidCategory(midCategoryName, largeCategoryCode) { // largeCategoryCode ì¸ì ì¶”ê°€
                    console.log(`ì¤‘ë¶„ë¥˜ ì„ íƒ: ${largeCategoryCode} > ${midCategoryName}`);
                    this.selectedMidCategory = midCategoryName;
                    // this.selectedLargeCategoryëŠ” showMidCategoriesì—ì„œ ì´ë¯¸ ì„¤ì •ë¨
                    this.updateButtonStates();
                    this.updateBreadcrumb();
                    this.startQuestionMode();
                    this.saveState(); // ìƒíƒœ ì €ì¥
                },
                
                // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                updateButtonStates() {
                    // ëª¨ë“  ë²„íŠ¼ì˜ active í´ë˜ìŠ¤ ì œê±°
                    document.querySelectorAll('.main-category-button, .other-category-button').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // ì„ íƒëœ ë²„íŠ¼ í™œì„±í™”
                    // í…ìŠ¤íŠ¸ ë‚´ìš©ìœ¼ë¡œ ë²„íŠ¼ì„ ì°¾ëŠ” ëŒ€ì‹ , data-category ì†ì„±ì„ í™œìš©í•˜ê±°ë‚˜ ë” ì •í™•í•œ ë°©ë²•ìœ¼ë¡œ ì°¾ê¸°
                    // í˜„ì¬ëŠ” í…ìŠ¤íŠ¸ í¬í•¨ ì—¬ë¶€ë¡œ ì°¾ê¸° ìœ ì§€ (í–¥í›„ data-category ì†ì„± í™œìš©ìœ¼ë¡œ ê°œì„  ê°€ëŠ¥)
                    const selectedBtn = Array.from(document.querySelectorAll('.main-category-button, .other-category-button'))
                        .find(btn => btn.textContent.includes(this.selectedMidCategory)); 
                    if (selectedBtn) {
                        selectedBtn.classList.add('active');
                    }
                },
                
                // ë¸Œë ˆë“œí¬ëŸ¼ ì—…ë°ì´íŠ¸
                updateBreadcrumb() {
                    const largeCatDisplay = this.selectedLargeCategory ? this.selectedLargeCategory.substring(2) : 'ì—†ìŒ';
                    const midCatDisplay = this.selectedMidCategory || 'ì—†ìŒ';
                    document.getElementById('selected-large-category').textContent = largeCatDisplay;
                    document.getElementById('selected-mid-category').textContent = midCatDisplay;

                    // ë¬¸ì œ ì§„í–‰ë¥  í‘œì‹œ (ì¤‘ë¶„ë¥˜ ëª¨ë“œì—ì„œë§Œ)
                    // ì´ ë¸Œë ˆë“œí¬ëŸ¼ì€ ì¤‘ë¶„ë¥˜ í•™ìŠµ í™”ë©´ ìƒë‹¨ì— ì§ì ‘ í‘œì‹œë˜ë¯€ë¡œ, ì¼ë°˜ category-pathì™€ ë¶„ë¦¬
                    const midCategoryQuestionNumberElem = document.getElementById('mid-category-question-number');
                    const midCategoryTotalQuestionsElem = document.getElementById('mid-category-total-questions');

                    if (ACIUApp.learning.currentMode === 'layer2' && ACIUApp.learning.filteredQuestions.length > 0) {
                        const current = ACIUApp.learning.currentQuestionIndex + 1;
                        const total = ACIUApp.learning.filteredQuestions.length;
                        if (midCategoryQuestionNumberElem) midCategoryQuestionNumberElem.textContent = current;
                        if (midCategoryTotalQuestionsElem) midCategoryTotalQuestionsElem.textContent = total;
                    } else {
                        if (midCategoryQuestionNumberElem) midCategoryQuestionNumberElem.textContent = '0';
                        if (midCategoryTotalQuestionsElem) midCategoryTotalQuestionsElem.textContent = '0';
                    }
                },
                
                // ë¬¸ì œ ëª¨ë“œ ì‹œì‘
                startQuestionMode() {
                    console.log('ì¤‘ë¶„ë¥˜ í•™ìŠµ - ë¬¸ì œ ëª¨ë“œ ì‹œì‘');
                    // ë¬¸ì œ í‘œì‹œ ì˜ì—­ í‘œì‹œ
                    document.getElementById('mid-category-question-area').classList.remove('hidden');
                    
                    // ë”ë¯¸ ë¬¸ì œ ìƒì„± ë° í‘œì‹œ
                    ACIUApp.learning.loadDummyQuestionsForMidCategory(this.selectedLargeCategory, this.selectedMidCategory);
                },

                // ìƒíƒœ ì €ì¥/ë³µì› (ëŒ€ë¶„ë¥˜ë§Œ ë³µì›)
                saveState() {
                    const state = {
                        largeCategory: this.selectedLargeCategory,
                        // midCategoryì™€ questionIndexëŠ” ë³µì›í•˜ì§€ ì•ŠìŒ (ì¡°ëŒ€í‘œë‹˜ ì§€ì‹œ)
                    };
                    try {
                        localStorage.setItem('aciu_mid_category_state', JSON.stringify(state));
                        console.log('ì¤‘ë¶„ë¥˜ í•™ìŠµ ìƒíƒœ ì €ì¥ë¨:', state);
                    } catch (e) {
                        console.error('ì¤‘ë¶„ë¥˜ í•™ìŠµ ìƒíƒœ ì €ì¥ ì‹¤íŒ¨:', e);
                    }
                },
                
                restoreState() {
                    try {
                        const state = JSON.parse(localStorage.getItem('aciu_mid_category_state'));
                        if (state && state.largeCategory) {
                            console.log('ì¤‘ë¶„ë¥˜ í•™ìŠµ ìƒíƒœ ë³µì› ì‹œë„:', state);
                            this.selectedLargeCategory = state.largeCategory;
                            this.selectedMidCategory = null; // ì¤‘ë¶„ë¥˜ëŠ” ì´ˆê¸°í™”
                            this.isOtherCategoryOpen = false; // ê¸°íƒ€ ì¹´í…Œê³ ë¦¬ë„ ì´ˆê¸°í™”

                            // ëŒ€ë¶„ë¥˜ ë²„íŠ¼ë“¤ì„ ë‹¤ì‹œ ìƒì„±í•˜ì—¬ UIì— í‘œì‹œ
                            const container = document.getElementById('mid-main-category-buttons');
                            if (container) {
                                container.innerHTML = '';
                                const largeCategories = ['06ì¬ì‚°ë³´í—˜', '07íŠ¹ì¢…ë³´í—˜', '08ë°°ìƒì±…ì„ë³´í—˜', '09í•´ìƒë³´í—˜'];
                                largeCategories.forEach(categoryCode => {
                                    const categoryName = categoryCode.substring(2);
                                    const totalCount = ACIUApp.learning.getTotalQuestionCount(categoryCode);
                                    const button = document.createElement('button');
                                    button.className = 'main-category-button';
                                    button.innerHTML = `
                                        ${categoryName}
                                        <span class="category-count">(${totalCount}ë¬¸ì œ)</span>
                                    `;
                                    button.onclick = () => ACIUApp.ui.categorySelection.showMidCategories(categoryCode);
                                    if (categoryCode === this.selectedLargeCategory) {
                                        button.classList.add('active'); // ë³µì›ëœ ëŒ€ë¶„ë¥˜ í™œì„±í™”
                                    }
                                    container.appendChild(button);
                                });
                            }
                            
                            // ë³µì›ëœ ëŒ€ë¶„ë¥˜ì— í•´ë‹¹í•˜ëŠ” ì¤‘ë¶„ë¥˜ ëª©ë¡ì„ í‘œì‹œ
                            this.showMidCategories(this.selectedLargeCategory); // ì´ í•¨ìˆ˜ê°€ ì¤‘ë¶„ë¥˜ ë²„íŠ¼ë“¤ì„ ìƒì„±í•˜ê³  í‘œì‹œ

                            this.updateBreadcrumb();
                        }
                    } catch (e) {
                        console.error('ì¤‘ë¶„ë¥˜ í•™ìŠµ ìƒíƒœ ë³µì› ì‹¤íŒ¨:', e);
                    }
                }
            }
        },

        // í•™ìŠµ ì—”ì§„
        learning: {
            // í•™ìŠµ ìƒíƒœ ë³€ìˆ˜
            currentQuestionIndex: 0,
            filteredQuestions: [],
            selectedAnswer: null,
            currentQuestion: null,
            isAnswerChecked: false,
            currentMode: null, // í˜„ì¬ í™œì„±í™”ëœ í•™ìŠµ ëª¨ë“œë¥¼ ì¶”ì 

            // ê¸°ë³¸ í•™ìŠµ ëª¨ë“œ ì‹œì‘
            startMode(mode) {
                console.log(`í•™ìŠµ ëª¨ë“œ ì‹œì‘: ${mode}`);
                ACIUApp.ui.hideAllScreens(); // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
                this.currentMode = mode; // í˜„ì¬ ëª¨ë“œ ì„¤ì •
                
                let targetScreenId = '';
                if (mode === 'basic') {
                    targetScreenId = 'basic-learning-screen';
                    this.startBasicLearning();
                } else if (mode === 'layer1') {
                    targetScreenId = 'large-category-learning-screen';
                    this.startLargeCategoryLearning();
                } else if (mode === 'layer2') {
                    targetScreenId = 'mid-category-learning-screen';
                    this.startMidCategoryLearning();
                } else {
                    ACIUApp.ui.showErrorMessage(`${mode} ëª¨ë“œê°€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.`);
                    return; // Exit if mode is not handled
                }
                
                // Show the target screen after its specific setup
                if (targetScreenId) {
                    document.getElementById(targetScreenId).classList.remove('hidden');
                }

                document.getElementById('current-mode').textContent = {
                    'basic': 'ê¸°ë³¸ í•™ìŠµ',
                    'layer1': 'ëŒ€ë¶„ë¥˜ í•™ìŠµ',
                    'layer2': 'ì¤‘ë¶„ë¥˜ í•™ìŠµ',
                    'choice': 'ì„ íƒí˜• í•™ìŠµ',
                    'truefalse': 'ì§„ìœ„í˜• í•™ìŠµ',
                    'mock': 'ëª¨ì˜ê³ ì‚¬'
                }[mode] || 'ëª¨ë“œ ì„ íƒ';
            },

            // ê¸°ë³¸ í•™ìŠµ ì‹œì‘
            startBasicLearning() {
                console.log('ê¸°ë³¸ í•™ìŠµ ëª¨ë“œ ì‹œì‘');
                this.filteredQuestions = ACIUApp.data.questions;
                this.currentQuestionIndex = 0;
                ACIUApp.ui.updateBasicLearningStats();
                if (this.filteredQuestions.length > 0) {
                    this.displayQuestion();
                } else {
                    ACIUApp.ui.showErrorMessage('ë¡œë”©ëœ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤. CSV íŒŒì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                }
                console.log(`ì´ ${this.filteredQuestions.length}ê°œ ë¬¸ì œ ë¡œë“œë¨`);
            },

            // ëŒ€ë¶„ë¥˜ í•™ìŠµ ì‹œì‘
            startLargeCategoryLearning() {
                console.log('ëŒ€ë¶„ë¥˜ í•™ìŠµ ëª¨ë“œ ì‹œì‘');
                this.selectedCategory = null; // ëŒ€ë¶„ë¥˜ ì„ íƒ ì´ˆê¸°í™”
                
                // ëŒ€ë¶„ë¥˜ ë²„íŠ¼ ë™ì  ìƒì„± (ê¸°ì¡´ ì½”ë“œ ì¬í™œìš©)
                const container = document.getElementById('large-category-buttons-container');
                if (!container) {
                    console.error("Error: large-category-buttons-container not found.");
                    return;
                }
                container.innerHTML = '';
                const largeCategories = ['06ì¬ì‚°ë³´í—˜', '07íŠ¹ì¢…ë³´í—˜', '08ë°°ìƒì±…ì„ë³´í—˜', '09í•´ìƒë³´í—˜'];
                largeCategories.forEach(categoryCode => {
                    const categoryName = categoryCode.substring(2); // '06ì¬ì‚°ë³´í—˜' -> 'ì¬ì‚°ë³´í—˜'
                    const totalCount = this.getTotalQuestionCount(categoryCode);
                    const button = document.createElement('button');
                    button.className = 'category-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-6 rounded-lg transition-all';
                    button.setAttribute('data-category', categoryCode);
                    button.onclick = () => this.selectCategory(categoryCode); // selectCategory í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ì½”ë“œ ì „ë‹¬
                    button.innerHTML = `${categoryName}<br><span class="text-sm">(${totalCount}ë¬¸ì œ)</span>`;
                    container.appendChild(button);
                });

                ACIUApp.ui.updateLargeCategoryStats(); // ëŒ€ë¶„ë¥˜ í†µê³„ ì—…ë°ì´íŠ¸
                console.log('ëŒ€ë¶„ë¥˜ í•™ìŠµ í™”ë©´ í‘œì‹œë¨');
            },

            // ì¤‘ë¶„ë¥˜ í•™ìŠµ ì‹œì‘
            startMidCategoryLearning() {
                console.log('ì¤‘ë¶„ë¥˜ í•™ìŠµ ëª¨ë“œ ì‹œì‘');
                
                // ì¤‘ë¶„ë¥˜ ì„ íƒ ê´€ë¦¬ì ì´ˆê¸°í™” ë° ìƒíƒœ ë³µì›
                ACIUApp.ui.categorySelection.selectedLargeCategory = null;
                ACIUApp.ui.categorySelection.selectedMidCategory = null;
                ACIUApp.ui.categorySelection.isOtherCategoryOpen = false;
                
                const container = document.getElementById('mid-main-category-buttons'); // ì¤‘ë¶„ë¥˜ í™”ë©´ì˜ ëŒ€ë¶„ë¥˜ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ
                if (!container) {
                    console.error("Error: mid-main-category-buttons container not found for initial load.");
                    return;
                }
                container.innerHTML = ''; // ì´ˆê¸°í™”

                const largeCategories = ['06ì¬ì‚°ë³´í—˜', '07íŠ¹ì¢…ë³´í—˜', '08ë°°ìƒì±…ì„ë³´í—˜', '09í•´ìƒë³´í—˜'];
                largeCategories.forEach(categoryCode => {
                    const categoryName = categoryCode.substring(2);
                    const totalCount = this.getTotalQuestionCount(categoryCode);
                    const button = document.createElement('button');
                    button.className = 'main-category-button'; // ì¤‘ë¶„ë¥˜ í™”ë©´ìš© ë²„íŠ¼ í´ë˜ìŠ¤
                    button.innerHTML = `
                        ${categoryName}
                        <span class="category-count">(${totalCount}ë¬¸ì œ)</span>
                    `;
                    button.onclick = () => ACIUApp.ui.categorySelection.showMidCategories(categoryCode); // showMidCategoriesì— ì½”ë“œ ì „ë‹¬
                    container.appendChild(button);
                });

                ACIUApp.ui.categorySelection.restoreState(); // ì €ì¥ëœ ëŒ€ë¶„ë¥˜ ìƒíƒœ ë³µì› ì‹œë„ (ë²„íŠ¼ ìƒì„± í›„ í˜¸ì¶œ)
                
                console.log('ì¤‘ë¶„ë¥˜ í•™ìŠµ í™”ë©´ í‘œì‹œë¨');
            },

            // ëŒ€ë¶„ë¥˜ë³„ ì´ ë¬¸ì œ ìˆ˜ ê³„ì‚° (LAYER1 ê¸°ì¤€)
            getTotalQuestionCount(largeCategoryCode) {
                // ì‹¤ì œ questions ë°°ì—´ì—ì„œ LAYER1 ê¸°ì¤€ìœ¼ë¡œ ë¬¸ì œ ìˆ˜ ê³„ì‚°
                return ACIUApp.data.questions.filter(q => q.LAYER1 === largeCategoryCode).length;
            },

            // ëŒ€ë¶„ë¥˜ ì„ íƒ (ëŒ€ë¶„ë¥˜ í•™ìŠµ ëª¨ë“œìš©)
            selectCategory(categoryCode) { // ì¸ì ì´ë¦„ì„ categoryCodeë¡œ ë³€ê²½
                console.log(`ëŒ€ë¶„ë¥˜ ì„ íƒ: ${categoryCode}`);
                this.selectedCategory = categoryCode; // selectedCategoryì— ì½”ë“œ ì €ì¥
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('selected-category').textContent = categoryCode.substring(2); // UIì—ëŠ” ì´ë¦„ í‘œì‹œ
                
                // ë²„íŠ¼ ì‹œê°ì  í”¼ë“œë°±
                this.updateCategoryButtonSelection(categoryCode);
                
                // ì‹¤ì œ ë¬¸ì œ í•„í„°ë§ (ë”ë¯¸ ëŒ€ì‹  ì‹¤ì œ ë°ì´í„° ì‚¬ìš©)
                this.filteredQuestions = ACIUApp.data.questions.filter(q => q.LAYER1 === categoryCode);
                
                if (this.filteredQuestions.length === 0) {
                    ACIUApp.ui.showErrorMessage(`"${categoryCode.substring(2)}" ì¹´í…Œê³ ë¦¬ì—ëŠ” í˜„ì¬ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.`);
                    document.getElementById('large-category-question-area').classList.add('hidden');
                    return;
                }

                this.currentQuestionIndex = 0;
                this.displayLargeCategoryQuestion();
                document.getElementById('large-category-question-area').classList.remove('hidden');
                
                console.log(`${categoryCode.substring(2)} ì¹´í…Œê³ ë¦¬ ì„ íƒë¨. ${this.filteredQuestions.length} ë¬¸ì œ ë¡œë“œ.`);
            },

            // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸ (ëŒ€ë¶„ë¥˜ í•™ìŠµ ëª¨ë“œìš©)
            updateCategoryButtonSelection(selectedCategoryCode) {
                document.querySelectorAll('#large-category-buttons-container .category-btn').forEach(btn => {
                    btn.classList.remove('ring-4', 'ring-blue-300');
                });
                const selectedButton = document.querySelector(`#large-category-buttons-container [data-category="${selectedCategoryCode}"]`);
                if (selectedButton) {
                    selectedButton.classList.add('ring-4', 'ring-blue-300');
                }
            },

            // ê¸°ë³¸ í•™ìŠµ ëª¨ë“œ ë¬¸ì œ í‘œì‹œ
            displayQuestion() {
                if (this.currentQuestionIndex >= this.filteredQuestions.length) {
                    ACIUApp.ui.showErrorMessage('ëª¨ë“  ë¬¸ì œë¥¼ í’€ì´í–ˆìŠµë‹ˆë‹¤!');
                    return;
                }

                this.currentQuestion = this.filteredQuestions[this.currentQuestionIndex];
                this.selectedAnswer = null;
                this.isAnswerChecked = false;

                document.getElementById('current-question-number').textContent = this.currentQuestionIndex + 1;
                document.getElementById('total-questions').textContent = this.filteredQuestions.length;
                document.getElementById('question-type').textContent = this.currentQuestion.TYPE === 'ì§„ìœ„í˜•' ? 'ì§„ìœ„í˜•' : 'ì„ íƒí˜•';
                document.getElementById('question-code').textContent = this.currentQuestion.QCODE;
                document.getElementById('layer-info').textContent = `${this.currentQuestion.LAYER1} > ${this.currentQuestion.LAYER2}`;
                document.getElementById('question-text').textContent = this.currentQuestion.QUESTION;

                const answerButtonsContainer = document.getElementById('answer-buttons');
                answerButtonsContainer.innerHTML = ''; // ê¸°ì¡´ ë²„íŠ¼ ì´ˆê¸°í™”

                if (this.currentQuestion.TYPE === 'ì§„ìœ„í˜•') {
                    answerButtonsContainer.innerHTML = `
                        <button onclick="ACIUApp.learning.selectAnswer('O')" class="answer-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="O">O</button>
                        <button onclick="ACIUApp.learning.selectAnswer('X')" class="answer-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="X">X</button>
                    `;
                } else {
                    for (let i = 1; i <= 4; i++) {
                        answerButtonsContainer.innerHTML += `
                            <button onclick="ACIUApp.learning.selectAnswer('${i}')" class="answer-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="${i}">${i}</button>
                        `;
                    }
                }
                document.getElementById('question-area').classList.remove('hidden');
                document.getElementById('result-area').classList.add('hidden');
                document.getElementById('explanation-btn').classList.add('hidden');
                this.resetAnswerButtons(); // ë²„íŠ¼ ìƒ‰ìƒ ì´ˆê¸°í™”
            },

            // ëŒ€ë¶„ë¥˜ í•™ìŠµ ëª¨ë“œ ë¬¸ì œ í‘œì‹œ
            displayLargeCategoryQuestion() {
                if (this.currentQuestionIndex >= this.filteredQuestions.length) {
                    ACIUApp.ui.showErrorMessage('ëª¨ë“  ë¬¸ì œë¥¼ í’€ì´í–ˆìŠµë‹ˆë‹¤!');
                    return;
                }
                this.currentQuestion = this.filteredQuestions[this.currentQuestionIndex];
                this.selectedAnswer = null;
                this.isAnswerChecked = false;

                document.getElementById('large-category-question-type').textContent = this.currentQuestion.TYPE === 'ì§„ìœ„í˜•' ? 'ì§„ìœ„í˜•' : 'ì„ íƒí˜•';
                document.getElementById('large-category-question-code').textContent = this.currentQuestion.QCODE;
                document.getElementById('large-category-layer-info').textContent = `${this.currentQuestion.LAYER1.substring(2)} > ${this.currentQuestion.LAYER2}`; // LAYER1 ì½”ë“œì—ì„œ ì´ë¦„ë§Œ ì¶”ì¶œ
                document.getElementById('large-category-question-text').textContent = this.currentQuestion.QUESTION;

                const answerButtonsContainer = document.getElementById('large-category-answer-buttons');
                answerButtonsContainer.innerHTML = '';

                if (this.currentQuestion.TYPE === 'ì§„ìœ„í˜•') {
                    answerButtonsContainer.innerHTML = `
                        <button onclick="ACIUApp.learning.selectAnswer('O', 'large')" class="answer-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="O">O</button>
                        <button onclick="ACIUApp.learning.selectAnswer('X', 'large')" class="answer-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="X">X</button>
                    `;
                } else {
                    for (let i = 1; i <= 4; i++) {
                        answerButtonsContainer.innerHTML += `
                            <button onclick="ACIUApp.learning.selectAnswer('${i}', 'large')" class="answer-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="${i}">${i}</button>
                        `;
                    }
                }
                document.getElementById('large-category-result-area').classList.add('hidden');
                document.getElementById('large-category-explanation-btn').classList.add('hidden');
                this.resetAnswerButtons('large'); // ëŒ€ë¶„ë¥˜ìš© ë²„íŠ¼ ì´ˆê¸°í™”
            },

            // ì¤‘ë¶„ë¥˜ í•™ìŠµ ëª¨ë“œ ë¬¸ì œ í‘œì‹œ
            displayMidCategoryQuestion() {
                if (this.currentQuestionIndex >= this.filteredQuestions.length) {
                    ACIUApp.ui.showErrorMessage('ëª¨ë“  ë¬¸ì œë¥¼ í’€ì´í–ˆìŠµë‹ˆë‹¤!');
                    return;
                }

                this.currentQuestion = this.filteredQuestions[this.currentQuestionIndex];
                this.selectedAnswer = null;
                this.isAnswerChecked = false;

                // ë¸Œë ˆë“œí¬ëŸ¼ì— ë¬¸ì œ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ (ì¤‘ë¶„ë¥˜ í™”ë©´ í—¤ë”)
                ACIUApp.ui.categorySelection.updateBreadcrumb();

                document.getElementById('mid-category-question-number').textContent = this.currentQuestionIndex + 1;
                document.getElementById('mid-category-total-questions').textContent = this.filteredQuestions.length;
                document.getElementById('mid-category-question-text').textContent = this.currentQuestion.QUESTION;

                const answerButtonsContainer = document.getElementById('mid-category-answer-buttons');
                answerButtonsContainer.innerHTML = '';

                if (this.currentQuestion.TYPE === 'ì§„ìœ„í˜•') {
                    answerButtonsContainer.innerHTML = `
                        <button onclick="ACIUApp.learning.selectAnswer('O', 'mid')" class="answer-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="O">O</button>
                        <button onclick="ACIUApp.learning.selectAnswer('X', 'mid')" class="answer-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="X">X</button>
                    `;
                } else {
                    for (let i = 1; i <= 4; i++) {
                        answerButtonsContainer.innerHTML += `
                            <button onclick="ACIUApp.learning.selectAnswer('${i}', 'mid')" class="answer-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg" data-answer="${i}">${i}</button>
                        `;
                    }
                }
                document.getElementById('mid-category-result-area').classList.add('hidden');
                document.getElementById('mid-category-explanation-btn').classList.add('hidden');
                this.resetAnswerButtons('mid'); // ì¤‘ë¶„ë¥˜ìš© ë²„íŠ¼ ì´ˆê¸°í™”
            },

            // ì¤‘ë¶„ë¥˜ í•™ìŠµìš© ë”ë¯¸ ë¬¸ì œ ë¡œë“œ (Placeholder)
            loadDummyQuestionsForMidCategory(largeCategoryCode, midCategoryName) {
                console.log(`ë”ë¯¸ ë¬¸ì œ ë¡œë“œ (ì¤‘ë¶„ë¥˜): ${largeCategoryCode} > ${midCategoryName}`);
                // ì‹¤ì œ CSV í•„í„°ë§ ë¡œì§ ëŒ€ì‹  ë”ë¯¸ ë¬¸ì œ ìƒì„±
                this.filteredQuestions = [];
                for (let i = 1; i <= 5; i++) { // 5ê°œì˜ ë”ë¯¸ ë¬¸ì œ ìƒì„±
                    this.filteredQuestions.push({
                        QCODE: `${largeCategoryCode.substring(2)}-${midCategoryName.replace(/\s/g, '')}-DUMMY-${i}`,
                        TYPE: i % 2 === 0 ? 'ì„ íƒí˜•' : 'ì§„ìœ„í˜•',
                        LAYER1: largeCategoryCode,
                        LAYER2: midCategoryName,
                        LAYER3: `ë”ë¯¸ì„¸ë¶€${i}`,
                        QUESTION: `[${largeCategoryCode.substring(2)} > ${midCategoryName}] ê´€ë ¨ ë”ë¯¸ ë¬¸ì œ ${i}ë²ˆì…ë‹ˆë‹¤. ì´ ë¬¸ì œëŠ” ë”ë¯¸ ë°ì´í„°ì…ë‹ˆë‹¤.`,
                        ANSWER: i % 2 === 0 ? '1' : 'O',
                        EXPLAIN: `ì´ê²ƒì€ ${largeCategoryCode.substring(2)} ${midCategoryName} ë¬¸ì œ ${i}ì— ëŒ€í•œ ë”ë¯¸ í•´ì„¤ì…ë‹ˆë‹¤.`
                    });
                }
                this.currentQuestionIndex = 0;
                this.displayMidCategoryQuestion();
            },

            // ë‹µì•ˆ ì„ íƒ (ëª¨ë“œ ì¸ì ì¶”ê°€)
            selectAnswer(answer, mode = 'basic') {
                console.log(`ë‹µì•ˆ ì„ íƒ (${mode} ëª¨ë“œ):`, answer);
                this.selectedAnswer = answer;
                
                // ëª¨ë“  ë‹µì•ˆ ë²„íŠ¼ ì´ˆê¸°í™”
                this.resetAnswerButtons(mode);
                
                // ì„ íƒëœ ë‹µì•ˆ ë²„íŠ¼ ê°•ì¡°
                let containerId;
                if (mode === 'large') {
                    containerId = 'large-category-answer-buttons';
                } else if (mode === 'mid') {
                    containerId = 'mid-category-answer-buttons';
                } else {
                    containerId = 'answer-buttons';
                }

                const selectedButton = document.querySelector(`#${containerId} [data-answer="${answer}"]`);
                if (selectedButton) {
                    selectedButton.classList.remove('bg-blue-500', 'bg-red-500', 'bg-gray-500');
                    selectedButton.classList.add('bg-yellow-500');
                }
            },

            // ë‹µì•ˆ ë²„íŠ¼ ì´ˆê¸°í™” (ëª¨ë“œ ì¸ì ì¶”ê°€)
            resetAnswerButtons(mode = 'basic') {
                let buttons;
                if (mode === 'large') {
                    buttons = document.querySelectorAll('#large-category-answer-buttons .answer-btn');
                } else if (mode === 'mid') {
                    buttons = document.querySelectorAll('#mid-category-answer-buttons .answer-btn');
                } else {
                    buttons = document.querySelectorAll('#answer-buttons .answer-btn');
                }
                
                buttons.forEach(button => {
                    button.classList.remove('bg-yellow-500');
                    if (button.getAttribute('data-answer') === 'O') {
                        button.classList.add('bg-blue-500');
                    } else if (button.getAttribute('data-answer') === 'X') {
                        button.classList.add('bg-red-500');
                    } else {
                        button.classList.add('bg-gray-500');
                    }
                });
            },

            // ì •ë‹µ í™•ì¸ (ëª¨ë“œ ì¸ì ì¶”ê°€)
            checkAnswer(mode = 'basic') {
                if (!this.selectedAnswer) {
                    ACIUApp.ui.showErrorMessage('ë‹µì•ˆì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }

                console.log(`ì •ë‹µ í™•ì¸ (${mode} ëª¨ë“œ)`);
                this.isAnswerChecked = true;

                const isCorrect = this.selectedAnswer === this.currentQuestion.ANSWER;
                
                let resultArea, resultMessage, explanationBtn;
                
                if (mode === 'large') {
                    resultArea = document.getElementById('large-category-result-area');
                    resultMessage = document.getElementById('large-category-result-message');
                    explanationBtn = document.getElementById('large-category-explanation-btn');
                } else if (mode === 'mid') {
                    resultArea = document.getElementById('mid-category-result-area');
                    resultMessage = document.getElementById('mid-category-result-message');
                    explanationBtn = document.getElementById('mid-category-explanation-btn');
                } else {
                    resultArea = document.getElementById('result-area');
                    resultMessage = document.getElementById('result-message');
                    explanationBtn = document.getElementById('explanation-btn');
                }

                if (isCorrect) {
                    resultMessage.className = 'p-4 rounded-lg bg-green-100 text-green-800';
                    resultMessage.innerHTML = `
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">âœ…</span>
                            <span class="font-bold">ì •ë‹µì…ë‹ˆë‹¤!</span>
                        </div>
                    `;
                } else {
                    resultMessage.className = 'p-4 rounded-lg bg-red-100 text-red-800';
                    resultMessage.innerHTML = `
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">âŒ</span>
                            <span class="font-bold">í‹€ë ¸ìŠµë‹ˆë‹¤.</span>
                            <span class="ml-2">ì •ë‹µ: ${this.currentQuestion.ANSWER}</span>
                        </div>
                    `;
                }

                resultArea.classList.remove('hidden');
                explanationBtn.classList.remove('hidden');
                this.saveLearningHistory(isCorrect);
            },

            // ë‹¤ìŒ ë¬¸ì œ (ëª¨ë“œ ì¸ì ì¶”ê°€)
            nextQuestion(mode = 'basic') {
                if (this.currentQuestionIndex < this.filteredQuestions.length - 1) {
                    this.currentQuestionIndex++;
                    if (mode === 'large') {
                        this.displayLargeCategoryQuestion();
                    } else if (mode === 'mid') {
                        this.displayMidCategoryQuestion();
                    } else {
                        this.displayQuestion();
                    }
                } else {
                    ACIUApp.ui.showErrorMessage('ë§ˆì§€ë§‰ ë¬¸ì œì…ë‹ˆë‹¤.');
                }
            },

            // ì´ì „ ë¬¸ì œ (ëª¨ë“œ ì¸ì ì¶”ê°€)
            prevQuestion(mode = 'basic') {
                if (this.currentQuestionIndex > 0) {
                    this.currentQuestionIndex--;
                    if (mode === 'large') {
                        this.displayLargeCategoryQuestion();
                    } else if (mode === 'mid') {
                        this.displayMidCategoryQuestion();
                    } else {
                        this.displayQuestion();
                    }
                } else {
                    ACIUApp.ui.showErrorMessage('ì²« ë²ˆì§¸ ë¬¸ì œì…ë‹ˆë‹¤.');
                }
            },

            // í•´ì„¤ ë³´ê¸° (ëª¨ë“œ ì¸ì ì¶”ê°€)
            showExplanation(mode = 'basic') {
                if (this.currentQuestion.EXPLAIN) {
                    ACIUApp.ui.showErrorMessage(`í•´ì„¤: ${this.currentQuestion.EXPLAIN}`); // alert ëŒ€ì‹  ëª¨ë‹¬ ì‚¬ìš©
                } else {
                    ACIUApp.ui.showErrorMessage('í•´ì„¤ì´ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
            },

            // í•™ìŠµ ì´ë ¥ ì €ì¥
            saveLearningHistory(isCorrect) {
                if (!this.currentQuestion) return;

                const learningData = {
                    qcode: this.currentQuestion.QCODE,
                    timestamp: new Date().toISOString(),
                    isCorrect: isCorrect,
                    layer1: this.currentQuestion.LAYER1,
                    layer2: this.currentQuestion.LAYER2,
                    mode: this.currentMode // í˜„ì¬ ëª¨ë“œ ë³€ìˆ˜ ì‚¬ìš©
                };

                // learningHistory.attemptsëŠ” ê°ì²´ì´ë¯€ë¡œ QCODEë¥¼ í‚¤ë¡œ ì‚¬ìš©
                ACIUApp.data.learningHistory.attempts[this.currentQuestion.QCODE] = learningData;
                localStorage.setItem('aciu_learning_history', JSON.stringify(ACIUApp.data.learningHistory));

                console.log('í•™ìŠµ ì´ë ¥ ì €ì¥ë¨:', learningData);
                ACIUApp.ui.updateStatistics(); // ë©”ì¸ í†µê³„ ì—…ë°ì´íŠ¸
                ACIUApp.ui.updateLargeCategoryStats(); // ëŒ€ë¶„ë¥˜ í†µê³„ ì—…ë°ì´íŠ¸
            }
        }
    };

    // ACIUApp ì´ˆê¸°í™” í•¨ìˆ˜
    ACIUApp.init = async function() {
        console.log('ACIUApp ì´ˆê¸°í™” ì‹œì‘');
        
        // ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í™•ì¸
        this.compatibility.checkBrowserSupport();
        
        // ë°ì´í„° ë¡œë”©
        await this.data.loadQuestions();
        this.data.loadUserSettings();
        this.data.loadLearningHistory();
        
        // UI ì´ˆê¸°í™”
        this.ui.init();
        
        // íƒ€ì´ë¨¸ ì„¤ì •
        ACIUApp.timers.timeUpdate = setInterval(() => ACIUApp.ui.updateCurrentTime(), 1000);
        ACIUApp.timers.quoteUpdate = setInterval(() => ACIUApp.ui.updateQuote(), 10000); // 10ì´ˆë§ˆë‹¤ ëª…ì–¸ ì—…ë°ì´íŠ¸
        ACIUApp.timers.ddayUpdate = setInterval(() => ACIUApp.ui.updateDdayCount(), 60 * 60 * 1000); // 1ì‹œê°„ë§ˆë‹¤ D-Day ì—…ë°ì´íŠ¸

        console.log('ACIUApp ì´ˆê¸°í™” ì™„ë£Œ');
    };

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    window.addEventListener('load', function() {
        ACIUApp.init();
    });
    </script>
</body>
</html>
