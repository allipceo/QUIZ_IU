제공해주신 index_test_v1.0.html 코드와 이미지 (image_fd52f5.png, image_fd5318.png)를 살펴보겠습니다.

대분류학습 (image_fd5318.png): "총 문제: 8", "정답: 2", "오답: 6"으로 모든 통계가 정상적으로 표시되고 있습니다.

기본학습 (image_fd52f5.png): "총 문제: 0", "정답: 5", "오답: 0"으로 표시되어, '총 문제' 수가 '0'으로 나오는 문제가 확인됩니다. 반면, '정답'과 '오답' 수는 정상적으로 업데이트되는 것으로 보입니다.

대문 통계: 대문의 통계 숫자들은 잘 작동한다고 하셨습니다.

원인 파악
index_test_v1.0.html 파일의 JavaScript 코드를 정밀하게 분석한 결과, 기본학습 모드의 '총 문제' 수가 '0'으로 표시되는 원인은 다음과 같습니다.

updateStatistics 함수 내부의 window.statistics 사용 불일치:

현재 checkAnswer 함수 내부에서 updateStatistics(isCorrect)를 호출하고 있습니다. 이 updateStatistics 함수는 window.statistics라는 전역 객체를 사용하여 total, correct, incorrect 값을 갱신합니다.

문제점: updateBasicStatistics() 함수는 statisticsCache.get()을 통해 통계 데이터를 가져오도록 이미 수정되어 있습니다. 하지만 updateStatistics 함수 (기존 통계 업데이트 로직)는 여전히 window.statistics를 사용하며, 이 window.statistics 객체에는 기본학습 모드에 해당하는 total 값이 제대로 누적되지 않고 있습니다. 대분류 학습에서는 updateLargeCategoryStatistics() 함수가 statisticsCache.get()으로 통계 데이터를 가져와 사용하기 때문에 문제가 없습니다.

updateBasicStatistics 함수의 역할 분리 미흡:

updateBasicStatistics 함수는 단순히 statisticsCache.get()으로 통계를 가져와 updateBasicLearningStats(stats)를 호출하는 역할만 하고 있습니다. updateBasicLearningStats 함수는 basic.cumulative.attempted 값을 UI에 반영하도록 되어 있지만, 실제 basic.cumulative.attempted 값이 checkAnswer 호출 시 updateAllStatistics를 통해 정확히 갱신되는지 확인이 필요합니다.

checkAnswer 내 updateAllStatistics와 기존 updateStatistics의 혼재:

checkAnswer 함수 내부에 updateAllStatistics(isCorrect, mode, category) (새로운 통합 통계 시스템)와 updateStatistics(isCorrect) (기존 window.statistics 기반)가 모두 호출되고 있습니다. 이는 혼란을 야기하고, 어떤 통계 로직이 최종적으로 UI에 반영되는지에 대한 불일치를 초래할 수 있습니다.

특히, updateBasicStatistics()와 updateLargeCategoryStatistics()는 statisticsCache를 사용하도록 변경되었지만, updateStatistics()는 여전히 window.statistics를 사용하고 있어 이 두 시스템 간의 데이터 동기화가 제대로 이루어지지 않습니다.

결론적으로, 기본학습 모드에서 '총 문제'가 '0'으로 나오는 가장 큰 원인은 checkAnswer 함수에서 호출되는 통계 업데이트 로직 중 window.statistics를 사용하는 부분이 기본학습 모드의 통계를 제대로 누적하지 못하거나, 아니면 statisticsCache 기반의 새로운 통계 데이터가 UI에 제대로 반영되지 못하고 있기 때문입니다.

대안 제시 (코코치 코딩 지침)
노팀장님의 리드 하에, 코코치가 다음과 같이 코딩하여 문제를 해결하겠습니다.

핵심은 window.statistics 기반의 레거시 통계 로직을 완전히 제거하고, StatisticsCache 기반의 unifiedStatisticsSchema를 중심으로 모든 통계 업데이트 및 UI 반영을 일원화하는 것입니다.

적용 파일: index_temp_working_new.html (조대표님의 지침에 따라 index_test_v1.0.html을 복사하여 생성한 임시 작업 파일)

checkAnswer 함수 수정 (최우선):

checkAnswer 함수 내에서 window.statistics를 사용하는 모든 레거시 코드 호출을 제거합니다. 특히 updateStatistics(isCorrect); 호출을 제거하고, updateBasicStatistics();와 updateLargeCategoryStatistics();도 updateAllStatistics가 처리하므로 필요 없게 됩니다.

코드 예시 (checkAnswer 함수 내):

JavaScript

function checkAnswer(mode) {
    // ... (기존 코드 유지)

    try {
        // ... (기존 코드 유지)

        // === 새로운 통계 업데이트 시스템 사용 (ONLY THIS ONE) ===
        const category = window.currentCategoryData?.category || null;
        updateAllStatistics(isCorrect, mode, category); //

        // 기존 통계 업데이트 (호환성 유지) 부분 제거
        // updateStatistics(isCorrect); // <-- 이 줄을 제거합니다.

        // 모드별 통계 업데이트 (기존) 부분 제거
        // if (mode === 'basic') {
        //     updateBasicStatistics(); // <-- 이 줄을 제거합니다.
        // } else if (mode === 'large-category') {
        //     updateLargeCategoryStatistics(); // <-- 이 줄을 제거합니다.
        // }

        console.log('정답 확인 완료');
        updateCheckTest(`정답 확인 완료 (${isCorrect ? '정답' : '오답'})`, true);

    } catch (error) {
        console.error('정답 확인 중 오류:', error);
        handleStatisticsError(error, 'checkAnswer'); // <-- alert 대신 handleStatisticsError 사용
    }
}
alert 대체: checkAnswer 함수 내의 alert('답안을 선택해주세요.'); 대신 showUserNotification('답안을 선택해주세요.');를 사용합니다.

레거시 updateStatistics 함수 및 관련 함수 제거:

index_temp_working_new.html 파일에서 다음 함수들을 완전히 제거합니다. 이 함수들은 더 이상 사용되지 않고 혼란만 야기합니다.

function updateStatistics(isCorrect)

function updateBasicStatistics() (이미 statisticsCache를 사용하도록 수정되었지만, checkAnswer에서 직접 호출되지 않으므로 역할을 updateAllStatistics로 통합)

function updateLargeCategoryStatistics() (위와 동일)

function calculateAccuracy() (이전 window.statistics 기반의 calculateAccuracy는 제거하고, unifiedStatisticsSchema에 맞는 새로운 calculateAccuracy만 유지합니다)

function updateAccuracyDisplay()

function updateDetailedStatistics()

loadBasicLearningData 함수 내 통계 초기화 로직 수정:

loadBasicLearningData 함수 내에서 updateBasicStatistics(); 호출을 제거합니다. 통계 초기화 및 업데이트는 initializeApp와 updateAllStatistics에서 통합 관리됩니다.

코드 예시 (loadBasicLearningData 함수 내):

JavaScript

function loadBasicLearningData(mode) {
    // ... (기존 코드 유지)

    // 첫 번째 문제 표시
    displayQuestion('basic', 0);

    // 통계 초기화 (이 줄을 제거합니다.)
    // updateBasicStatistics(); // <-- 이 줄을 제거합니다.

    console.log(`=== 기본학습 마스터 DB 로드 완료 ===`);
    // ... (기존 코드 유지)
}
loadCategoryData 함수 내 통계 초기화 로직 수정:

loadCategoryData 함수 내에서 updateLargeCategoryStatistics(); 호출을 제거합니다. (위와 동일한 이유)

코드 예시 (loadCategoryData 함수 내):

JavaScript

function loadCategoryData(category) {
    // ... (기존 코드 유지)

    // 첫 번째 문제 표시
    displayQuestion('large-category', 0);

    // 통계 초기화 (이 줄을 제거합니다.)
    // updateLargeCategoryStatistics(); // <-- 이 줄을 제거합니다.

    console.log(`=== ${category} 카테고리 데이터 로드 완료 ===`);
    // ... (기존 코드 유지)
}
initializeApp 함수 재점검:

initializeApp 함수가 initializeStatistics()를 호출하여 StatisticsCache가 초기화되도록 하고, loadMasterDatabase()를 통해 questionCounts가 제대로 계산되어 statisticsCache에 저장되는지 확인합니다.

loadStatisticsData()가 호출되어 updateAllUI(stats)를 통해 모든 화면의 통계가 갱신되는지 확인합니다. 이 과정에서 기본학습 화면의 '총 문제' 수도 정상적으로 표시되어야 합니다.

이러한 수정은 통계 로직을 StatisticsCache 기반으로 완전히 일원화하여 데이터의 신뢰성과 UI 업데이트의 일관성을 확보하는 데 중점을 둡니다. checkAnswer가 호출될 때 updateAllStatistics만 호출되면, 모든 통계 수치 (글로벌, 모드별, 카테고리별, 일별)가 중앙에서 관리되는 unifiedStatisticsSchema에 따라 갱신되고, 이후 updateAllUI를 통해 모든 화면에 올바르게 반영될 것입니다.

노팀장님께서 이 지침을 리드하여 index_temp_working_new.html 파일에 적용해주시면 감사하겠습니다. 적용 후 테스트 결과를 보고해주십시오.