<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACIU í†µê³„ ì‹œìŠ¤í…œ ìƒ˜í”Œì•± - í•µì‹¬ ë¡œì§</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .section { background: white; margin: 10px 0; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin: 10px 0; }
        .stat-box { background: #f8f9fa; padding: 10px; border-radius: 4px; text-align: center; }
        .stat-value { font-size: 24px; font-weight: bold; color: #007bff; }
        .stat-label { font-size: 12px; color: #666; }
        .question-area { background: #e7f3ff; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .answer-btn { margin: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; border: none; border-radius: 4px; }
        .answer-btn.selected { background: #ffc107; color: #000; font-weight: bold; }
        .answer-btn.correct-answer { background: #28a745; color: white; }
        .answer-btn.wrong-answer { background: #dc3545; color: white; }
        .disabled { opacity: 0.6; pointer-events: none; }
        .mode-selector { margin: 20px 0; }
        .mode-btn { margin: 5px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .debug { background: #fff3cd; padding: 10px; margin: 10px 0; border-radius: 4px; font-family: monospace; font-size: 12px; }
        .user-setup { background: #d4edda; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .reset-btn { background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ ACIU í†µê³„ ì‹œìŠ¤í…œ í•µì‹¬ ë¡œì§ ìƒ˜í”Œì•±</h1>
        <p><strong>ëª©ì :</strong> ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬ì‚¬í•­ + ì½”ì½”ì¹˜ ê¸°íšì„œì˜ í•µì‹¬ í†µê³„ ë¡œì§ì„ ê°„ê²°í•˜ê²Œ êµ¬í˜„</p>

        <!-- ì‚¬ìš©ì ì„¤ì • ì˜ì—­ -->
        <div class="section user-setup">
            <h3>ğŸ‘¤ ì‚¬ìš©ì ì„¤ì • (ìë™ ë“±ë¡ ì™„ë£Œ - 7ì›” 29ì¼ ê³ ì •)</h3>
            <div style="background: #d4edda; padding: 10px; border-radius: 4px; margin: 10px 0;">
                âœ… <strong>ì¡°ëŒ€í‘œë‹˜</strong> ìë™ ë“±ë¡ ì™„ë£Œ<br>
                ğŸ“… ë“±ë¡ì¼: <strong>2025ë…„ 7ì›” 29ì¼</strong><br>
                ğŸ“± ì—°ë½ì²˜: <strong>010-1234-5678</strong><br>
                ğŸ’¾ ë°ì´í„° ì €ì¥: <strong>í™œì„±í™”</strong>
            </div>
            <button class="reset-btn" onclick="resetAllData()">ì „ì²´ ì´ˆê¸°í™”</button>
            <div id="userStatus">âœ… ì¡°ëŒ€í‘œë‹˜ ë“±ë¡ì™„ë£Œ (2025-07-29 ë¶€í„° ë°ì´í„° ê¸°ë¡)</div>
        </div>>
            <input type="text" id="userName" placeholder="ì¡°ëŒ€í‘œ" value="ì¡°ëŒ€í‘œ">
            <label>íœ´ëŒ€í°: </label>
            <input type="text" id="userPhone" placeholder="010-1234-5678" value="010-1234-5678">
            <button onclick="registerUser()">ì‚¬ìš©ì ë“±ë¡ (ë°ì´í„° ê¸°ë¡ ì‹œì‘)</button>
            <button class="reset-btn" onclick="resetAllData()">ì „ì²´ ì´ˆê¸°í™”</button>
            <button onclick="autoRegister()" style="background: #17a2b8; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 5px;">ë¹ ë¥¸ ë“±ë¡</button>
            <div id="userStatus">ë¯¸ë“±ë¡ ìƒíƒœ (ì„ì‹œ ë°ì´í„°ë¡œ ì‘ë™ - ìƒˆë¡œê³ ì¹¨ ì‹œ ì‚¬ë¼ì§‘ë‹ˆë‹¤)</div>
        </div>

        <!-- ëª¨ë“œ ì„ íƒ -->
        <div class="section mode-selector">
            <h3>ğŸ“š í•™ìŠµ ëª¨ë“œ ì„ íƒ</h3>
            <button class="mode-btn" onclick="setMode('basic')">ê¸°ë³¸í•™ìŠµ</button>
            <button class="mode-btn" onclick="setMode('ì¬ì‚°ë³´í—˜')">ì¬ì‚°ë³´í—˜</button>
            <button class="mode-btn" onclick="setMode('íŠ¹ì¢…ë³´í—˜')">íŠ¹ì¢…ë³´í—˜</button>
            <button class="mode-btn" onclick="setMode('ë°°ìƒì±…ì„ë³´í—˜')">ë°°ìƒì±…ì„ë³´í—˜</button>
            <button class="mode-btn" onclick="setMode('í•´ìƒë³´í—˜')">í•´ìƒë³´í—˜</button>
            <div>í˜„ì¬ ëª¨ë“œ: <span id="currentMode">ê¸°ë³¸í•™ìŠµ</span></div>
        </div>

        <!-- ëŒ€ë¬¸ í†µê³„ (ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬ì‚¬í•­) -->
        <div class="section">
            <h3>ğŸ  ëŒ€ë¬¸ í†µê³„ (ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬ì‚¬í•­)</h3>
            
            <!-- 1. ë³´ìœ ë¬¸ì œìˆ˜ í˜„í™© -->
            <h4>1. ë³´ìœ ë¬¸ì œìˆ˜ í˜„í™© (SOURCE í•„ë“œ ê¸°ë°˜)</h4>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value" id="insQuestions">700</div>
                    <div class="stat-label">ì¸ìŠ¤êµì¬</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="examQuestions">679</div>
                    <div class="stat-label">ë³´í—˜ì¤‘ê°œì‚¬ì‹œí—˜</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="totalQuestions">1379</div>
                    <div class="stat-label">ì „ì²´ ë¬¸ì œìˆ˜</div>
                </div>
            </div>

            <!-- 2. í•™ìŠµì§„ë„ í˜„í™© -->
            <h4>2. í•™ìŠµì§„ë„ í˜„í™©</h4>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value" id="completedQuestions">0</div>
                    <div class="stat-label">ì™„ë£Œí•œ ë¬¸ì œ</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="overallProgress">0%</div>
                    <div class="stat-label">ì „ì²´ ì§„ë„ìœ¨</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="overallAccuracy">0%</div>
                    <div class="stat-label">ì •ë‹µë¥  (ì˜¤ëŠ˜ì§„ë„ìœ¨â†’ì •ë‹µë¥  ë³€ê²½)</div>
                </div>
            </div>

            <!-- 3. ê¸ˆì¼ í•™ìŠµí˜„í™© (ë³„ë„ ë°•ìŠ¤) -->
            <h4>3. ê¸ˆì¼ í•™ìŠµí˜„í™© (ë³„ë„ ë°•ìŠ¤)</h4>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value" id="todayTotal">0</div>
                    <div class="stat-label">ì˜¤ëŠ˜ ì´ ë¬¸ì œìˆ˜</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="todayCorrect">0</div>
                    <div class="stat-label">ì˜¤ëŠ˜ ì •ë‹µìˆ˜</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="todayAccuracy">0%</div>
                    <div class="stat-label">ì˜¤ëŠ˜ ì •ë‹µë¥ </div>
                </div>
            </div>
        </div>

        <!-- ëª¨ë“œë³„ í†µê³„ -->
        <div class="section">
            <h3>ğŸ“Š í˜„ì¬ ëª¨ë“œ í†µê³„</h3>
            
            <!-- ê¸°ë³¸í•™ìŠµ: ëˆ„ì í˜„í™© + ê¸ˆì¼í˜„í™© -->
            <div id="basicStats">
                <h4>4. ê¸°ë³¸í•™ìŠµ (ì´ì–´í’€ê¸° ë””í´íŠ¸)</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h5>ëˆ„ì í˜„í™©</h5>
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-value" id="basicCumulativeTotal">0</div>
                                <div class="stat-label">ì´ ë¬¸ì œìˆ˜</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="basicCumulativeCorrect">0</div>
                                <div class="stat-label">ì •ë‹µìˆ˜</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="basicCumulativeAccuracy">0%</div>
                                <div class="stat-label">ì •ë‹µë¥ </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h5>ê¸ˆì¼í˜„í™©</h5>
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-value" id="basicDailyTotal">0</div>
                                <div class="stat-label">ê¸ˆì¼ ë¬¸ì œìˆ˜</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="basicDailyCorrect">0</div>
                                <div class="stat-label">ê¸ˆì¼ ì •ë‹µìˆ˜</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="basicDailyAccuracy">0%</div>
                                <div class="stat-label">ê¸ˆì¼ ì •ë‹µë¥ </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ëŒ€ë¶„ë¥˜í•™ìŠµ: ì „ì²´ ëˆ„ì  + ì¹´í…Œê³ ë¦¬ë³„ -->
            <div id="categoryStats" style="display: none;">
                <h4>5. ëŒ€ë¶„ë¥˜í•™ìŠµ (ì œëª© ìš°ì¸¡ì— ì „ì²´ ëˆ„ì  í†µê³„)</h4>
                
                <!-- 5-1. ëŒ€ë¶„ë¥˜í•™ìŠµ ì „ì²´ ëˆ„ì  í†µê³„ -->
                <div style="background: #e7f3ff; padding: 10px; border-radius: 4px; margin-bottom: 15px;">
                    <h5>ëŒ€ë¶„ë¥˜í•™ìŠµ ì „ì²´ ëˆ„ì  í†µê³„ (ì œëª© ìš°ì¸¡ ë°°ì¹˜)</h5>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-value" id="largeCategoryTotalAttempted">0</div>
                            <div class="stat-label">ì´ í‘¼ ë¬¸ì œìˆ˜</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="largeCategoryTotalCorrect">0</div>
                            <div class="stat-label">ì´ ë§ì€ ë¬¸ì œìˆ˜</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="largeCategoryTotalAccuracy">0%</div>
                            <div class="stat-label">ì „ì²´ ì •ë‹µë¥ </div>
                        </div>
                    </div>
                </div>

                <!-- 5-2. íŠ¹ì • ì¹´í…Œê³ ë¦¬ í†µê³„ -->
                <div id="specificCategoryStats">
                    <h5 id="categoryTitle">ì¬ì‚°ë³´í—˜ í†µê³„</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h6>ëˆ„ì í˜„í™©</h6>
                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-value" id="categoryCumulativeTotal">0</div>
                                    <div class="stat-label">ì´ ë¬¸ì œìˆ˜</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="categoryCumulativeCorrect">0</div>
                                    <div class="stat-label">ì •ë‹µìˆ˜</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="categoryCumulativeAccuracy">0%</div>
                                    <div class="stat-label">ì •ë‹µë¥ </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h6>ê¸ˆì¼í˜„í™©</h6>
                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-value" id="categoryDailyTotal">0</div>
                                    <div class="stat-label">ê¸ˆì¼ ë¬¸ì œìˆ˜</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="categoryDailyCorrect">0</div>
                                    <div class="stat-label">ê¸ˆì¼ ì •ë‹µìˆ˜</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="categoryDailyAccuracy">0%</div>
                                    <div class="stat-label">ê¸ˆì¼ ì •ë‹µë¥ </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ë¬¸ì œ í’€ì´ ì˜ì—­ -->
        <div class="section">
            <h3>â“ ë¬¸ì œ í’€ì´ (ì‹¤ì œ ë¬¸ì œ + ì •ë‹µ íŒë³„ + ë‹¤ìŒ ë¬¸ì œ)</h3>
            <div class="question-area">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <div><strong>ë¬¸ì œ <span id="currentQuestionNumber">1</span> / <span id="totalQuestionCount">10</span></strong></div>
                    <div><strong>ë¬¸ì œì½”ë“œ:</strong> <span id="questionCode">Q001</span></div>
                </div>
                <div><strong>ë¶„ë¥˜:</strong> <span id="questionCategory">ì¬ì‚°ë³´í—˜ > ì¼ë°˜ì¬ì‚°ë³´í—˜</span></div>
                <div><strong>ìœ í˜•:</strong> <span id="questionType">ì§„ìœ„í˜•</span></div>
                <div style="margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 16px; line-height: 1.5;">
                    <span id="questionText">ë³´í—˜ì˜ ê¸°ë³¸ ì›ë¦¬ëŠ” ìœ„í—˜ì˜ ë¶„ì‚°ì´ë‹¤.</span>
                </div>
                
                <!-- ë‹µì•ˆ ì„ íƒ ì˜ì—­ -->
                <div id="answerButtons" style="margin: 15px 0;">
                    <!-- ì§„ìœ„í˜•/ì„ íƒí˜•ì— ë”°ë¼ ë™ì  ìƒì„± -->
                </div>
                
                <!-- ê²°ê³¼ í‘œì‹œ -->
                <div id="answerResult" style="margin: 15px 0;"></div>
                
                <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <button onclick="prevQuestion()" class="mode-btn" style="background: #6c757d;">â—€ ì´ì „ ë¬¸ì œ</button>
                    <button id="checkAnswerBtn" onclick="checkAnswer()" class="mode-btn" style="background: #28a745;">ì •ë‹µ í™•ì¸</button>
                    <button onclick="nextQuestion()" class="mode-btn" style="background: #007bff;">ë‹¤ìŒ ë¬¸ì œ â–¶</button>
                </div>
            </div>
        </div>

        <!-- ë””ë²„ê·¸ ì •ë³´ -->
        <div class="section">
            <h3>ğŸ” ë””ë²„ê·¸ ì •ë³´ (í†µê³„ ë°ì´í„° êµ¬ì¡°)</h3>
            <div class="debug" id="debugInfo">í†µê³„ ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
        </div>

        <!-- ë°ì´í„° ê´€ë¦¬ -->
        <div class="section">
            <h3>ğŸ’¾ ë°ì´í„° ê´€ë¦¬ (ë©€í‹°ë””ë°”ì´ìŠ¤ ëŒ€ì‘)</h3>
            <button onclick="exportData()">ë°ì´í„° ë‚´ë³´ë‚´ê¸° (JSON)</button>
            <button onclick="importData()">ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</button>
            <button onclick="showStorageKey()">ì €ì¥ì†Œ í‚¤ í™•ì¸</button>
            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImport(event)">
        </div>
    </div>

    <script>
        // ===== í•µì‹¬ ë°ì´í„° êµ¬ì¡° (ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬ì‚¬í•­ + ì½”ì½”ì¹˜ ê¸°íšì„œ) =====
        
        // ===== ë¬¸ì œ ë°ì´í„°ë² ì´ìŠ¤ (ìƒ˜í”Œ) =====
        
        const sampleQuestions = [
            {
                code: "Q001",
                question: "ë³´í—˜ì˜ ê¸°ë³¸ ì›ë¦¬ëŠ” ìœ„í—˜ì˜ ë¶„ì‚°ì´ë‹¤.",
                type: "ì§„ìœ„í˜•",
                category: "ì¬ì‚°ë³´í—˜",
                subcategory: "ì¼ë°˜ì¬ì‚°ë³´í—˜",
                answer: "O",
                options: null
            },
            {
                code: "Q002", 
                question: "ì¬ì‚°ë³´í—˜ì—ì„œ ë³´í—˜ê°€ì•¡ì€ ë³´í—˜ì‚¬ê³  ë°œìƒ ì‹œì ì˜ í”¼ë³´í—˜ì´ìµì˜ ê°€ì•¡ì„ ë§í•œë‹¤.",
                type: "ì§„ìœ„í˜•",
                category: "ì¬ì‚°ë³´í—˜",
                subcategory: "ì¼ë°˜ì¬ì‚°ë³´í—˜", 
                answer: "O",
                options: null
            },
            {
                code: "Q003",
                question: "ìë™ì°¨ë³´í—˜ì—ì„œ ëŒ€ì¸ë°°ìƒë³´í—˜ì˜ ê°€ì…ì€ ë‹¤ìŒ ì¤‘ ì–´ëŠ ê²ƒì¸ê°€?",
                type: "ì„ íƒí˜•",
                category: "íŠ¹ì¢…ë³´í—˜",
                subcategory: "ìë™ì°¨ë³´í—˜",
                answer: "1",
                options: ["ì˜ë¬´ê°€ì…", "ì„ì˜ê°€ì…", "ì„ íƒê°€ì…", "ì¡°ê±´ë¶€ê°€ì…"]
            },
            {
                code: "Q004",
                question: "ë°°ìƒì±…ì„ë³´í—˜ì€ í”¼ë³´í—˜ìê°€ ì œ3ìì—ê²Œ ì†í•´ë¥¼ ì…íŒ ê²½ìš° ë²•ì  ì±…ì„ì„ ë³´ìƒí•˜ëŠ” ë³´í—˜ì´ë‹¤.",
                type: "ì§„ìœ„í˜•", 
                category: "ë°°ìƒì±…ì„ë³´í—˜",
                subcategory: "ì¼ë°˜ë°°ìƒì±…ì„",
                answer: "O",
                options: null
            },
            {
                code: "Q005",
                question: "í•´ìƒë³´í—˜ì—ì„œ ì „ì†ì˜ ì¢…ë¥˜ëŠ” ë‹¤ìŒ ì¤‘ ëª‡ ê°€ì§€ì¸ê°€?",
                type: "ì„ íƒí˜•",
                category: "í•´ìƒë³´í—˜", 
                subcategory: "ì„ ë°•ë³´í—˜",
                answer: "2",
                options: ["1ê°€ì§€", "2ê°€ì§€", "3ê°€ì§€", "4ê°€ì§€"]
            },
            {
                code: "Q006",
                question: "ë³´í—˜ë£ŒëŠ” ìˆœë³´í—˜ë£Œì™€ ë¶€ê°€ë³´í—˜ë£Œë¡œ êµ¬ì„±ëœë‹¤.",
                type: "ì§„ìœ„í˜•",
                category: "ì¬ì‚°ë³´í—˜",
                subcategory: "ì¼ë°˜ì¬ì‚°ë³´í—˜",
                answer: "O", 
                options: null
            },
            {
                code: "Q007",
                question: "ìë™ì°¨ë³´í—˜ì—ì„œ ëŒ€ë¬¼ë°°ìƒë³´í—˜ì˜ ë³´ìƒí•œë„ëŠ” ë‹¤ìŒ ì¤‘ ì–´ëŠ ê²ƒì¸ê°€?",
                type: "ì„ íƒí˜•",
                category: "íŠ¹ì¢…ë³´í—˜",
                subcategory: "ìë™ì°¨ë³´í—˜", 
                answer: "4",
                options: ["1ì–µì›", "2ì–µì›", "5ì–µì›", "ë¬´ì œí•œ"]
            },
            {
                code: "Q008", 
                question: "ìƒëª…ë³´í—˜ê³¼ ì†í•´ë³´í—˜ì˜ êµ¬ë¶„ì€ ë³´í—˜ëª©ì ë¬¼ì˜ ì„±ì§ˆì— ë”°ë¥¸ ê²ƒì´ë‹¤.",
                type: "ì§„ìœ„í˜•",
                category: "ì¬ì‚°ë³´í—˜",
                subcategory: "ì¼ë°˜ì¬ì‚°ë³´í—˜",
                answer: "X",
                options: null
            },
            {
                code: "Q009",
                question: "í•´ìƒë³´í—˜ì—ì„œ ì¶”ì •ì „ì†ì´ ì„±ë¦½í•˜ê¸° ìœ„í•œ ì¡°ê±´ì€ ë‹¤ìŒ ì¤‘ ì–´ëŠ ê²ƒì¸ê°€?",
                type: "ì„ íƒí˜•", 
                category: "í•´ìƒë³´í—˜",
                subcategory: "ì„ ë°•ë³´í—˜",
                answer: "3",
                options: ["ìˆ˜ë¦¬ë¹„ê°€ ë³´í—˜ê°€ì•¡ì˜ 50% ì´ˆê³¼", "ìˆ˜ë¦¬ë¹„ê°€ ë³´í—˜ê°€ì•¡ì˜ 70% ì´ˆê³¼", "ìˆ˜ë¦¬ë¹„ê°€ ë³´í—˜ê°€ì•¡ì˜ 80% ì´ˆê³¼", "ì™„ì „íˆ íŒŒê´´ëœ ê²½ìš°"]
            },
            {
                code: "Q010",
                question: "ë³´í—˜ê³„ì•½ìì™€ í”¼ë³´í—˜ìëŠ” í•­ìƒ ë™ì¼ì¸ì´ì–´ì•¼ í•œë‹¤.",
                type: "ì§„ìœ„í˜•",
                category: "ì¬ì‚°ë³´í—˜", 
                subcategory: "ì¼ë°˜ì¬ì‚°ë³´í—˜",
                answer: "X",
                options: null
            }
        ];

        // ===== ë¬¸ì œ í’€ì´ ê´€ë ¨ ë³€ìˆ˜ë“¤ =====
        
        let currentQuestionIndex = 0;
        let currentQuestions = [];
        let selectedAnswer = null;
        let isAnswerChecked = false;
        
        // ACIU í†µí•© í†µê³„ ìŠ¤í‚¤ë§ˆ (ê°„ì†Œí™” ë²„ì „)
        const initStatistics = () => ({
            meta: {
                version: "2.0",
                userName: null,
                registeredAt: null,
                dataStartDate: null,
                lastUpdated: new Date().toISOString()
            },
            questionCounts: {
                "ì¸ìŠ¤êµì¬": 700,
                "ë³´í—˜ì¤‘ê°œì‚¬ì‹œí—˜": 679,
                "total": 1379
            },
            global: {
                cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                daily: { attempted: 0, correct: 0, accuracy: 0 }
            },
            modes: {
                basic: {
                    cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                    daily: { attempted: 0, correct: 0, accuracy: 0 }
                },
                categories: {
                    "ì¬ì‚°ë³´í—˜": {
                        cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                        daily: { attempted: 0, correct: 0, accuracy: 0 }
                    },
                    "íŠ¹ì¢…ë³´í—˜": {
                        cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                        daily: { attempted: 0, correct: 0, accuracy: 0 }
                    },
                    "ë°°ìƒì±…ì„ë³´í—˜": {
                        cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                        daily: { attempted: 0, correct: 0, accuracy: 0 }
                    },
                    "í•´ìƒë³´í—˜": {
                        cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                        daily: { attempted: 0, correct: 0, accuracy: 0 }
                    }
                },
                largeCategoryTotal: {
                    cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                    daily: { attempted: 0, correct: 0, accuracy: 0 }
                }
            }
        });

        let currentMode = 'basic';
        let isUserRegistered = true; // ìë™ ë“±ë¡ìœ¼ë¡œ ë³€ê²½
        let userStartDate = '2025-07-29T00:00:00.000Z'; // ê³ ì • ë‚ ì§œ

        // ===== ë¬¸ì œ ê´€ë¦¬ í•¨ìˆ˜ë“¤ =====
        
        // ëª¨ë“œë³„ ë¬¸ì œ í•„í„°ë§
        function getQuestionsForMode(mode) {
            if (mode === 'basic') {
                return sampleQuestions; // ëª¨ë“  ë¬¸ì œ
            } else {
                return sampleQuestions.filter(q => q.category === mode);
            }
        }

        // í˜„ì¬ ë¬¸ì œ í‘œì‹œ
        function displayCurrentQuestion() {
            if (currentQuestions.length === 0) {
                document.getElementById('questionText').textContent = 'í•´ë‹¹ ëª¨ë“œì˜ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.';
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            
            // ë¬¸ì œ ì •ë³´ ì—…ë°ì´íŠ¸
            document.getElementById('currentQuestionNumber').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestionCount').textContent = currentQuestions.length;
            document.getElementById('questionCode').textContent = question.code;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('questionType').textContent = question.type;
            document.getElementById('questionCategory').textContent = `${question.category} > ${question.subcategory}`;
            
            // ë‹µì•ˆ ë²„íŠ¼ ìƒì„±
            createAnswerButtons(question);
            
            // ìƒíƒœ ì´ˆê¸°í™”
            selectedAnswer = null;
            isAnswerChecked = false;
            document.getElementById('answerResult').innerHTML = '';
            document.getElementById('checkAnswerBtn').style.display = 'block';
            
            console.log(`ë¬¸ì œ ${currentQuestionIndex + 1} í‘œì‹œ:`, question.code);
        }

        // ë‹µì•ˆ ë²„íŠ¼ ìƒì„±
        function createAnswerButtons(question) {
            const container = document.getElementById('answerButtons');
            container.innerHTML = '';
            
            if (question.type === 'ì§„ìœ„í˜•') {
                // O/X ë²„íŠ¼ ìƒì„±
                const oBtn = document.createElement('button');
                oBtn.className = 'answer-btn';
                oBtn.textContent = 'O';
                oBtn.onclick = () => selectAnswer('O');
                
                const xBtn = document.createElement('button');
                xBtn.className = 'answer-btn';
                xBtn.textContent = 'X';
                xBtn.onclick = () => selectAnswer('X');
                
                container.appendChild(oBtn);
                container.appendChild(xBtn);
                
            } else if (question.type === 'ì„ íƒí˜•') {
                // 1-4ë²ˆ ë²„íŠ¼ ìƒì„±
                question.options.forEach((option, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.innerHTML = `${index + 1}. ${option}`;
                    btn.onclick = () => selectAnswer((index + 1).toString());
                    container.appendChild(btn);
                });
            }
        }

        // ë‹µì•ˆ ì„ íƒ
        function selectAnswer(answer) {
            if (isAnswerChecked) return; // ì´ë¯¸ í™•ì¸í•œ ê²½ìš° ì„ íƒ ë¶ˆê°€
            
            selectedAnswer = answer;
            
            // ëª¨ë“  ë²„íŠ¼ì—ì„œ ì„ íƒ í‘œì‹œ ì œê±°
            document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // ì„ íƒëœ ë²„íŠ¼ì— í‘œì‹œ
            event.target.classList.add('selected');
            
            console.log('ë‹µì•ˆ ì„ íƒ:', answer);
        }

        // ì •ë‹µ í™•ì¸
        function checkAnswer() {
            if (!selectedAnswer) {
                alert('ë‹µì•ˆì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (isAnswerChecked) {
                alert('ì´ë¯¸ í™•ì¸í•œ ë¬¸ì œì…ë‹ˆë‹¤.');
                return;
            }

            const currentQuestion = currentQuestions[currentQuestionIndex];
            const isCorrect = selectedAnswer === currentQuestion.answer;
            
            // ì •ë‹µ í™•ì¸ ìƒíƒœ ì„¤ì •
            isAnswerChecked = true;
            
            // ë‹µì•ˆ ë²„íŠ¼ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
            updateAnswerButtonColors(currentQuestion.answer, selectedAnswer, isCorrect);
            
            // ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ
            showAnswerResult(isCorrect, currentQuestion.answer);
            
            // í†µê³„ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ í•¨ìˆ˜ í˜¸ì¶œ)
            updateAllStatistics(isCorrect);
            
            // ì •ë‹µ í™•ì¸ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            document.getElementById('checkAnswerBtn').style.display = 'none';
            
            console.log(`ì •ë‹µ í™•ì¸: ${isCorrect ? 'ì •ë‹µ' : 'ì˜¤ë‹µ'} (ì •ë‹µ: ${currentQuestion.answer}, ì„ íƒ: ${selectedAnswer})`);
        }

        // ë‹µì•ˆ ë²„íŠ¼ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
        function updateAnswerButtonColors(correctAnswer, selectedAnswer, isCorrect) {
            document.querySelectorAll('.answer-btn').forEach(btn => {
                const btnAnswer = btn.textContent.charAt(0); // O, X, 1, 2, 3, 4
                
                if (btnAnswer === correctAnswer) {
                    // ì •ë‹µ ë²„íŠ¼ì€ ì´ˆë¡ìƒ‰
                    btn.classList.add('correct-answer');
                } else if (btnAnswer === selectedAnswer && !isCorrect) {
                    // ì„ íƒí–ˆì§€ë§Œ í‹€ë¦° ë‹µì€ ë¹¨ê°„ìƒ‰
                    btn.classList.add('wrong-answer');
                }
                
                // ë²„íŠ¼ ë¹„í™œì„±í™”
                btn.classList.add('disabled');
            });
        }

        // ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ
        function showAnswerResult(isCorrect, correctAnswer) {
            const resultDiv = document.getElementById('answerResult');
            
            if (isCorrect) {
                resultDiv.innerHTML = `
                    <div style="color: #28a745; font-weight: bold; font-size: 18px;">
                        âœ… ì •ë‹µì…ë‹ˆë‹¤!
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div style="color: #dc3545; font-weight: bold; font-size: 18px;">
                        âŒ ì˜¤ë‹µì…ë‹ˆë‹¤. ì •ë‹µì€ "${correctAnswer}" ì…ë‹ˆë‹¤.
                    </div>
                `;
            }
        }

        // ë‹¤ìŒ ë¬¸ì œ
        function nextQuestion() {
            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                displayCurrentQuestion();
            } else {
                alert('ë§ˆì§€ë§‰ ë¬¸ì œì…ë‹ˆë‹¤.');
            }
        }

        // ì´ì „ ë¬¸ì œ  
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayCurrentQuestion();
            } else {
                alert('ì²« ë²ˆì§¸ ë¬¸ì œì…ë‹ˆë‹¤.');
            }
        }

        // ===== í•µì‹¬ í•¨ìˆ˜ë“¤ =====

        // ë¹ ë¥¸ ë“±ë¡ í•¨ìˆ˜ ì¶”ê°€
        function autoRegister() {
            document.getElementById('userName').value = 'ì¡°ëŒ€í‘œ';
            document.getElementById('userPhone').value = '010-1234-5678';
            registerUser();
        }

        // ì‚¬ìš©ì ë“±ë¡ (ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬: ë“±ë¡ ì‹œì ë¶€í„° ë°ì´í„° ê¸°ë¡)
        function registerUser() {
            const userName = document.getElementById('userName').value;
            const userPhone = document.getElementById('userPhone').value;
            
            if (!userName || !userPhone) {
                alert('ì‚¬ìš©ìëª…ê³¼ íœ´ëŒ€í°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            // ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬ì‚¬í•­: ì‚¬ìš©ì ë“±ë¡ ì‹œì ë¶€í„° ë°ì´í„° ê¸°ë¡ ì‹œì‘
            isUserRegistered = true;
            userStartDate = new Date().toISOString();
            
            statistics.meta.userName = userName;
            statistics.meta.registeredAt = userStartDate;
            statistics.meta.dataStartDate = new Date().toISOString().split('T')[0];
            
            // ì‚¬ìš©ìë³„ ì €ì¥ì†Œ í‚¤ ìƒì„± (ë©€í‹°ë””ë°”ì´ìŠ¤ ëŒ€ì‘)
            const userKey = `${userName}_${userPhone}`.replace(/[^a-zA-Z0-9]/g, '_');
            localStorage.setItem(`aciu_statistics_${userKey}`, JSON.stringify(statistics));
            localStorage.setItem('aciu_current_user', userKey);
            
            document.getElementById('userStatus').innerHTML = 
                `âœ… ${userName}ë‹˜ ë“±ë¡ì™„ë£Œ (${userStartDate.split('T')[0]} ë¶€í„° ë°ì´í„° ê¸°ë¡)`;
            
            updateAllDisplays();
            console.log('ì‚¬ìš©ì ë“±ë¡ ì™„ë£Œ:', userName, userKey);
        }

        // ë°ì´í„° ì €ì¥ (ìë™ ë“±ë¡ ì‚¬ìš©ì)
        function saveStatistics() {
            console.log('=== ë°ì´í„° ì €ì¥ ì‹œì‘ ===');
            
            const userKey = 'jo_daepyo_010_1234_5678';
            statistics.meta.lastUpdated = new Date().toISOString();
            localStorage.setItem(`aciu_statistics_${userKey}`, JSON.stringify(statistics));
            
            console.log('ë°ì´í„° ì €ì¥ ì™„ë£Œ:', `aciu_statistics_${userKey}`);
            console.log('ì €ì¥ëœ í†µê³„:', statistics.global.cumulative);
        }

        // ë°ì´í„° ë¡œë“œ (ìë™ ë“±ë¡ ì‚¬ìš©ì)
        function loadStatistics() {
            console.log('=== ë°ì´í„° ë¡œë“œ ì‹œì‘ ===');
            
            const userKey = 'jo_daepyo_010_1234_5678';
            const saved = localStorage.getItem(`aciu_statistics_${userKey}`);
            
            if (saved) {
                try {
                    const savedStats = JSON.parse(saved);
                    statistics = { ...initStatistics(), ...savedStats };
                    console.log('ì €ì¥ëœ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                    console.log('ë¡œë“œëœ í†µê³„:', statistics.global.cumulative);
                } catch (error) {
                    console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    statistics = initStatistics();
                }
            } else {
                console.log('ì €ì¥ëœ ë°ì´í„° ì—†ìŒ - ìƒˆë¡œ ì´ˆê¸°í™”');
                statistics = initStatistics();
            }
            
            // ë©”íƒ€ ì •ë³´ ì„¤ì •
            statistics.meta.userName = 'ì¡°ëŒ€í‘œ';
            statistics.meta.registeredAt = userStartDate;
            statistics.meta.dataStartDate = '2025-07-29';
        }

        // ì •ë‹µë¥  ê³„ì‚° ìœ í‹¸ë¦¬í‹°
        function calculateAccuracy(correct, total) {
            return total === 0 ? 0 : Math.round((correct / total) * 100);
        }

        // ì§„ë„ìœ¨ ê³„ì‚°
        function calculateProgress(completed, total) {
            return total === 0 ? 0 : Math.round((completed / total) * 100);
        }

        // ===== í•µì‹¬ ì´ë²¤íŠ¸: ë¬¸ì œ ë‹µì•ˆ í´ë¦­ =====
        function answerQuestion(isCorrect) {
            if (!isUserRegistered) {
                alert('ë¨¼ì € ì‚¬ìš©ìë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš” (ë°ì´í„° ê¸°ë¡ì„ ìœ„í•´)');
                return;
            }

            console.log('=== ë‹µì•ˆ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹œì‘ ===');
            console.log('ì •ë‹µì—¬ë¶€:', isCorrect, 'í˜„ì¬ëª¨ë“œ:', currentMode);

            // 1. ê¸€ë¡œë²Œ í†µê³„ ì—…ë°ì´íŠ¸
            updateGlobalStatistics(isCorrect);

            // 2. ëª¨ë“œë³„ í†µê³„ ì—…ë°ì´íŠ¸
            if (currentMode === 'basic') {
                updateBasicStatistics(isCorrect);
            } else {
                updateCategoryStatistics(currentMode, isCorrect);
                updateLargeCategoryTotalStatistics(isCorrect);
            }

            // 3. ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ì¤€ ì¼ì¼ í†µê³„ ì—…ë°ì´íŠ¸
            updateDailyStatistics(isCorrect);

            // 4. ë°ì´í„° ì €ì¥
            saveStatistics();

            // 5. í™”ë©´ ì—…ë°ì´íŠ¸
            updateAllDisplays();

            // 6. ë‹µì•ˆ í”¼ë“œë°± í‘œì‹œ
            showAnswerFeedback(isCorrect);

            console.log('=== ë‹µì•ˆ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì™„ë£Œ ===');
        }

        // ê¸€ë¡œë²Œ í†µê³„ ì—…ë°ì´íŠ¸ (ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬: ëŒ€ë¬¸ í†µê³„)
        function updateGlobalStatistics(isCorrect) {
            statistics.global.cumulative.attempted++;
            if (isCorrect) statistics.global.cumulative.correct++;
            statistics.global.cumulative.accuracy = calculateAccuracy(
                statistics.global.cumulative.correct,
                statistics.global.cumulative.attempted
            );

            statistics.global.daily.attempted++;
            if (isCorrect) statistics.global.daily.correct++;
            statistics.global.daily.accuracy = calculateAccuracy(
                statistics.global.daily.correct,
                statistics.global.daily.attempted
            );
        }

        // ê¸°ë³¸í•™ìŠµ í†µê³„ ì—…ë°ì´íŠ¸
        function updateBasicStatistics(isCorrect) {
            statistics.modes.basic.cumulative.attempted++;
            if (isCorrect) statistics.modes.basic.cumulative.correct++;
            statistics.modes.basic.cumulative.accuracy = calculateAccuracy(
                statistics.modes.basic.cumulative.correct,
                statistics.modes.basic.cumulative.attempted
            );

            statistics.modes.basic.daily.attempted++;
            if (isCorrect) statistics.modes.basic.daily.correct++;
            statistics.modes.basic.daily.accuracy = calculateAccuracy(
                statistics.modes.basic.daily.correct,
                statistics.modes.basic.daily.attempted
            );
        }

        // ì¹´í…Œê³ ë¦¬ë³„ í†µê³„ ì—…ë°ì´íŠ¸ (ëŒ€ë¶„ë¥˜í•™ìŠµ)
        function updateCategoryStatistics(category, isCorrect) {
            if (!statistics.modes.categories[category]) {
                statistics.modes.categories[category] = {
                    cumulative: { attempted: 0, correct: 0, accuracy: 0 },
                    daily: { attempted: 0, correct: 0, accuracy: 0 }
                };
            }

            const cat = statistics.modes.categories[category];
            cat.cumulative.attempted++;
            if (isCorrect) cat.cumulative.correct++;
            cat.cumulative.accuracy = calculateAccuracy(cat.cumulative.correct, cat.cumulative.attempted);

            cat.daily.attempted++;
            if (isCorrect) cat.daily.correct++;
            cat.daily.accuracy = calculateAccuracy(cat.daily.correct, cat.daily.attempted);
        }

        // ëŒ€ë¶„ë¥˜í•™ìŠµ ì „ì²´ ëˆ„ì  í†µê³„ ì—…ë°ì´íŠ¸
        function updateLargeCategoryTotalStatistics(isCorrect) {
            statistics.modes.largeCategoryTotal.cumulative.attempted++;
            if (isCorrect) statistics.modes.largeCategoryTotal.cumulative.correct++;
            statistics.modes.largeCategoryTotal.cumulative.accuracy = calculateAccuracy(
                statistics.modes.largeCategoryTotal.cumulative.correct,
                statistics.modes.largeCategoryTotal.cumulative.attempted
            );

            statistics.modes.largeCategoryTotal.daily.attempted++;
            if (isCorrect) statistics.modes.largeCategoryTotal.daily.correct++;
            statistics.modes.largeCategoryTotal.daily.accuracy = calculateAccuracy(
                statistics.modes.largeCategoryTotal.daily.correct,
                statistics.modes.largeCategoryTotal.daily.attempted
            );
        }

        // ì¼ì¼ í†µê³„ ì—…ë°ì´íŠ¸ (ë§¤ì¼ ìì •ì— ë¦¬ì…‹ë˜ì–´ì•¼ í•¨ - ì—¬ê¸°ì„œëŠ” ê°„ì†Œí™”)
        function updateDailyStatistics(isCorrect) {
            // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ë‚ ì§œ ì²´í¬ í›„ ìì •ì— daily í†µê³„ ë¦¬ì…‹ í•„ìš”
            console.log('ì¼ì¼ í†µê³„ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        }

        // ===== í™”ë©´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ =====
        
        // ëª¨ë“  í™”ë©´ ì—…ë°ì´íŠ¸
        function updateAllDisplays() {
            updateHomeStatistics();
            updateModeStatistics();
            updateDebugInfo();
        }

        // ëŒ€ë¬¸ í†µê³„ ì—…ë°ì´íŠ¸ (ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬ì‚¬í•­) - ë¡œê·¸ ì¶”ê°€
        function updateHomeStatistics() {
            console.log('=== ëŒ€ë¬¸ í†µê³„ ì—…ë°ì´íŠ¸ ì‹œì‘ ===');
            
            // 1. ë³´ìœ ë¬¸ì œìˆ˜ í˜„í™©
            document.getElementById('insQuestions').textContent = statistics.questionCounts["ì¸ìŠ¤êµì¬"];
            document.getElementById('examQuestions').textContent = statistics.questionCounts["ë³´í—˜ì¤‘ê°œì‚¬ì‹œí—˜"];
            document.getElementById('totalQuestions').textContent = statistics.questionCounts.total;

            // 2. í•™ìŠµì§„ë„ í˜„í™©
            const global = statistics.global.cumulative;
            document.getElementById('completedQuestions').textContent = global.attempted;
            document.getElementById('overallProgress').textContent = 
                calculateProgress(global.attempted, statistics.questionCounts.total) + '%';
            document.getElementById('overallAccuracy').textContent = global.accuracy + '%';

            // 3. ê¸ˆì¼ í•™ìŠµí˜„í™© (ì¡°ëŒ€í‘œë‹˜ ìš”êµ¬: ë³„ë„ ë°•ìŠ¤)
            const daily = statistics.global.daily;
            document.getElementById('todayTotal').textContent = daily.attempted;
            document.getElementById('todayCorrect').textContent = daily.correct;
            document.getElementById('todayAccuracy').textContent = daily.accuracy + '%';
            
            console.log('ëŒ€ë¬¸ í†µê³„ ì—…ë°ì´íŠ¸ ì™„ë£Œ:');
            console.log('- ì™„ë£Œí•œ ë¬¸ì œ:', global.attempted);
            console.log('- ì „ì²´ ì •ë‹µë¥ :', global.accuracy + '%');
            console.log('- ì˜¤ëŠ˜ ë¬¸ì œ:', daily.attempted);
        }

        // ëª¨ë“œë³„ í†µê³„ ì—…ë°ì´íŠ¸
        function updateModeStatistics() {
            if (currentMode === 'basic') {
                document.getElementById('basicStats').style.display = 'block';
                document.getElementById('categoryStats').style.display = 'none';
                
                // ê¸°ë³¸í•™ìŠµ ëˆ„ì í˜„í™©
                const basic = statistics.modes.basic;
                document.getElementById('basicCumulativeTotal').textContent = basic.cumulative.attempted;
                document.getElementById('basicCumulativeCorrect').textContent = basic.cumulative.correct;
                document.getElementById('basicCumulativeAccuracy').textContent = basic.cumulative.accuracy + '%';
                
                // ê¸°ë³¸í•™ìŠµ ê¸ˆì¼í˜„í™©
                document.getElementById('basicDailyTotal').textContent = basic.daily.attempted;
                document.getElementById('basicDailyCorrect').textContent = basic.daily.correct;
                document.getElementById('basicDailyAccuracy').textContent = basic.daily.accuracy + '%';
                
            } else {
                document.getElementById('basicStats').style.display = 'none';
                document.getElementById('categoryStats').style.display = 'block';
                
                // ëŒ€ë¶„ë¥˜í•™ìŠµ ì „ì²´ ëˆ„ì  í†µê³„
                const largeCategoryTotal = statistics.modes.largeCategoryTotal.cumulative;
                document.getElementById('largeCategoryTotalAttempted').textContent = largeCategoryTotal.attempted;
                document.getElementById('largeCategoryTotalCorrect').textContent = largeCategoryTotal.correct;
                document.getElementById('largeCategoryTotalAccuracy').textContent = largeCategoryTotal.accuracy + '%';
                
                // íŠ¹ì • ì¹´í…Œê³ ë¦¬ í†µê³„
                document.getElementById('categoryTitle').textContent = currentMode + ' í†µê³„';
                const category = statistics.modes.categories[currentMode];
                if (category) {
                    // ëˆ„ì í˜„í™©
                    document.getElementById('categoryCumulativeTotal').textContent = category.cumulative.attempted;
                    document.getElementById('categoryCumulativeCorrect').textContent = category.cumulative.correct;
                    document.getElementById('categoryCumulativeAccuracy').textContent = category.cumulative.accuracy + '%';
                    
                    // ê¸ˆì¼í˜„í™©
                    document.getElementById('categoryDailyTotal').textContent = category.daily.attempted;
                    document.getElementById('categoryDailyCorrect').textContent = category.daily.correct;
                    document.getElementById('categoryDailyAccuracy').textContent = category.daily.accuracy + '%';
                }
            }
        }

        // ë””ë²„ê·¸ ì •ë³´ ì—…ë°ì´íŠ¸
        function updateDebugInfo() {
            const debugData = {
                í˜„ì¬ëª¨ë“œ: currentMode,
                ì‚¬ìš©ìë“±ë¡: isUserRegistered,
                ë“±ë¡ì‹œì : userStartDate,
                ì „ì²´í†µê³„: statistics.global,
                ëª¨ë“œí†µê³„: currentMode === 'basic' ? statistics.modes.basic : statistics.modes.categories[currentMode],
                ì €ì¥ì†Œí‚¤: localStorage.getItem('aciu_current_user')
            };
            document.getElementById('debugInfo').textContent = JSON.stringify(debugData, null, 2);
        }

        // ë‹µì•ˆ í”¼ë“œë°± í‘œì‹œ
        function showAnswerFeedback(isCorrect) {
            const resultDiv = document.getElementById('answerResult');
            const buttons = document.querySelectorAll('.answer-btn');
            
            buttons.forEach(btn => {
                btn.className = 'answer-btn ' + (isCorrect ? 'correct' : 'incorrect');
            });
            
            resultDiv.innerHTML = isCorrect ? 
                '<div style="color: #28a745; font-weight: bold;">âœ… ì •ë‹µì…ë‹ˆë‹¤!</div>' :
                '<div style="color: #dc3545; font-weight: bold;">âŒ ì˜¤ë‹µì…ë‹ˆë‹¤!</div>';
            
            // 3ì´ˆ í›„ ë²„íŠ¼ ìƒ‰ìƒ ì›ë³µ
            setTimeout(() => {
                buttons.forEach(btn => btn.className = 'answer-btn neutral');
                resultDiv.innerHTML = '';
            }, 2000);
        }

        // ëª¨ë“œ ì„¤ì • í•¨ìˆ˜ ìˆ˜ì • (ë¬¸ì œ ë¡œë“œ ì¶”ê°€)
        function setMode(mode) {
            currentMode = mode;
            document.getElementById('currentMode').textContent = mode;
            
            // í•´ë‹¹ ëª¨ë“œì˜ ë¬¸ì œë“¤ ë¡œë“œ
            currentQuestions = getQuestionsForMode(mode);
            currentQuestionIndex = 0;
            
            // ì²« ë²ˆì§¸ ë¬¸ì œ í‘œì‹œ
            displayCurrentQuestion();
            
            updateModeStatistics();
            console.log('ëª¨ë“œ ë³€ê²½:', mode, 'ë¬¸ì œ ìˆ˜:', currentQuestions.length);
        }

        // ===== ë°ì´í„° ê´€ë¦¬ (ë©€í‹°ë””ë°”ì´ìŠ¤ ëŒ€ì‘) =====
        
        function exportData() {
            const dataStr = JSON.stringify(statistics, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `aciu_statistics_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            console.log('ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì™„ë£Œ');
        }

        function importData() {
            document.getElementById('importFile').click();
        }

        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    statistics = { ...initStatistics(), ...importedData };
                    isUserRegistered = !!statistics.meta.userName;
                    
                    if (isUserRegistered) {
                        document.getElementById('userName').value = statistics.meta.userName;
                        document.getElementById('userStatus').innerHTML = 
                            `âœ… ${statistics.meta.userName}ë‹˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ`;
                    }
                    
                    updateAllDisplays();
                    console.log('ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ');
                    alert('ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤!');
                } catch (error) {
                    console.error('ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                    alert('ì˜ëª»ëœ ë°ì´í„° íŒŒì¼ì…ë‹ˆë‹¤.');
                }
            };
            reader.readAsText(file);
        }

        function showStorageKey() {
            const userKey = localStorage.getItem('aciu_current_user');
            const allKeys = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('aciu_')) {
                    allKeys.push(key);
                }
            }
            
            alert(`í˜„ì¬ ì‚¬ìš©ì í‚¤: ${userKey}\n\nëª¨ë“  ACIU ì €ì¥ì†Œ í‚¤:\n${allKeys.join('\n')}`);
        }

        function resetAllData() {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                // ëª¨ë“  aciu ê´€ë ¨ localStorage ë°ì´í„° ì‚­ì œ
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('aciu_')) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => localStorage.removeItem(key));
                
                // ë³€ìˆ˜ ì´ˆê¸°í™”
                statistics = initStatistics();
                isUserRegistered = false;
                userStartDate = null;
                currentMode = 'basic';
                
                // UI ì´ˆê¸°í™”
                document.getElementById('userName').value = '';
                document.getElementById('userPhone').value = '';
                document.getElementById('userStatus').innerHTML = 'ë¯¸ë“±ë¡ ìƒíƒœ (ë°ì´í„° ê¸°ë¡ ì•ˆë¨)';
                document.getElementById('currentMode').textContent = 'basic';
                
                updateAllDisplays();
                console.log('ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ');
                alert('ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì•± ì´ˆê¸°í™” í•¨ìˆ˜ ìˆ˜ì • (ìë™ ë“±ë¡ í¬í•¨)
        function initApp() {
            console.log('=== ACIU ìƒ˜í”Œì•± ì´ˆê¸°í™” ===');
            
            // 1. ìë™ ì‚¬ìš©ì ë“±ë¡ (7ì›” 29ì¼ ê³ ì •)
            autoInitializeUser();
            
            // 2. ì €ì¥ëœ ì‚¬ìš©ì ë°ì´í„° ë¡œë“œ ì‹œë„
            loadStatistics();
            
            // 3. ì´ˆê¸° í™”ë©´ ì—…ë°ì´íŠ¸
            updateAllDisplays();
            
            // 4. ê¸°ë³¸ ëª¨ë“œ ì„¤ì • ë° ì²« ë¬¸ì œ ë¡œë“œ
            setMode('basic');
            
            console.log('ì•± ì´ˆê¸°í™” ì™„ë£Œ - ìë™ ë“±ë¡ëœ ì‚¬ìš©ì:', statistics.meta.userName);
            console.log('í˜„ì¬ í†µê³„ ìƒíƒœ:', statistics.global.cumulative);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì•± ì´ˆê¸°í™”
        window.onload = initApp;

        // ===== ìë™ ì €ì¥ (30ì´ˆë§ˆë‹¤) =====
        setInterval(() => {
            if (isUserRegistered) {
                saveStatistics();
            }
        }, 30000);

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ë°ì´í„° ì €ì¥
        window.addEventListener('beforeunload', () => {
            if (isUserRegistered) {
                saveStatistics();
            }
        });

        // ===== ì¶”ê°€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ =====
        
        // ì˜¤ëŠ˜ ë‚ ì§œ í‚¤ ìƒì„±
        function getTodayKey() {
            return new Date().toISOString().split('T')[0];
        }
        
        // ì¼ì¼ ë°ì´í„° ë¦¬ì…‹ ì²´í¬ (ì‹¤ì œ ì•±ì—ì„œëŠ” ìì •ë§ˆë‹¤ ì‹¤í–‰)
        function checkDailyReset() {
            const today = getTodayKey();
            const lastDate = localStorage.getItem('aciu_last_date');
            
            if (lastDate !== today) {
                // ìƒˆë¡œìš´ ë‚ ì§œ - ì¼ì¼ í†µê³„ ë¦¬ì…‹
                statistics.global.daily = { attempted: 0, correct: 0, accuracy: 0 };
                statistics.modes.basic.daily = { attempted: 0, correct: 0, accuracy: 0 };
                
                Object.keys(statistics.modes.categories).forEach(category => {
                    statistics.modes.categories[category].daily = { attempted: 0, correct: 0, accuracy: 0 };
                });
                
                statistics.modes.largeCategoryTotal.daily = { attempted: 0, correct: 0, accuracy: 0 };
                
                localStorage.setItem('aciu_last_date', today);
                console.log('ì¼ì¼ í†µê³„ ë¦¬ì…‹ ì™„ë£Œ:', today);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¼ì¼ ë¦¬ì…‹ ì²´í¬
        document.addEventListener('DOMContentLoaded', checkDailyReset);

    </script>
</body>
</html>