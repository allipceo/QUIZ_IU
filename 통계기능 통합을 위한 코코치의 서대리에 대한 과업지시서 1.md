ACIU QUIZ 앱 통계 기능 개발 - 서대리 코딩 과업 지시서 V1.1 (코코치 최종 지침)
작성자: 코코치 (프로젝트 총괄 팀장)
수신자: 서대리님 (개발 담당)
작성일: 2025.07.30
목표: index_test_v1.0.html의 완성된 UI/UX 및 문제풀이 시스템을 완전 보존하면서, 노팀장 샘플앱의 간소화된 통계 로직을 선별적으로 적용하고, 조대표님의 모든 통계 요구사항을 100% 반영하여 기능 장애 문제를 해결하고 완전한 통합을 달성합니다.

⚠️ 핵심 지시 사항 (절대 엄수)
기존 CSV 데이터 필드 절대 수정 금지:

현재 작업 폴더에 있는 ins_master_db.csv, ins_1db.csv, ins_2db.csv, ins_3db.csv, ins_4db.csv 등 5개의 CSV 데이터 파일에 대해서는 일체 변형을 하지 않아야 합니다.

파싱, 구조화, 전처리 등 모든 과정은 이미 완료된 상태입니다.

특히, QUESTION 필드를 포함한 기존의 어떠한 필드도 건드려서는 안 됩니다.

새로운 필드 생성 및 데이터 입력 허용:

통계 기능 구현을 위해 새로운 필드를 만들거나 데이터를 입력하는 것은 허용됩니다. 이는 기존 데이터의 무결성을 해치지 않는 범위 내에서 진행되어야 합니다.

예를 들어, 문제별 정답 여부 기록을 위한 내부 데이터 구조 추가 등은 가능합니다.

노팀장 샘플 앱(노팀장통계 샘플앱v1.0.html) 활용:

노팀장 샘플 앱은 이미 조대표님의 통계 요구사항을 100% 반영하고 검증된 핵심 로직을 포함하고 있습니다. 이 샘플 앱의 JavaScript 코드와 HTML 구조를 index_test_v1.0.html에 통합하는 것이 이번 과업의 핵심입니다.

🚨 현황 분석 및 문제점 (재확인)
서대리님께서 겪고 있는 어려움과 노팀장님의 분석을 종합한 결과, 현재 index_test_v3.0.html 파일에는 다음과 같은 핵심 문제점들이 있습니다.

기능 장애: 기본학습/대분류학습 버튼 클릭 시 반응 없음, 문제 풀이 시스템 미작동, CSV 데이터 로딩 실패.

기존 지침 미반영: aicu → aciu 키/변수명 통일, StatisticsCache 사용, window.statistics 제거, alert()/confirm() 대체 등 이전 지시 사항이 제대로 이행되지 않았습니다.

코드 혼재 및 복잡성: 레거시 코드와 신규 로직이 혼재되어 유지보수성이 저해되고 있습니다.

HTML 요소 ID 불일치/누락: JavaScript 코드와 HTML 요소 ID 간의 불일치 및 누락 문제가 있습니다.

CSV 데이터 필드 참조 오류: JavaScript 코드에서 CSV 필드를 참조할 때 대소문자 불일치(예: question.question vs QUESTION) 문제가 있습니다.

이러한 문제들로 인해 현재 index_test_v3.0.html 파일은 기반으로 삼기 어렵습니다.

🚩 코코치의 긴급 지침 (다음 단계)
서대리님, 현재 상태는 기존 index_test_v3.0.html 파일을 수정하는 방식으로는 해결하기 어렵습니다. 노팀장님과 제가 이전에 지시했던 "점진적 수정" 방안을 처음부터 다시, 그리고 더욱 엄격하게 적용해야 합니다.

Step 0: 작업 환경 재설정 (최우선, 즉시 시작)
모든 작업 중단: 현재 index_test_v3.0.html 파일에 대한 모든 수정을 즉시 중단하십시오.

새로운 임시 작업 파일 생성:

원래의 깨끗한 index_test_v1.0.html 파일을 다시 가져와서, index_temp_working_new.html 이라는 이름으로 새로운 임시 작업 파일을 생성하십시오.

절대로 index_test_v3.0.html을 기반으로 작업하지 마십시오.

필수 백업: 작업 시작 전 반드시 다음 백업을 생성하십시오.

cp index_test_v1.0.html index_test_v1.0_backup_$(date +%Y%m%d_%H%M%S).html
cp index_test_v3.0.html index_test_v3.0_backup_$(date +%Y%m%d_%H%M%S).html

Step 1: v1.0 기능 복원 및 기본 통계 인프라 구축 (1일차)
목표: index_test_v1.0.html의 완성된 문제 풀이 시스템을 index_temp_working_new.html에 완전 복원하고, 노팀장 샘플 앱의 핵심 통계 로직을 통합할 준비를 마칩니다.

v1.0 핵심 함수 복사 (순서 중요!):

index_temp_working_new.html 파일에 index_test_v1.0.html에서 다음 함수들을 그대로 복사하십시오. (아래 순서 엄수)

// 1. 먼저 MODE_CONFIG 객체 복사 (v1.0의 완전한 구조로)
// 2. selectLearningMode() 함수 복사
// 3. loadBasicLearningData() 함수 복사
// 4. loadCategoryData() 함수 복사
// 5. displayQuestion() 함수 복사
// 6. createAnswerButtons() 함수 복사
// 7. selectAnswer() 함수 복사
// 8. checkAnswer() 함수 복사 (통계 업데이트 부분은 기존 v1.0 로직 유지)
// 9. nextQuestion(), prevQuestion() 함수 복사
// 10. goHome() 함수 복사
// 11. updateProgress(), saveProgressToStorage(), loadProgressFromStorage() 등 진도 관련 함수 복사
// 12. updateStatistics(), calculateAccuracy(), updateAccuracyDisplay(), updateDetailedStatistics() 등 기존 통계 관련 함수 복사
// 13. saveUserSettings(), loadUserSettings(), openUserSettings(), closeUserSettings(), updateUserDisplay(), updateDDay() 등 사용자 설정 관련 함수 복사
// 14. initializeApp() 함수 복사 (초기화 로직은 그대로 유지)

주의: index_test_v3.0.html에서 가져온 코드가 아닌, index_test_v1.0.html의 원본 코드를 사용해야 합니다.

기능 복원 즉시 테스트:

각 함수를 복사한 후 즉시 브라우저 콘솔에서 테스트하여 정상 작동하는지 확인하십시오.

console.log(typeof selectLearningMode); // "function"이어야 함

selectLearningMode('basic'); // 에러 없이 실행되어야 함

완전한 플로우 테스트:

기본학습 버튼 클릭 → 화면 전환 → CSV 파일 로딩 → 첫 번째 문제 표시 → 답안 선택 → 정답 확인 → 다음 문제 (5문제 연속)

대분류학습 → 카테고리 선택 → 문제 표시 (각 카테고리별)

브라우저 콘솔에 에러 메시지가 없어야 합니다.

aciu 키/변수명 통일 (최우선):

Step 1 완료 후, index_temp_working_new.html 파일 내의 모든 aicu 접두사를 aciu로 변경하십시오. (Local Storage 키, 전역 변수명, HTML <title> 등 코드 전반에 걸쳐)

노팀장 샘플 앱의 핵심 통계 변수 및 초기화 함수 복사:

노팀장통계 샘플앱v1.0.html에서 다음 JavaScript 코드 블록을 index_temp_working_new.html의 <script> 태그 상단에 복사하십시오.

// ACIU 통합 통계 스키마 (간소화 버전)
const initStatistics = () => ({
    meta: {
        version: "2.0",
        userName: null,
        registeredAt: null,
        dataStartDate: null,
        lastUpdated: new Date().toISOString()
    },
    questionCounts: {
        "인스교재": 700, // 이 부분은 Step 2에서 동적으로 가져오도록 수정
        "보험중개사시험": 679, // 이 부분은 Step 2에서 동적으로 가져오도록 수정
        "total": 1379 // 이 부분은 Step 2에서 동적으로 가져오도록 수정
    },
    global: {
        cumulative: { attempted: 0, correct: 0, accuracy: 0 },
        daily: { attempted: 0, correct: 0, accuracy: 0 }
    },
    modes: {
        basic: {
            cumulative: { attempted: 0, correct: 0, accuracy: 0 },
            daily: { attempted: 0, correct: 0, accuracy: 0 }
        },
        categories: {
            "재산보험": { cumulative: { attempted: 0, correct: 0, accuracy: 0 }, daily: { attempted: 0, correct: 0, accuracy: 0 } },
            "특종보험": { cumulative: { attempted: 0, correct: 0, accuracy: 0 }, daily: { attempted: 0, correct: 0, accuracy: 0 } },
            "배상책임보험": { cumulative: { attempted: 0, correct: 0, accuracy: 0 }, daily: { attempted: 0, correct: 0, accuracy: 0 } },
            "해상보험": { cumulative: { attempted: 0, correct: 0, accuracy: 0 }, daily: { attempted: 0, correct: 0, accuracy: 0 } }
        },
        largeCategoryTotal: {
            cumulative: { attempted: 0, correct: 0, accuracy: 0 },
            daily: { attempted: 0, correct: 0, accuracy: 0 }
        }
    }
});

let statistics = null; // 전역 통계 객체
let isUserRegistered = false; // 사용자 등록 여부
let userStartDate = null; // 사용자 등록 시점

주의: initStatistics 함수 내 questionCounts의 하드코딩된 값은 Step 2에서 수정할 예정이므로 지금은 그대로 두십시오.

StatisticsCache 클래스 정의 및 인스턴스 생성:

이전 지침에서 제시된 StatisticsCache 클래스 코드를 index_temp_working_new.html에 추가하고, const statisticsCache = new StatisticsCache();와 같이 인스턴스를 생성하십시오. (이 인스턴스를 기존 통계 로직에 연결하는 것은 Step 2에서 진행)

Step 2: 통계 로직 통합 및 레거시 제거 (2일차)
목표: 기존 window.statistics 기반의 통계 시스템을 aciu_statistics 및 StatisticsCache 기반의 새로운 시스템으로 안전하게 교체하고, 레거시 코드를 완전히 제거합니다.

노팀장 샘플 앱의 핵심 통계 업데이트 함수 복사 및 수정:

노팀장통계 샘플앱v1.0.html에서 다음 함수들을 index_temp_working_new.html에 복사하십시오.

calculateAccuracy(correct, total)

calculateProgress(completed, total)

generateUserKey(userName, userPhone)

getTodayKey()

updateStatistics(isCorrect, mode, category) (이 함수는 updateAllStatistics로 이름을 변경하고, statisticsCache를 사용하도록 수정해야 합니다. 아래 지시 참고)

updateModeStatistics(modeStats, isCorrect)

saveStatistics()

loadStatistics()

updateAllDisplays()

updateHomeStatistics()

updateModeStatistics() (샘플 앱의 updateModeStatistics는 updateModeStatisticsDisplay의 역할을 수행함)

updateDebugInfo()

showAnswerFeedback(isCorrect)

updateGlobalStatistics(isCorrect)

updateBasicStatistics(isCorrect)

updateCategoryStatistics(category, isCorrect)

updateLargeCategoryTotalStatistics(isCorrect)

updateDailyStatistics(isCorrect) (일일 리셋 로직은 checkDailyReset 함수로 분리)

복사 후 수정:

updateStatistics 함수를 updateAllStatistics로 이름 변경: 이 함수가 모든 통계 업데이트를 통합 관리하는 역할을 수행하도록 합니다.

모든 복사된 함수 내 statistics 변수 사용을 statisticsCache.get()으로 변경: 데이터를 캐시에서 가져오고, statisticsCache.set(stats) 및 statisticsCache.flush()를 통해 변경 사항을 저장하도록 수정합니다.

saveStatistics() 및 loadStatistics() 함수를 statisticsCache를 사용하도록 수정: localStorage.setItem('aciu_statistics_${userKey}', ...) 대신 statisticsCache.set() 및 statisticsCache.flush()를 사용합니다.

checkAnswer() 함수 수정:

index_temp_working_new.html의 checkAnswer() 함수 내에서 기존 updateStatistics() 호출 및 window.statistics 관련 로직을 제거하고, 새로 구현한 updateAllStatistics(isCorrect, currentMode, currentQuestion.category) 함수만 호출하도록 수정하십시오.

window.statistics 사용 완전 제거:

index_temp_working_new.html 파일 내에서 window.statistics 전역 변수의 선언 및 모든 사용을 완전히 제거하십시오. 모든 통계 데이터는 statisticsCache.get()을 통해 접근해야 합니다.

하드코딩 제거:

initStatistics 함수 내 questionCounts에 하드코딩된 문제 수(예: 700, 679, 1379)를 제거하고, countQuestionsBySource 함수를 통해 CSV에서 동적으로 가져온 값을 사용하도록 수정하십시오.

updateQuestionCounts() 및 updateProgressData() 함수 내에서 하드코딩된 문제 수를 제거하고, stats.questionCounts에서 값을 가져와 사용하도록 수정하십시오.

사용자 설정 데이터 관리 일관성:

saveUserSettings() 및 loadUserSettings() 함수에서 aciu_user_settings, userSettings 등 개별 Local Storage 키 사용을 제거하고, 모든 사용자 정보는 aciu_statistics.meta를 통해 관리하도록 통합하십시오.

CSV 데이터 필드 참조 오류 수정:

displayQuestion, loadQuestions, loadCategoryQuestions 함수 내에서 CSV 데이터 필드를 참조할 때 대문자 필드명을 사용하도록 수정하십시오. (예: question.QUESTION, question.ANSWER, question.TYPE 등)

initializeApp() 함수 수정:

initializeApp() 함수 내에서 statistics = initStatistics();와 같이 직접 statistics 변수를 초기화하는 부분을 제거하고, statisticsCache.loadFromStorage() 또는 initializeStatistics() (이 함수는 statisticsCache를 사용해야 함)를 호출하여 통계 데이터를 로드하도록 수정합니다.

검증:

앱 실행 후 콘솔에 window.statistics 관련 오류가 없는지 확인하십시오.

문제 풀이 시 통계 데이터가 aciu_statistics 객체에 정확히 기록되고 StatisticsCache를 통해 저장되는지 Local Storage를 통해 확인하십시오.

보유 문제수 및 진도 현황이 CSV 데이터 기반으로 정확히 표시되는지 확인하십시오.

문제 로딩 및 답안 처리 시 CSV 필드 참조 오류가 없는지 콘솔을 통해 확인하십시오.

Step 3: 조대표님 요구사항 반영 및 UI/UX 개선 (3일차)
목표: 조대표님의 핵심 UI/UX 요구사항을 반영하고, 사용자 경험을 향상시킵니다.

대문 HTML 구조 수정 (노팀장 샘플 앱 활용):

index_temp_working_new.html의 대문 (id="home-screen") 섹션에 있는 "보유 문제수 현황", "학습 진도 현황", "금일 학습 현황" HTML 구조를 노팀장통계 샘플앱v1.0.html의 해당 섹션 HTML로 교체하십시오.

주의: 샘플 앱의 HTML에 있는 id 값과 JavaScript 코드에서 참조하는 id 값이 일치하는지 확인하십시오. (예: insQuestions → ins-questions로 변경 필요할 수 있음)

"오늘진도율" → "정답률" 변경:

대문 화면의 "학습 진도 현황" 섹션에서 "오늘 진도율" UI 텍스트를 "정답률"로 변경하고, 해당 ID를 overallAccuracy (샘플 앱 ID) 또는 overall-accuracy-rate (기존 기획서 ID) 등으로 통일하십시오. updateHomeStatistics() 함수에서 stats.global.cumulative.accuracy 값을 가져와 표시하도록 로직을 수정하십시오.

대분류학습 제목 우측 전체 누적 통계 배치:

index_temp_working_new.html의 대분류학습 화면 (id="large-category-screen") HTML 헤더를 수정하여, <h2> 태그 우측에 전체 누적 통계를 표시하는 div 요소를 노팀장통계 샘플앱v1.0.html에서 가져와 추가하고, 해당 요소에 aciu_statistics.stats.modes.largeCategory.cumulative 데이터를 연동하여 표시하십시오.

누적/금일 현황 구분:

기본학습 (id="basic-learning-screen") 및 대분류학습 (id="large-category-learning-screen") 화면의 통계 섹션을 수정하여 "누적 현황"과 "금일 현황"을 위한 별도의 HTML 박스를 노팀장통계 샘플앱v1.0.html에서 가져와 추가하고, 해당 박스에 맞는 통계 데이터를 연동하여 표시하십시오.

alert() 및 confirm() 대체:

코드 내의 모든 alert() 및 confirm() 호출을 커스텀 모달 UI로 대체하십시오. (샘플 앱에는 alert가 사용되고 있으므로, 이 부분은 직접 커스텀 모달로 구현해야 합니다.)

startBasicLearning() 및 startLargeCategoryLearning() 함수 수정:

index_test_v1.0.html의 selectLearningMode 함수가 basic과 large-category 모드를 처리하도록 되어 있습니다. startBasicLearning()과 startLargeCategoryLearning() 함수를 selectLearningMode 함수를 호출하도록 수정하거나, selectLearningMode 함수를 직접 사용하도록 UI 이벤트를 변경하십시오.

"이어풀기" 디폴트 설정:

showBasicLearningScreen() 또는 selectLearningMode('basic') 함수 내에서 기본학습 모드 진입 시 selectBasicLearningMode('continue')를 호출하여 "이어풀기"가 디폴트가 되도록 설정하십시오. (노팀장 지시사항 D2)

검증:

각 화면에서 UI 변경 사항이 올바르게 적용되었는지, 통계 데이터가 정확히 표시되는지 육안으로 확인하십시오.

alert/confirm 대신 커스텀 모달이 뜨는지 확인하십시오.

문제 로딩 및 답안 처리 시 CSV 필드 참조 오류가 없는지 콘솔을 통해 확인하십시오.

Step 4: 최적화 및 폴리싱 (0.5일차)
목표: 앱의 성능과 안정성을 최종적으로 확보하고, 사용자에게 더 나은 경험을 제공합니다.

성능 모니터링 및 최적화:

노팀장통계 샘플앱v1.0.html에서 setupMemoryMonitoring() 및 setupNetworkMonitoring() 함수를 가져와 구현하고 활용하여 앱의 성능을 모니터링하고 최적화하십시오.

데이터 백업/복구 기능:

노팀장통계 샘플앱v1.0.html에서 exportData() (이름은 exportStatistics로 변경) 및 importData() (이름은 importStatistics로 변경) 함수를 가져와 구현하여 사용자가 통계 데이터를 백업하고 복구할 수 있도록 하십시오.

오류 처리 및 데이터 무결성 강화:

노팀장통계 샘플앱v1.0.html에서 validateStatistics() 및 repairStatistics() 함수를 가져와 initializeApp 및 importStatistics 등 적절한 시점에 호출하여 데이터 무결성을 검증하고 필요한 경우 복구하십시오.

handleStatisticsError() 및 showUserNotification() 함수를 활용하여 사용자에게 오류 발생 시 적절한 피드백을 제공하십시오.

코드 정리:

주석을 추가하고, 불필요한 코드나 중복 코드를 제거하여 코드 가독성과 유지보수성을 높이십시오.

노팀장통계 샘플앱v1.0.html의 sampleQuestions 배열은 CSV에서 데이터를 가져오므로 제거하십시오.

📋 협업 및 보고 체계
노팀장님께 자문 및 코드 리뷰:

각 Step을 완료할 때마다 노팀장님께 즉시 코드 리뷰를 요청하고, 문제가 없음을 확인받은 후에 다음 Step으로 넘어가십시오.

기술적인 어려움이 발생하면 즉시 노팀장님께 자문을 구하십시오.

코코치에게 진행 상황 보고:

각 Step 완료 후 간단하게 코코치에게 진행 상황을 보고해 주십시오.

서대리님, 이번 과업은 지난번의 어려움을 극복하고 프로젝트의 완성도를 100%로 끌어올리는 중요한 기회입니다. 제가 제시한 단계별 지침을 엄격히 따르고 노팀장님과의 긴밀한 협업을 통해 반드시 성공적으로 마무리해 주시리라 믿습니다. 힘내십시오!